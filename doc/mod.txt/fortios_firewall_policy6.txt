SYNOPSIS                   *fortios_firewall_policy6*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify firewall feature and policy6 category. Examples include all parameters and values
       need to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_firewall_policy6-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_firewall_policy6-parameters*

           Parameter          Choices/Defaults                                                                        Comments
   firewall_policy6           Default:         Configure IPv6 policies.
   dictionary                 null
                                Choices:
    action                      • accept       Policy action (allow/deny/ipsec).
    string                      • deny
                                • ipsec
    app_category                               Application category ID list.
    list
           id                                  Category IDs.
           integer / required
    app_group                                  Application group names.
    list
           name                                Application group names. Source application.group.name.
           string / required
    application                                Application ID list.
    list
           id                                  Application IDs.
           integer / required
    application_list                           Name of an existing Application list. Source application.list.name.
    string
    av_profile                                 Name of an existing Antivirus profile. Source antivirus.profile.name.
    string
    comments                                   Comment.
    string
    custom_log_fields                          Log field index numbers to append custom log fields to log messages for this policy.
    list
           field_id                            Custom log field. Source log.custom-field.id.
           string
    devices                                    Names of devices or device groups that can be matched by the policy.
    list
           name                                Device or group name. Source user.device.alias user.device-group.name user.device-category.name.
           string / required
    diffserv_forward            Choices:
    string                      • enable       Enable to change packet's DiffServ values to the specified diffservcode-forward value.
                                • disable
    diffserv_reverse            Choices:
    string                      • enable       Enable to change packet's reverse (reply) DiffServ values to the specified diffservcode-rev value.
                                • disable
    diffservcode_forward                       Change packet's DiffServ to this value.
    string
    diffservcode_rev                           Change packet's reverse (reply) DiffServ to this value.
    string
    dlp_sensor                                 Name of an existing DLP sensor. Source dlp.sensor.name.
    string
    dscp_match                  Choices:
    string                      • enable       Enable DSCP check.
                                • disable
    dscp_negate                 Choices:
    string                      • enable       Enable negated DSCP match.
                                • disable
    dscp_value                                 DSCP value.
    string
    dsri                        Choices:
    string                      • enable       Enable DSRI to ignore HTTP server responses.
                                • disable
    dstaddr                                    Destination address and address group names.
    list
           name                                Address name. Source firewall.address6.name firewall.addrgrp6.name firewall.vip6.name firewall.vipgrp6.name.
           string / required
    dstaddr_negate              Choices:
    string                      • enable       When enabled dstaddr specifies what the destination address must NOT be.
                                • disable
    dstintf                                    Outgoing (egress) interface.
    list
           name                                Interface name. Source system.interface.name system.zone.name.
           string / required
    firewall_session_dirty      Choices:
    string                      • check-all    How to handle sessions if the configuration of this firewall policy changes.
                                • check-new
    fixedport                   Choices:
    string                      • enable       Enable to prevent source NAT from changing a session's source port.
                                • disable
    global_label                               Label for the policy that appears when the GUI is in Global View mode.
    string
    groups                                     Names of user groups that can authenticate with this policy.
    list
           name                                Group name. Source user.group.name.
           string / required
    icap_profile                               Name of an existing ICAP profile. Source icap.profile.name.
    string
    inbound                     Choices:
    string                      • enable       Policy-based IPsec VPN: only traffic from the remote network can initiate a VPN.
                                • disable
    ippool                      Choices:
    string                      • enable       Enable to use IP Pools for source NAT.
                                • disable
    ips_sensor                                 Name of an existing IPS sensor. Source ips.sensor.name.
    string
    label                                      Label for the policy that appears when the GUI is in Section View mode.
    string
                                Choices:
    logtraffic                  • all          Enable or disable logging. Log all sessions or security profile sessions.
    string                      • utm
                                • disable
    logtraffic_start            Choices:
    string                      • enable       Record logs when a session starts and ends.
                                • disable
    name                                       Policy name.
    string
    nat                         Choices:
    string                      • enable       Enable/disable source NAT.
                                • disable
    natinbound                  Choices:
    string                      • enable       Policy-based IPsec VPN: apply destination NAT to inbound traffic.
                                • disable
    natoutbound                 Choices:
    string                      • enable       Policy-based IPsec VPN: apply source NAT to outbound traffic.
                                • disable
    outbound                    Choices:
    string                      • enable       Policy-based IPsec VPN: only traffic from the internal network can initiate a VPN.
                                • disable
    per_ip_shaper                              Per-IP traffic shaper. Source firewall.shaper.per-ip-shaper.name.
    string
    policyid                                   Policy ID.
    integer / required
    poolname                                   IP Pool names.
    list
           name                                IP pool name. Source firewall.ippool6.name.
           string / required
    profile_group                              Name of profile group. Source firewall.profile-group.name.
    string
    profile_protocol_options                   Name of an existing Protocol options profile. Source firewall.profile-protocol-options.name.
    string
    profile_type                Choices:
    string                      • single       Determine whether the firewall policy allows security profile groups or single profiles only.
                                • group
    replacemsg_override_group                  Override the default replacement message group for this policy. Source system.replacemsg-group.name.
    string
    rsso                        Choices:
    string                      • enable       Enable/disable RADIUS single sign-on (RSSO).
                                • disable
    schedule                                   Schedule name. Source firewall.schedule.onetime.name firewall.schedule.recurring.name firewall.schedule.group.name.
    string
    send_deny_packet            Choices:
    string                      • enable       Enable/disable return of deny-packet.
                                • disable
    service                                    Service and service group names.
    list
           name                                Address name. Source firewall.service.custom.name firewall.service.group.name.
           string / required
    service_negate              Choices:
    string                      • enable       When enabled service specifies what the service must NOT be.
                                • disable
    session_ttl                                Session TTL in seconds for sessions accepted by this policy. 0 means use the system default session TTL.
    integer
    spamfilter_profile                         Name of an existing Spam filter profile. Source spamfilter.profile.name.
    string
    srcaddr                                    Source address and address group names.
    list
           name                                Address name. Source firewall.address6.name firewall.addrgrp6.name.
           string / required
    srcaddr_negate              Choices:
    string                      • enable       When enabled srcaddr specifies what the source address must NOT be.
                                • disable
    srcintf                                    Incoming (ingress) interface.
    list
           name                                Interface name. Source system.zone.name system.interface.name.
           string / required
    ssh_filter_profile                         Name of an existing SSH filter profile. Source ssh-filter.profile.name.
    string
    ssl_mirror                  Choices:
    string                      • enable       Enable to copy decrypted SSL traffic to a FortiGate interface (called SSL mirroring).
                                • disable
    ssl_mirror_intf                            SSL mirror interface name.
    list
           name                                Interface name. Source system.zone.name system.interface.name.
           string / required
    ssl_ssh_profile                            Name of an existing SSL SSH profile. Source firewall.ssl-ssh-profile.name.
    string
                                               Deprecated
                                Choices:       Starting with Ansible 2.9 we recommend using the top-level 'state' parameter.
    state                       • present
    string                      • absent       ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                               Indicates whether to create or remove the object.
    status                      Choices:
    string                      • enable       Enable or disable this policy.
                                • disable
    tcp_mss_receiver                           Receiver TCP maximum segment size (MSS).
    integer
    tcp_mss_sender                             Sender TCP maximum segment size (MSS).
    integer
                                Choices:
    tcp_session_without_syn     • all          Enable/disable creation of TCP session without SYN flag.
    string                      • data-only
                                • disable
    timeout_send_rst            Choices:
    string                      • enable       Enable/disable sending RST packets when TCP sessions expire.
                                • disable
    traffic_shaper                             Reverse traffic shaper. Source firewall.shaper.traffic-shaper.name.
    string
    traffic_shaper_reverse                     Reverse traffic shaper. Source firewall.shaper.traffic-shaper.name.
    string
    url_category                               URL category ID list.
    list
           id                                  URL category ID.
           integer / required
    users                                      Names of individual users that can authenticate with this policy.
    list
           name                                Names of individual users that can authenticate with this policy. Source user.local.name.
           string / required
    utm_status                  Choices:
    string                      • enable       Enable AV/web/ips protection profile.
                                • disable
    uuid                                       Universally Unique Identifier (UUID; automatically assigned but can be manually reset).
    string
    vlan_cos_fwd                               VLAN forward direction user priority: 255 passthrough, 0 lowest, 7 highest
    integer
    vlan_cos_rev                               VLAN reverse direction user priority: 255 passthrough, 0 lowest, 7 highest
    integer
    vlan_filter                                Set VLAN filters.
    string
    voip_profile                               Name of an existing VoIP profile. Source voip.profile.name.
    string
    vpntunnel                                  Policy-based IPsec VPN: name of the IPsec VPN Phase 1. Source vpn.ipsec.phase1.name vpn.ipsec.manualkey.name.
    string
    webfilter_profile                          Name of an existing Web filter profile. Source webfilter.profile.name.
    string
   host                                        FortiOS or FortiGate IP address.
   string
   https                        Choices:
   boolean                      • no           Indicates if the requests towards FortiGate must use HTTPS protocol.
                                • yes ←
   password                   Default:         FortiOS or FortiGate password.
   string                     ""
   ssl_verify                   Choices:
   boolean                      • no           Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                 • yes ←
   state                        Choices:       Indicates whether to create or remove the object. This attribute was present already in previous version in a deeper level. It has been moved out to
   string                       • present      this outer level.
   added in 2.9                 • absent
   username                                    FortiOS or FortiGate username.
   string
   vdom                       Default:         Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different unit.
   string                     "root"

NOTES                   *fortios_firewall_policy6-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_firewall_policy6-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Configure IPv6 policies.
     fortios_firewall_policy6:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       state: "present"
       firewall_policy6:
         action: "accept"
         app_category:
          -
             id:  "5"
         app_group:
          -
             name: "default_name_7 (source application.group.name)"
         application:
          -
             id:  "9"
         application_list: "<your_own_value> (source application.list.name)"
         av_profile: "<your_own_value> (source antivirus.profile.name)"
         comments: "<your_own_value>"
         custom_log_fields:
          -
             field_id: "<your_own_value> (source log.custom-field.id)"
         devices:
          -
             name: "default_name_16 (source user.device.alias user.device-group.name user.device-category.name)"
         diffserv_forward: "enable"
         diffserv_reverse: "enable"
         diffservcode_forward: "<your_own_value>"
         diffservcode_rev: "<your_own_value>"
         dlp_sensor: "<your_own_value> (source dlp.sensor.name)"
         dscp_match: "enable"
         dscp_negate: "enable"
         dscp_value: "<your_own_value>"
         dsri: "enable"
         dstaddr:
          -
             name: "default_name_27 (source firewall.address6.name firewall.addrgrp6.name firewall.vip6.name firewall.vipgrp6.name)"
         dstaddr_negate: "enable"
         dstintf:
          -
             name: "default_name_30 (source system.interface.name system.zone.name)"
         firewall_session_dirty: "check-all"
         fixedport: "enable"
         global_label: "<your_own_value>"
         groups:
          -
             name: "default_name_35 (source user.group.name)"
         icap_profile: "<your_own_value> (source icap.profile.name)"
         inbound: "enable"
         ippool: "enable"
         ips_sensor: "<your_own_value> (source ips.sensor.name)"
         label: "<your_own_value>"
         logtraffic: "all"
         logtraffic_start: "enable"
         name: "default_name_43"
         nat: "enable"
         natinbound: "enable"
         natoutbound: "enable"
         outbound: "enable"
         per_ip_shaper: "<your_own_value> (source firewall.shaper.per-ip-shaper.name)"
         policyid: "49"
         poolname:
          -
             name: "default_name_51 (source firewall.ippool6.name)"
         profile_group: "<your_own_value> (source firewall.profile-group.name)"
         profile_protocol_options: "<your_own_value> (source firewall.profile-protocol-options.name)"
         profile_type: "single"
         replacemsg_override_group: "<your_own_value> (source system.replacemsg-group.name)"
         rsso: "enable"
         schedule: "<your_own_value> (source firewall.schedule.onetime.name firewall.schedule.recurring.name firewall.schedule.group.name)"
         send_deny_packet: "enable"
         service:
          -
             name: "default_name_60 (source firewall.service.custom.name firewall.service.group.name)"
         service_negate: "enable"
         session_ttl: "62"
         spamfilter_profile: "<your_own_value> (source spamfilter.profile.name)"
         srcaddr:
          -
             name: "default_name_65 (source firewall.address6.name firewall.addrgrp6.name)"
         srcaddr_negate: "enable"
         srcintf:
          -
             name: "default_name_68 (source system.zone.name system.interface.name)"
         ssh_filter_profile: "<your_own_value> (source ssh-filter.profile.name)"
         ssl_mirror: "enable"
         ssl_mirror_intf:
          -
             name: "default_name_72 (source system.zone.name system.interface.name)"
         ssl_ssh_profile: "<your_own_value> (source firewall.ssl-ssh-profile.name)"
         status: "enable"
         tcp_mss_receiver: "75"
         tcp_mss_sender: "76"
         tcp_session_without_syn: "all"
         timeout_send_rst: "enable"
         traffic_shaper: "<your_own_value> (source firewall.shaper.traffic-shaper.name)"
         traffic_shaper_reverse: "<your_own_value> (source firewall.shaper.traffic-shaper.name)"
         url_category:
          -
             id:  "82"
         users:
          -
             name: "default_name_84 (source user.local.name)"
         utm_status: "enable"
         uuid: "<your_own_value>"
         vlan_cos_fwd: "87"
         vlan_cos_rev: "88"
         vlan_filter: "<your_own_value>"
         voip_profile: "<your_own_value> (source voip.profile.name)"
         vpntunnel: "<your_own_value> (source vpn.ipsec.phase1.name vpn.ipsec.manualkey.name)"
         webfilter_profile: "<your_own_value> (source webfilter.profile.name)"

RETURN VALUES                   *fortios_firewall_policy6-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_firewall_policy6-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_firewall_policy6-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_firewall_policy6_module.html

SYNOPSIS                   *fmgr_secprof_web*

     • Manage web filter security profiles in FortiManager through playbooks using the FMG API

PARAMETERS                   *fmgr_secprof_web-parameters*

                 Parameter                       Choices/Defaults                                                                  Comments
   adom                                  Default:                         The ADOM the configuration should belong to.
   -                                     "root"
   comment                                                                Optional comments.
   -
   extended_log                            Choices:                       Enable/disable extended logging for web filtering.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
                                                                          EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                          List of multiple child objects to be added. Expects a list of dictionaries.
   ftgd_wf                                                                Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                      If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                          This object is MUTUALLY EXCLUSIVE with its options.
                                                                          We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                          WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   ftgd_wf_exempt_quota                                                   Do not stop quota for these categories.
   -
                                           Choices:                       Action to take for matches.
   ftgd_wf_filters_action                  • block                        choice | block | Block access.
   -                                       • monitor                      choice | monitor | Allow access while logging the action.
                                           • warning                      choice | warning | Allow access after warning the user.
                                           • authenticate                 choice | authenticate | Authenticate user before allowing access.
   ftgd_wf_filters_auth_usr_grp                                           Groups with permission to authenticate.
   -
   ftgd_wf_filters_category                                               Categories and groups the filter examines.
   -
   ftgd_wf_filters_log                     Choices:                       Enable/disable logging.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   ftgd_wf_filters_override_replacemsg                                    Override replacement message.
   -
   ftgd_wf_filters_warn_duration                                          Duration of warnings.
   -
   ftgd_wf_filters_warning_duration_type   Choices:                       Re-display warning after closing browser or after a timeout.
   -                                       • session                      choice | session | After session ends.
                                           • timeout                      choice | timeout | After timeout occurs.
   ftgd_wf_filters_warning_prompt          Choices:                       Warning prompts in each category or each domain.
   -                                       • per-domain                   choice | per-domain | Per-domain warnings.
                                           • per-category                 choice | per-category | Per-category warnings.
   ftgd_wf_max_quota_timeout                                              Maximum FortiGuard quota used by single page view in seconds (excludes streams).
   -
                                           Choices:                       Options for FortiGuard Web Filter.
                                           • error-allow                  FLAG Based Options. Specify multiple in list form.
   ftgd_wf_options                         • rate-server-ip               flag | error-allow | Allow web pages with a rating error to pass through.
   -                                       • connect-request-bypass       flag | rate-server-ip | Rate the server IP in addition to the domain name.
                                           • ftgd-disable                 flag | connect-request-bypass | Bypass connection which has CONNECT request.
                                                                          flag | ftgd-disable | Disable FortiGuard scanning.
   ftgd_wf_ovrd                                                           Allow web filter profile overrides.
   -
   ftgd_wf_quota_category                                                 FortiGuard categories to apply quota to (category action must be set to monitor).
   -
   ftgd_wf_quota_duration                                                 Duration of quota.
   -
   ftgd_wf_quota_override_replacemsg                                      Override replacement message.
   -
   ftgd_wf_quota_type                      Choices:                       Quota type.
   -                                       • time                         choice | time | Use a time-based quota.
                                           • traffic                      choice | traffic | Use a traffic-based quota.
                                           Choices:                       Traffic quota unit of measurement.
   ftgd_wf_quota_unit                      • B                            choice | B | Quota in bytes.
   -                                       • KB                           choice | KB | Quota in kilobytes.
                                           • MB                           choice | MB | Quota in megabytes.
                                           • GB                           choice | GB | Quota in gigabytes.
   ftgd_wf_quota_value                                                    Traffic quota value.
   -
   ftgd_wf_rate_crl_urls                   Choices:                       Enable/disable rating CRL by URL.
   -                                       • disable                      choice | disable | Disable rating CRL by URL.
                                           • enable                       choice | enable | Enable rating CRL by URL.
   ftgd_wf_rate_css_urls                   Choices:                       Enable/disable rating CSS by URL.
   -                                       • disable                      choice | disable | Disable rating CSS by URL.
                                           • enable                       choice | enable | Enable rating CSS by URL.
   ftgd_wf_rate_image_urls                 Choices:                       Enable/disable rating images by URL.
   -                                       • disable                      choice | disable | Disable rating images by URL (blocked images are replaced with blanks).
                                           • enable                       choice | enable | Enable rating images by URL (blocked images are replaced with blanks).
   ftgd_wf_rate_javascript_urls            Choices:                       Enable/disable rating JavaScript by URL.
   -                                       • disable                      choice | disable | Disable rating JavaScript by URL.
                                           • enable                       choice | enable | Enable rating JavaScript by URL.
   https_replacemsg                        Choices:                       Enable replacement messages for HTTPS.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   inspection_mode                         Choices:                       Web filtering inspection mode.
   -                                       • proxy                        choice | proxy | Proxy.
                                           • flow-based                   choice | flow-based | Flow based.
   log_all_url                             Choices:                       Enable/disable logging all URLs visited.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
                                           Choices:
   mode                                    • add ←                        Sets one of three modes for managing the object.
   -                                       • set                          Allows use of soft-adds instead of overwriting existing values
                                           • delete
                                           • update
   name                                                                   Profile name.
   -
                                           Choices:                       FLAG Based Options. Specify multiple in list form.
                                           • block-invalid-url            flag | block-invalid-url | Block sessions contained an invalid domain name.
                                           • jscript                      flag | jscript | Javascript block.
                                           • js                           flag | js | JS block.
                                           • vbs                          flag | vbs | VB script block.
   options                                 • unknown                      flag | unknown | Unknown script block.
   -                                       • wf-referer                   flag | wf-referer | Referring block.
                                           • intrinsic                    flag | intrinsic | Intrinsic script block.
                                           • wf-cookie                    flag | wf-cookie | Cookie block.
                                           • per-user-bwl                 flag | per-user-bwl | Per-user black/white list filter
                                           • activexfilter                flag | activexfilter | ActiveX filter.
                                           • cookiefilter                 flag | cookiefilter | Cookie filter.
                                           • javafilter                   flag | javafilter | Java applet filter.
                                                                          EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                          List of multiple child objects to be added. Expects a list of dictionaries.
   override                                                               Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                      If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                          This object is MUTUALLY EXCLUSIVE with its options.
                                                                          We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                          WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   override_ovrd_cookie                    Choices:                       Allow/deny browser-based (cookie) overrides.
   -                                       • deny                         choice | deny | Deny browser-based (cookie) override.
                                           • allow                        choice | allow | Allow browser-based (cookie) override.
   override_ovrd_dur                                                      Override duration.
   -
   override_ovrd_dur_mode                  Choices:                       Override duration mode.
   -                                       • constant                     choice | constant | Constant mode.
                                           • ask                          choice | ask | Prompt for duration when initiating an override.
                                           Choices:                       Override scope.
                                           • user                         choice | user | Override for the user.
   override_ovrd_scope                     • user-group                   choice | user-group | Override for the user's group.
   -                                       • ip                           choice | ip | Override for the initiating IP.
                                           • ask                          choice | ask | Prompt for scope when initiating an override.
                                           • browser                      choice | browser | Create browser-based (cookie) override.
   override_ovrd_user_group                                               User groups with permission to use the override.
   -
   override_profile                                                       Web filter profile with permission to create overrides.
   -
                                           Choices:                       Profile attribute to retrieve from the RADIUS server.
                                           • User-Name                    choice | User-Name | Use this attribute.
                                           • NAS-IP-Address               choice | NAS-IP-Address | Use this attribute.
                                           • Framed-IP-Address            choice | Framed-IP-Address | Use this attribute.
                                           • Framed-IP-Netmask            choice | Framed-IP-Netmask | Use this attribute.
                                           • Filter-Id                    choice | Filter-Id | Use this attribute.
                                           • Login-IP-Host                choice | Login-IP-Host | Use this attribute.
                                           • Reply-Message                choice | Reply-Message | Use this attribute.
                                           • Callback-Number              choice | Callback-Number | Use this attribute.
                                           • Callback-Id                  choice | Callback-Id | Use this attribute.
   override_profile_attribute              • Framed-Route                 choice | Framed-Route | Use this attribute.
   -                                       • Framed-IPX-Network           choice | Framed-IPX-Network | Use this attribute.
                                           • Class                        choice | Class | Use this attribute.
                                           • Called-Station-Id            choice | Called-Station-Id | Use this attribute.
                                           • Calling-Station-Id           choice | Calling-Station-Id | Use this attribute.
                                           • NAS-Identifier               choice | NAS-Identifier | Use this attribute.
                                           • Proxy-State                  choice | Proxy-State | Use this attribute.
                                           • Login-LAT-Service            choice | Login-LAT-Service | Use this attribute.
                                           • Login-LAT-Node               choice | Login-LAT-Node | Use this attribute.
                                           • Login-LAT-Group              choice | Login-LAT-Group | Use this attribute.
                                           • Framed-AppleTalk-Zone        choice | Framed-AppleTalk-Zone | Use this attribute.
                                           • Acct-Session-Id              choice | Acct-Session-Id | Use this attribute.
                                           • Acct-Multi-Session-Id        choice | Acct-Multi-Session-Id | Use this attribute.
   override_profile_type                   Choices:                       Override profile type.
   -                                       • list                         choice | list | Profile chosen from list.
                                           • radius                       choice | radius | Profile determined by RADIUS server.
                                           Choices:                       FLAG Based Options. Specify multiple in list form.
   ovrd_perm                               • bannedword-override          flag | bannedword-override | Banned word override.
   -                                       • urlfilter-override           flag | urlfilter-override | URL filter override.
                                           • fortiguard-wf-override       flag | fortiguard-wf-override | FortiGuard Web Filter override.
                                           • contenttype-check-override   flag | contenttype-check-override | Content-type header override.
   post_action                             Choices:                       Action taken for HTTP POST traffic.
   -                                       • normal                       choice | normal | Normal, POST requests are allowed.
                                           • block                        choice | block | POST requests are blocked.
   replacemsg_group                                                       Replacement message group.
   -
                                                                          EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                          List of multiple child objects to be added. Expects a list of dictionaries.
   url_extraction                                                         Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                      If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                          This object is MUTUALLY EXCLUSIVE with its options.
                                                                          We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                          WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   url_extraction_redirect_header                                         HTTP header name to use for client redirect on blocked requests
   -
   url_extraction_redirect_no_content      Choices:                       Enable / Disable empty message-body entity in HTTP response
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   url_extraction_redirect_url                                            HTTP header value to use for client redirect on blocked requests
   -
   url_extraction_server_fqdn                                             URL extraction server FQDN (fully qualified domain name)
   -
   url_extraction_status                   Choices:                       Enable URL Extraction
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
                                                                          EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                          List of multiple child objects to be added. Expects a list of dictionaries.
   web                                                                    Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                      If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                          This object is MUTUALLY EXCLUSIVE with its options.
                                                                          We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                          WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   web_blacklist                           Choices:                       Enable/disable automatic addition of URLs detected by FortiSandbox to blacklist.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_bword_table                                                        Banned word table ID.
   -
   web_bword_threshold                                                    Banned word score threshold.
   -
   web_content_header_list                                                Content header list.
   -
   web_content_log                         Choices:                       Enable/disable logging logging blocked web content.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_extended_all_action_log             Choices:                       Enable/disable extended any filter action logging for web filtering.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_activex_log                  Choices:                       Enable/disable logging ActiveX.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_applet_log                   Choices:                       Enable/disable logging Java applets.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_command_block_log            Choices:                       Enable/disable logging blocked commands.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_cookie_log                   Choices:                       Enable/disable logging cookie filtering.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_cookie_removal_log           Choices:                       Enable/disable logging blocked cookies.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_js_log                       Choices:                       Enable/disable logging Java scripts.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_jscript_log                  Choices:                       Enable/disable logging JScripts.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_referer_log                  Choices:                       Enable/disable logging referrers.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_unknown_log                  Choices:                       Enable/disable logging unknown scripts.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_filter_vbs_log                      Choices:                       Enable/disable logging VBS scripts.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_ftgd_err_log                        Choices:                       Enable/disable logging rating errors.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_ftgd_quota_usage                    Choices:                       Enable/disable logging daily quota usage.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_invalid_domain_log                  Choices:                       Enable/disable logging invalid domain names.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_keyword_match                                                      Search keywords to log when match is found.
   -
   web_log_search                          Choices:                       Enable/disable logging all search phrases.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
                                           Choices:                       Safe search type.
   web_safe_search                         • url                          FLAG Based Options. Specify multiple in list form.
   -                                       • header                       flag | url | Insert safe search string into URL.
                                                                          flag | header | Insert safe search header.
   web_url_log                             Choices:                       Enable/disable logging URL filtering.
   -                                       • disable                      choice | disable | Disable setting.
                                           • enable                       choice | enable | Enable setting.
   web_urlfilter_table                                                    URL filter table ID.
   -
                                           Choices:                       FortiGuard whitelist settings.
                                           • exempt-av                    FLAG Based Options. Specify multiple in list form.
                                           • exempt-webcontent            flag | exempt-av | Exempt antivirus.
   web_whitelist                           • exempt-activex-java-cookie   flag | exempt-webcontent | Exempt web content.
   -                                       • exempt-dlp                   flag | exempt-activex-java-cookie | Exempt ActiveX-JAVA-Cookie.
                                           • exempt-rangeblock            flag | exempt-dlp | Exempt DLP.
                                           • extended-log-others          flag | exempt-rangeblock | Exempt RangeBlock.
                                                                          flag | extended-log-others | Support extended log.
                                           Choices:                       YouTube EDU filter level.
   web_youtube_restrict                    • strict                       choice | strict | Strict access for YouTube.
   -                                       • none                         choice | none | Full access for YouTube.
                                           • moderate                     choice | moderate | Moderate access for YouTube.
   wisp                                    Choices:                       Enable/disable web proxy WISP.
   -                                       • disable                      choice | disable | Disable web proxy WISP.
                                           • enable                       choice | enable | Enable web proxy WISP.
                                           Choices:                       WISP server selection algorithm.
   wisp_algorithm                          • auto-learning                choice | auto-learning | Select the lightest loading healthy server.
   -                                       • primary-secondary            choice | primary-secondary | Select the first healthy server in order.
                                           • round-robin                  choice | round-robin | Select the next healthy server.
   wisp_servers                                                           WISP servers.
   -
                                                                          EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                          List of multiple child objects to be added. Expects a list of dictionaries.
   youtube_channel_filter                                                 Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                      If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                          This object is MUTUALLY EXCLUSIVE with its options.
                                                                          We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                          WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   youtube_channel_filter_channel_id                                      YouTube channel ID to be filtered.
   -
   youtube_channel_filter_comment                                         Comment.
   -
                                           Choices:                       YouTube channel filter status.
   youtube_channel_status                  • disable                      choice | disable | Disable YouTube channel filter.
   -                                       • blacklist                    choice | blacklist | Block matches.
                                           • whitelist                    choice | whitelist | Allow matches.

NOTES                   *fmgr_secprof_web-notes*

   Note

     • Full Documentation at https://ftnt-ansible-docs.readthedocs.io/en/latest/.

EXAMPLES                   *fmgr_secprof_web-examples*

 - name: DELETE Profile
   fmgr_secprof_web:
     name: "Ansible_Web_Filter_Profile"
     mode: "delete"

 - name: CREATE Profile
   fmgr_secprof_web:
     name: "Ansible_Web_Filter_Profile"
     comment: "Created by Ansible Module TEST"
     mode: "set"
     extended_log: "enable"
     inspection_mode: "proxy"
     log_all_url: "enable"
     options: "js"
     ovrd_perm: "bannedword-override"
     post_action: "block"
     web_content_log: "enable"
     web_extended_all_action_log: "enable"
     web_filter_activex_log: "enable"
     web_filter_applet_log: "enable"
     web_filter_command_block_log: "enable"
     web_filter_cookie_log: "enable"
     web_filter_cookie_removal_log: "enable"
     web_filter_js_log: "enable"
     web_filter_jscript_log: "enable"
     web_filter_referer_log: "enable"
     web_filter_unknown_log: "enable"
     web_filter_vbs_log: "enable"
     web_ftgd_err_log: "enable"
     web_ftgd_quota_usage: "enable"
     web_invalid_domain_log: "enable"
     web_url_log: "enable"
     wisp: "enable"
     wisp_algorithm: "auto-learning"
     youtube_channel_status: "blacklist"

RETURN VALUES                   *fmgr_secprof_web-return values*

   Common return values are documented here, the following are the fields unique to this module:

      Key     Returned                                                                                  Description
   api_result always   full API response, includes status code and message
   string

STATUS                   *fmgr_secprof_web-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Luke Weighall (@lweighall)
     • Andrew Welsh (@Ghilli3)
     • Jim Huber (@p4r4n0y1ng)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fmgr_secprof_web-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fmgr_secprof_web_module.html

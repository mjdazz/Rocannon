SYNOPSIS                   *win_domain_user*

     • Manages Windows Active Directory user accounts.

PARAMETERS                   *win_domain_user-parameters*

            Parameter          Choices/Defaults                                                                       Comments
                                                no will unlock the user account if locked.
   account_locked                Choices:       Note that there is not a way to lock an account as an administrator.
   -                             • no           Accounts are locked due to user actions; as an admin, you may only unlock a locked account.
                                                If you wish to administratively disable an account, set enabled to no.
   attributes                                   A dict of custom LDAP attributes to set on the user.
   string                                       This can be used to set custom attributes that are not exposed as module parameters, e.g. telephoneNumber.
   added in 2.5                                 See the examples on how to format this parameter.
   city                                         Configures the user's city.
   string
   company                                      Configures the user's company name.
   string
   country                                      Configures the user's country code.
   string                                       Note that this is a two-character ISO 3166 code.
   description                                  Description of the user
   string
   domain_password
   string                                       The password for username.
   added in 2.5
   domain_server                                Specifies the Active Directory Domain Services instance to connect to.
   string                                       Can be in the form of an FQDN or NetBIOS name.
   added in 2.5                                 If not specified then the value is based on the domain of the computer running PowerShell.
   domain_username                              The username to use when interacting with AD.
   string                                       If this is not set then the user Ansible used to log in with will be used instead when using CredSSP or Kerberos with credential delegation.
   added in 2.5
   email                                        Configures the user's email address.
   string                                       This is a record in AD and does not do anything to configure any email servers or systems.
   enabled                       Choices:       yes will enable the user account.
   boolean                       • no           no will disable the account.
                                 • yes ←
   firstname                                    Configures the user's first name (given name).
   string
   groups                                       Adds or removes the user from this list of groups, depending on the value of groups_action.
   list                                         To remove all but the Principal Group, set groups=<principal group name> and groups_action=replace.
                                                Note that users cannot be removed from their principal group (for example, "Domain Users").
                                 Choices:       If add, the user is added to each group in groups where not already a member.
   groups_action                 • add          If remove, the user is removed from each group in groups.
   string                        • remove       If replace, the user is added as a member of each group in groups and removed from any other groups.
                                 • replace ←
   name                                         Name of the user to create, remove or modify.
   string / required
   password                                     Optionally set the user's password to this (plain text) value.
   string                                       To enable an account - enabled - a password must already be configured on the account, or you must provide a password here.
   password_expired              Choices:       yes will require the user to change their password at next login.
   boolean                       • no           no will clear the expired password flag.
                                 • yes          This is mutually exclusive with password_never_expires.
   password_never_expires        Choices:       yes will set the password to never expire.
   boolean                       • no           no will allow the password to expire.
                                 • yes          This is mutually exclusive with password_expired.
   path                                         Container or OU for the new user; if you do not specify this, the user will be placed in the default container for users in the domain.
   string                                       Setting the path is only available when a new user is created; if you specify a path on an existing user, the user's path will not be updated - you
                                                must delete (e.g., state=absent) the user and then re-add the user with the appropriate path.
   postal_code                                  Configures the user's postal code / zip code.
   string
                                 Choices:       When present, creates or updates the user account.
   state                         • absent       When absent, removes the user account if it exists.
   string                        • present ←    When query, retrieves the user account details without making any changes.
                                 • query
   state_province                               Configures the user's state or province.
   string
   street                                       Configures the user's street address.
   string
   surname                                      Configures the user's last name (surname).
   string
                                 Choices:       always will always update passwords.
   update_password               • always ←     on_create will only set the password for newly created users.
   string                        • on_create    when_changed will only set the password when changed (added in ansible 2.9).
                                 • when_changed
   upn                                          Configures the User Principal Name (UPN) for the account.
   string                                       This is not required, but is best practice to configure for modern versions of Active Directory.
                                                The format is <username>@<domain>.
   user_cannot_change_password   Choices:       yes will prevent the user from changing their password.
   boolean                       • no           no will allow the user to change their password.
                                 • yes

NOTES                   *win_domain_user-notes*

   Note

     • Works with Windows 2012R2 and newer.
     • If running on a server that is not a Domain Controller, credential delegation through CredSSP or Kerberos with delegation must be used or the domain_username, domain_password must be set.
     • Note that some individuals have confirmed successful operation on Windows 2008R2 servers with AD and AD Web Services enabled, but this has not received the same degree of testing as Windows
       2012R2.

SEE ALSO                   *win_domain_user-see also*

   See also

   win_domain – Ensures the existence of a Windows domain
   The official documentation on the win_domain module.

   win_domain_controller – Manage domain controller/member server state for a Windows host
   The official documentation on the win_domain_controller module.

   win_domain_computer – Manage computers in Active Directory
   The official documentation on the win_domain_computer module.

   win_domain_group – Creates, modifies or removes domain groups
   The official documentation on the win_domain_group module.

   win_domain_membership – Manage domain/workgroup membership for a Windows host
   The official documentation on the win_domain_membership module.

   win_user – Manages local Windows user accounts
   The official documentation on the win_user module.

   win_user_profile – Manages the Windows user profiles
   The official documentation on the win_user_profile module.

EXAMPLES                   *win_domain_user-examples*

 - name: Ensure user bob is present with address information
   win_domain_user:
     name: bob
     firstname: Bob
     surname: Smith
     company: BobCo
     password: B0bP4ssw0rd
     state: present
     groups:
       - Domain Admins
     street: 123 4th St.
     city: Sometown
     state_province: IN
     postal_code: 12345
     country: US
     attributes:
       telephoneNumber: 555-123456

 - name: Ensure user bob is created and use custom credentials to create the user
   win_domain_user:
     name: bob
     firstname: Bob
     surname: Smith
     password: B0bP4ssw0rd
     state: present
     domain_username: DOMAIN\admin-account
     domain_password: SomePas2w0rd
     domain_server: [email protected]

 - name: Ensure user bob is present in OU ou=test,dc=domain,dc=local
   win_domain_user:
     name: bob
     password: B0bP4ssw0rd
     state: present
     path: ou=test,dc=domain,dc=local
     groups:
       - Domain Admins

 - name: Ensure user bob is absent
   win_domain_user:
     name: bob
     state: absent

RETURN VALUES                   *win_domain_user-return values*

   Common return values are documented here, the following are the fields unique to this module:

               Key             Returned                                                                          Description
   account_locked              always   true if the account is locked
   boolean
   changed                     always   true if the account changed during execution
   boolean
   city                                 The user city
   string                      always   Sample:
                                        Indianapolis
   company                              The user company
   string                      always   Sample:
                                        RedHat
   country                              The user country
   string                      always   Sample:
                                        US
   created                              Whether a user was created
   boolean                     always   Sample:
                                        True
   description                          A description of the account
   string                      always   Sample:
                                        Server Administrator
   distinguished_name                   DN of the user account
   string                      always   Sample:
                                        CN=nick,OU=test,DC=domain,DC=local
   email                                The user email address
   string                      always   Sample:
                                        [email protected]
   enabled                              true if the account is enabled and false if disabled
   string                      always   Sample:
                                        True
   firstname                            The user first name
   string                      always   Sample:
                                        Nick
   groups                               AD Groups to which the account belongs
   list                        always   Sample:
                                        ['Domain Admins', 'Domain Users']
   msg                                  Summary message of whether the user is present or absent
   string                      always   Sample:
                                        User nick is present
   name                                 The username on the account
   string                      always   Sample:
                                        nick
   password_expired            always   true if the account password has expired
   boolean
   password_updated                     true if the password changed during this execution
   boolean                     always   Sample:
                                        True
   postal_code                          The user postal code
   string                      always   Sample:
                                        46033
   sid                                  The SID of the account
   string                      always   Sample:
                                        S-1-5-21-2752426336-228313920-2202711348-1175
   state                                The state of the user account
   string                      always   Sample:
                                        present
   state_province                       The user state or province
   string                      always   Sample:
                                        IN
   street                               The user street address
   string                      always   Sample:
                                        123 4th St.
   surname                              The user last name
   string                      always   Sample:
                                        Doe
   upn                                  The User Principal Name of the account
   string                      always   Sample:
                                        [email protected]
   user_cannot_change_password always   true if the user is not allowed to change password
   string

STATUS                   *win_domain_user-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Nick Chandler (@nwchandler)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *win_domain_user-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/win_domain_user_module.html

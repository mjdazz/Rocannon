SYNOPSIS                   *bigip_pool_member*

     • Manages F5 BIG-IP LTM pool members via iControl SOAP API.

PARAMETERS                   *bigip_pool_member-parameters*

           Parameter          Choices/Defaults                                                                        Comments
   address                                      IP address of the pool member. This can be either IPv4 or IPv6. When creating a new pool member, one of either address or fqdn must be provided. This
   string                                       parameter cannot be updated after it is set.
                                                aliases: ip, host
                                                List of pool member definitions to be created, modified or removed.
   aggregate                                    When using aggregates if one of the aggregate definitions is invalid, the aggregate run will fail, indicating the error it last encountered.
   list                                         The module will NOT rollback any changes it has made prior to encountering the error.
   added in 2.8                                 The module also will not indicate what changes were made prior to failure, therefore it is strongly advised to run the module in check mode to make
                                                basic validation, prior to module execution.
                                                aliases: members
   availability_requirements                    Specifies, if you activate more than one health monitor, the number of health monitors that must receive successful responses in order for the link
   dictionary                                   to be considered available.
   added in 2.8                                 Specifying an empty string will remove the monitors and revert to inheriting from pool (default).
                                                Specifying none value will remove any health monitoring from the member completely.
        at_least                                Specifies the minimum number of active health monitors that must be successful before the link is considered up.
        integer                                 This parameter is only relevant when a type of at_least is used.
                                                This parameter will be ignored if a type of all is used.
        type                   Choices:         Monitor rule type when monitors is specified.
        string                 • all            When creating a new pool, if this value is not specified, the default of 'all' will be used.
                               • at_least
   connection_limit                             Pool member connection limit. Setting this to 0 disables the limit.
   integer
   description                                  Pool member description.
   string
                                                FQDN name of the pool member. This can be any name that is a valid RFC 1123 DNS name. Therefore, the only characters that can be used are "A" to "Z",
   fqdn                                         "a" to "z", "0" to "9", the hyphen ("-") and the period (".").
   string                                       FQDN names must include at lease one period; delineating the host from the domain. ex. host.domain.
   added in 2.6                                 FQDN names must end with a letter or a number.
                                                When creating a new pool member, one of either address or fqdn must be provided. This parameter cannot be updated after it is set.
                                                aliases: hostname
                                                Specifies whether the system automatically creates ephemeral nodes using the IP addresses returned by the resolution of a DNS query for a node
                                                defined by an FQDN.
   fqdn_auto_populate          Choices:         When yes, the system generates an ephemeral node for each IP address returned in response to a DNS query for the FQDN of the node. Additionally, when
   boolean                     • no             a DNS response indicates the IP address of an ephemeral node no longer exists, the system deletes the ephemeral node.
   added in 2.6                • yes            When no, the system resolves a DNS query for the FQDN of the node with the single IP address associated with the FQDN.
                                                When creating a new pool member, the default for this parameter is yes.
                                                Once set this parameter cannot be changed afterwards.
                                                This parameter is ignored when reuse_nodes is yes.
                                                Specifies the IP encapsulation using either IPIP (IP encapsulation within IP, RFC 2003) or GRE (Generic Router Encapsulation, RFC 2784) on outbound
   ip_encapsulation                             packets (from BIG-IP system to server-pool member).
   string                                       When none, disables IP encapsulation.
   added in 2.8                                 When inherit, inherits IP encapsulation setting from the member's pool.
                                                When any other value, Options are None, Inherit from Pool, and Member Specific.
   monitors
   list                                         Specifies the health monitors that the system currently uses to monitor this resource.
   added in 2.8
   name                                         Name of the node to create, or re-use, when creating a new pool member.
   string                                       This parameter is optional and, if not specified, a node name will be created automatically from either the specified address or fqdn.
   added in 2.6                                 The enabled state is an alias of present.
   partition                 Default:           Partition to manage resources on.
   string                    "Common"
   pool                                         Pool name. This pool must exist.
   string / required
   port                                         Pool member port.
   integer / required                           This value cannot be changed after it has been set.
   preserve_node               Choices:         When state is absent attempts to remove the node that the pool member references.
   boolean                     • no             The node will not be removed if it is still referenced by other pool members. If this happens, the module will not raise an error.
                               • yes            Setting this to yes disables this behavior.
                                                Specifies a number representing the priority group for the pool member.
   priority_group                               When adding a new member, the default is 0, meaning that the member has no priority.
   integer                                      To specify a priority, you must activate priority group usage when you create a new pool or when adding or removing pool members. When activated, the
   added in 2.5                                 system load balances traffic according to the priority group number assigned to the pool member.
                                                The higher the number, the higher the priority, so a member with a priority of 3 has higher priority than a member with a priority of 1.
   provider
   dictionary                                   A dict object containing connection details.
   added in 2.5
        auth_provider                           Configures the auth provider for to obtain authentication tokens from the remote device.
        string                                  This option is really used when working with BIG-IQ devices.
        password                                The password for the user account used to connect to the BIG-IP.
        string / required                       You may omit this option by setting the environment variable F5_PASSWORD.
                                                aliases: pass, pwd
        server                                  The BIG-IP host.
        string / required                       You may omit this option by setting the environment variable F5_SERVER.
        server_port          Default:           The BIG-IP server port.
        integer              443                You may omit this option by setting the environment variable F5_SERVER_PORT.
        ssh_keyfile                             Specifies the SSH keyfile to use to authenticate the connection to the remote device. This argument is only used for cli transports.
        path                                    You may omit this option by setting the environment variable ANSIBLE_NET_SSH_KEYFILE.
        timeout                                 Specifies the timeout in seconds for communicating with the network device for either connecting or sending commands. If the timeout is exceeded
        integer                                 before the operation is completed, the module will error.
        transport              Choices:
        string                 • cli            Configures the transport connection to use when connecting to the remote device.
                               • rest ←
        user                                    The username to connect to the BIG-IP with. This user must have administrative privileges on the device.
        string / required                       You may omit this option by setting the environment variable F5_USER.
        validate_certs         Choices:         If no, SSL certificates are not validated. Use this only on personally controlled sites using self-signed certificates.
        boolean                • no             You may omit this option by setting the environment variable F5_VALIDATE_CERTS.
                               • yes ←
   rate_limit                                   Pool member rate limit (connections-per-second). Setting this to 0 disables the limit.
   integer
   ratio                                        Pool member ratio weight. Valid values range from 1 through 100. New pool members -- unless overridden with this value -- default to 1.
   integer
   replace_all_with            Choices:         Remove members not defined in the aggregate parameter.
   boolean                     • no ←           This operation is all or none, meaning that it will stop if there are some pool members that cannot be removed.
   added in 2.8                • yes            aliases: purge
   reuse_nodes                 Choices:
   boolean                     • no             Reuses node definitions if requested.
   added in 2.6                • yes ←
                               Choices:
                               • present ←
   state                       • absent         Pool member state.
   string / required           • enabled
                               • disabled
                               • forced_offline

NOTES                   *bigip_pool_member-notes*

   Note

     • In previous versions of this module, which used the SDK, the name parameter would act as fqdn if address or fqdn were not provided.
     • For more information on using Ansible to manage F5 Networks devices see https://www.ansible.com/integrations/networks/f5.
     • Requires BIG-IP software version >= 12.
     • The F5 modules only manipulate the running configuration of the F5 product. To ensure that BIG-IP specific configuration persists to disk, be sure to include at least one task that uses the
       bigip_config module to save the running configuration. Refer to the module’s documentation for the correct usage of the module to save your running configuration.

EXAMPLES                   *bigip_pool_member-examples*

 - name: Add pool member
   bigip_pool_member:
     pool: my-pool
     partition: Common
     host: "{{ ansible_default_ipv4['address'] }}"
     port: 80
     description: web server
     connection_limit: 100
     rate_limit: 50
     ratio: 2
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

 - name: Modify pool member ratio and description
   bigip_pool_member:
     pool: my-pool
     partition: Common
     host: "{{ ansible_default_ipv4['address'] }}"
     port: 80
     ratio: 1
     description: nginx server
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

 - name: Remove pool member from pool
   bigip_pool_member:
     state: absent
     pool: my-pool
     partition: Common
     host: "{{ ansible_default_ipv4['address'] }}"
     port: 80
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

 - name: Force pool member offline
   bigip_pool_member:
     state: forced_offline
     pool: my-pool
     partition: Common
     host: "{{ ansible_default_ipv4['address'] }}"
     port: 80
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

 - name: Create members with priority groups
   bigip_pool_member:
     pool: my-pool
     partition: Common
     host: "{{ item.address }}"
     name: "{{ item.name }}"
     priority_group: "{{ item.priority_group }}"
     port: 80
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost
   loop:
     - address: 1.1.1.1
       name: web1
       priority_group: 4
     - address: 2.2.2.2
       name: web2
       priority_group: 3
     - address: 3.3.3.3
       name: web3
       priority_group: 2
     - address: 4.4.4.4
       name: web4
       priority_group: 1

 - name: Add pool members aggregate
   bigip_pool_member:
     pool: my-pool
     aggregate:
       - host: 192.168.1.1
         partition: Common
         port: 80
         description: web server
         connection_limit: 100
         rate_limit: 50
         ratio: 2
       - host: 192.168.1.2
         partition: Common
         port: 80
         description: web server
         connection_limit: 100
         rate_limit: 50
         ratio: 2
       - host: 192.168.1.3
         partition: Common
         port: 80
         description: web server
         connection_limit: 100
         rate_limit: 50
         ratio: 2
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

 - name: Add pool members aggregate, remove non aggregates
   bigip_pool_member:
     pool: my-pool
     aggregate:
       - host: 192.168.1.1
         partition: Common
         port: 80
         description: web server
         connection_limit: 100
         rate_limit: 50
         ratio: 2
       - host: 192.168.1.2
         partition: Common
         port: 80
         description: web server
         connection_limit: 100
         rate_limit: 50
         ratio: 2
       - host: 192.168.1.3
         partition: Common
         port: 80
         description: web server
         connection_limit: 100
         rate_limit: 50
         ratio: 2
     replace_all_with: yes
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

RETURN VALUES                   *bigip_pool_member-return values*

   Common return values are documented here, the following are the fields unique to this module:

          Key         Returned                                                                              Description
   address                     The address of the pool member.
   string             changed  Sample:
                               1.2.3.4
   connection_limit            The new connection limit of the pool member
   integer            changed  Sample:
                               1000
   description                 The new description of pool member.
   string             changed  Sample:
                               My pool member
   fqdn                        The FQDN of the pool member.
   string             changed  Sample:
                               foo.bar.com
   fqdn_auto_populate          Whether FQDN auto population was set on the member or not.
   boolean            changed  Sample:
                               True
   monitors                    The new list of monitors for the resource.
   list               changed  Sample:
                               ['/Common/monitor1', '/Common/monitor2']
   priority_group              The new priority group.
   integer            changed  Sample:
                               3
   rate_limit                  The new rate limit, in connections per second, of the pool member.
   integer            changed  Sample:
                               100
   ratio                       The new pool member ratio weight.
   integer            changed  Sample:
                               50
   replace_all_with            Purges all non-aggregate pool members from device
   boolean            changed  Sample:
                               True

STATUS                   *bigip_pool_member-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by an Ansible Partner. [certified]

     • Tim Rupp (@caphrim007)
     • Wojciech Wypior (@wojtek0806)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *bigip_pool_member-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/bigip_pool_member_module.html

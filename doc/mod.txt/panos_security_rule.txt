DEPRECATED                   *panos_security_rule*

                                      Removed in Ansible:
                  version: 2.12
        Why:      Consolidating code base.
    Alternative:  Use https://galaxy.ansible.com/PaloAltoNetworks/paloaltonetworks instead.

SYNOPSIS                   *panos_security_rule-synopsis*

     • Security policies allow you to enforce rules and take action, and can be as general or specific as needed. The policy rules are compared against the incoming traffic in sequence, and because
       the first rule that matches the traffic is applied, the more specific rules must precede the more general ones.

REQUIREMENTS                   *panos_security_rule-requirements*

   The below requirements are needed on the host that executes this module.

     • pan-python can be obtained from PyPI https://pypi.org/project/pan-python/
     • pandevice can be obtained from PyPI https://pypi.org/project/pandevice/
     • xmltodict can be obtained from PyPI https://pypi.org/project/xmltodict/

PARAMETERS                   *panos_security_rule-parameters*

       Parameter       Choices/Defaults                                                                             Comments
   action            Default:              Action to apply once rules maches.
   -                 "allow"
   antivirus                               Name of the already defined antivirus profile.
   -
   api_key                                 API key that can be used instead of username/password credentials.
   -
   application       Default:              List of applications.
   -                 "any"
   category          Default:              The category.
   list              ["any"]
   commit              Choices:
   boolean             • no                Commit configuration if changed.
                       • yes ←
   data_filtering                          Name of the already defined data_filtering profile.
   -
   description                             Description for the security rule.
   -
   destination_ip    Default:              List of destination addresses.
   -                 "any"
   destination_zone  Default:              List of destination zones.
   -                 "any"
   devicegroup                             - Device groups are used for the Panorama interaction with Firewall(s). The group must exists on Panorama. If device group is not define we assume that we
   -                                       are contacting Firewall.
   file_blocking                           Name of the already defined file_blocking profile.
   -
   group_profile                           - Security profile group that is already defined in the system. This property supersedes antivirus, vulnerability, spyware, url_filtering, file_blocking,
   -                                       data_filtering, and wildfire_analysis properties.
   hip_profiles      Default:              - If you are using GlobalProtect with host information profile (HIP) enabled, you can also base the policy on information collected by GlobalProtect. For
   -                 "any"                 example, the user access level can be determined HIP that notifies the firewall about the user's local configuration.
   ip_address                              IP address (or hostname) of PAN-OS device being configured.
   - / required
   log_end             Choices:
   boolean             • no                Whether to log at session end.
                       • yes ←
   log_start           Choices:
   boolean             • no                Whether to log at session start.
                       • yes
                       Choices:
   operation           • add ←
   -                   • update            The action to be taken. Supported values are add/update/find/delete.
                       • delete
                       • find
   password                                Password credentials to use for auth unless api_key is set.
   - / required
   rule_name                               Name of the security rule.
   - / required
   rule_type         Default:              Type of security rule (version 6.1 of PanOS and above).
   -                 "universal"
   service           Default:              List of services.
   -                 "application-default"
   source_ip         Default:              List of source addresses.
   -                 "any"
   source_user       Default:              Use users to enforce policy for individual users or a group of users.
   -                 "any"
   source_zone       Default:              List of source zones.
   -                 "any"
   spyware                                 Name of the already defined spyware profile.
   -
   tag_name                                Administrative tags that can be added to the rule. Note, tags must be already defined.
   -
   url_filtering                           Name of the already defined url_filtering profile.
   -
   username          Default:              Username credentials to use for auth unless api_key is set.
   -                 "admin"
   vulnerability                           Name of the already defined vulnerability profile.
   -
   wildfire_analysis                       Name of the already defined wildfire_analysis profile.
   -

NOTES                   *panos_security_rule-notes*

   Note

     • Checkmode is not supported.
     • Panorama is supported.

EXAMPLES                   *panos_security_rule-examples*

 - name: add an SSH inbound rule to devicegroup
   panos_security_rule:
     ip_address: '{{ ip_address }}'
     username: '{{ username }}'
     password: '{{ password }}'
     operation: 'add'
     rule_name: 'SSH permit'
     description: 'SSH rule test'
     tag_name: ['ProjectX']
     source_zone: ['public']
     destination_zone: ['private']
     source_ip: ['any']
     source_user: ['any']
     destination_ip: ['1.1.1.1']
     category: ['any']
     application: ['ssh']
     service: ['application-default']
     hip_profiles: ['any']
     action: 'allow'
     devicegroup: 'Cloud Edge'

 - name: add a rule to allow HTTP multimedia only from CDNs
   panos_security_rule:
     ip_address: '10.5.172.91'
     username: 'admin'
     password: 'paloalto'
     operation: 'add'
     rule_name: 'HTTP Multimedia'
     description: 'Allow HTTP multimedia only to host at 1.1.1.1'
     source_zone: ['public']
     destination_zone: ['private']
     source_ip: ['any']
     source_user: ['any']
     destination_ip: ['1.1.1.1']
     category: ['content-delivery-networks']
     application: ['http-video', 'http-audio']
     service: ['service-http', 'service-https']
     hip_profiles: ['any']
     action: 'allow'

 - name: add a more complex rule that uses security profiles
   panos_security_rule:
     ip_address: '{{ ip_address }}'
     username: '{{ username }}'
     password: '{{ password }}'
     operation: 'add'
     rule_name: 'Allow HTTP w profile'
     log_start: false
     log_end: true
     action: 'allow'
     antivirus: 'default'
     vulnerability: 'default'
     spyware: 'default'
     url_filtering: 'default'
     wildfire_analysis: 'default'

 - name: delete a devicegroup security rule
   panos_security_rule:
     ip_address: '{{ ip_address }}'
     api_key: '{{ api_key }}'
     operation: 'delete'
     rule_name: 'Allow telnet'
     devicegroup: 'DC Firewalls'

 - name: find a specific security rule
   panos_security_rule:
     ip_address: '{{ ip_address }}'
     password: '{{ password }}'
     operation: 'find'
     rule_name: 'Allow RDP to DCs'
   register: result
 - debug: msg='{{result.stdout_lines}}'

STATUS                   *panos_security_rule-status*

     • This module will be removed in version 2.12. [deprecated]
     • For more information see DEPRECATED.

     • Ivan Bojer (@ivanbojer), Robert Hagen (@rnh556)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *panos_security_rule-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/panos_security_rule_module.html

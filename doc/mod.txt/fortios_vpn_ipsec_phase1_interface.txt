SYNOPSIS                   *fortios_vpn_ipsec_phase1_interface*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify vpn_ipsec feature and phase1_interface category. Examples include all parameters
       and values need to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_vpn_ipsec_phase1_interface-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_vpn_ipsec_phase1_interface-parameters*

            Parameter              Choices/Defaults                                                                       Comments
   host                                                FortiOS or FortiGate IP address.
   string
   https                          Choices:
   boolean                        • no                 Indicates if the requests towards FortiGate must use HTTPS protocol.
                                  • yes ←
   password                     Default:               FortiOS or FortiGate password.
   string                       ""
   ssl_verify                     Choices:
   boolean                        • no                 Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                   • yes ←
   state                          Choices:             Indicates whether to create or remove the object. This attribute was present already in previous version in a deeper level. It has been moved
   string                         • present            out to this outer level.
   added in 2.9                   • absent
   username                                            FortiOS or FortiGate username.
   string
   vdom                         Default:               Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different
   string                       "root"                 unit.
   vpn_ipsec_phase1_interface   Default:               Configure VPN remote gateway.
   dictionary                   null
    acct_verify                   Choices:
    string                        • enable             Enable/disable verification of RADIUS accounting record.
                                  • disable
    add_gw_route                  Choices:
    string                        • enable             Enable/disable automatically add a route to the remote gateway.
                                  • disable
    add_route                     Choices:
    string                        • disable            Enable/disable control addition of a route to peer destination selector.
                                  • enable
    assign_ip                     Choices:
    string                        • disable            Enable/disable assignment of IP to IPsec interface via configuration method.
                                  • enable
                                  Choices:
    assign_ip_from                • range
    string                        • usrgrp             Method by which the IP address will be assigned.
                                  • dhcp
                                  • name
    authmethod                    Choices:
    string                        • psk                Authentication method.
                                  • signature
    authmethod_remote             Choices:
    string                        • psk                Authentication method (remote side).
                                  • signature
    authpasswd                                         XAuth password (max 35 characters).
    string
    authusr                                            XAuth user name.
    string
    authusrgrp                                         Authentication user group. Source user.group.name.
    string
    auto_discovery_forwarder      Choices:
    string                        • enable             Enable/disable forwarding auto-discovery short-cut messages.
                                  • disable
    auto_discovery_psk            Choices:
    string                        • enable             Enable/disable use of pre-shared secrets for authentication of auto-discovery tunnels.
                                  • disable
    auto_discovery_receiver       Choices:
    string                        • enable             Enable/disable accepting auto-discovery short-cut messages.
                                  • disable
    auto_discovery_sender         Choices:
    string                        • enable             Enable/disable sending auto-discovery short-cut messages.
                                  • disable
    auto_negotiate                Choices:
    string                        • enable             Enable/disable automatic initiation of IKE SA negotiation.
                                  • disable
    backup_gateway                                     Instruct unity clients about the backup gateway address(es).
    list
           address                                     Address of backup gateway.
           string / required
    banner                                             Message that unity client should display after connecting.
    string
    cert_id_validation            Choices:
    string                        • enable             Enable/disable cross validation of peer ID and the identity in the peer's certificate as specified in RFC 4945.
                                  • disable
    certificate                                        The names of up to 4 signed personal certificates.
    list
           name                                        Certificate name. Source vpn.certificate.local.name.
           string / required
    childless_ike                 Choices:
    string                        • enable             Enable/disable childless IKEv2 initiation (RFC 6023).
                                  • disable
    client_auto_negotiate         Choices:
    string                        • disable            Enable/disable allowing the VPN client to bring up the tunnel when there is no traffic.
                                  • enable
    client_keep_alive             Choices:
    string                        • disable            Enable/disable allowing the VPN client to keep the tunnel up when there is no traffic.
                                  • enable
    comments                                           Comment.
    string
    default_gw                                         IPv4 address of default route gateway to use for traffic exiting the interface.
    string
    default_gw_priority                                Priority for default gateway route. A higher priority number signifies a less preferred route.
    integer
                                  Choices:
                                  • 1
                                  • 2
                                  • 5
                                  • 14
                                  • 15
                                  • 16
    dhgrp                         • 17
    string                        • 18                 DH group.
                                  • 19
                                  • 20
                                  • 21
                                  • 27
                                  • 28
                                  • 29
                                  • 30
                                  • 31
    digital_signature_auth        Choices:
    string                        • enable             Enable/disable IKEv2 Digital Signature Authentication (RFC 7427).
                                  • disable
    distance                                           Distance for routes added by IKE (1 - 255).
    integer
    dns_mode                      Choices:
    string                        • manual             DNS server mode.
                                  • auto
    domain                                             Instruct unity clients about the default DNS domain.
    string
                                  Choices:
    dpd                           • disable            Dead Peer Detection mode.
    string                        • on-idle
                                  • on-demand
    dpd_retrycount                                     Number of DPD retry attempts.
    integer
    dpd_retryinterval                                  DPD retry interval.
    string
    eap                           Choices:
    string                        • enable             Enable/disable IKEv2 EAP authentication.
                                  • disable
    eap_identity                  Choices:
    string                        • use-id-payload     IKEv2 EAP peer identity type.
                                  • send-request
    encap_local_gw4                                    Local IPv4 address of GRE/VXLAN tunnel.
    string
    encap_local_gw6                                    Local IPv6 address of GRE/VXLAN tunnel.
    string
    encap_remote_gw4                                   Remote IPv4 address of GRE/VXLAN tunnel.
    string
    encap_remote_gw6                                   Remote IPv6 address of GRE/VXLAN tunnel.
    string
                                  Choices:
    encapsulation                 • none               Enable/disable GRE/VXLAN encapsulation.
    string                        • gre
                                  • vxlan
                                  Choices:
    encapsulation_address         • ike                Source for GRE/VXLAN tunnel address.
    string                        • ipv4
                                  • ipv6
                                  Choices:
    enforce_unique_id             • disable            Enable/disable peer ID uniqueness check.
    string                        • keep-new
                                  • keep-old
    exchange_interface_ip         Choices:
    string                        • enable             Enable/disable exchange of IPsec interface IP address.
                                  • disable
    exchange_ip_addr4                                  IPv4 address to exchange with peers.
    string
    exchange_ip_addr6                                  IPv6 address to exchange with peers
    string
    forticlient_enforcement       Choices:
    string                        • enable             Enable/disable FortiClient enforcement.
                                  • disable
    fragmentation                 Choices:
    string                        • enable             Enable/disable fragment IKE message on re-transmission.
                                  • disable
    fragmentation_mtu                                  IKE fragmentation MTU (500 - 16000).
    integer
    group_authentication          Choices:
    string                        • enable             Enable/disable IKEv2 IDi group authentication.
                                  • disable
    group_authentication_secret                        Password for IKEv2 IDi group authentication. (ASCII string or hexadecimal indicated by a leading 0x.)
    string
    ha_sync_esp_seqno             Choices:
    string                        • enable             Enable/disable sequence number jump ahead for IPsec HA.
                                  • disable
    idle_timeout                  Choices:
    string                        • enable             Enable/disable IPsec tunnel idle timeout.
                                  • disable
    idle_timeoutinterval                               IPsec tunnel idle timeout in minutes (5 - 43200).
    integer
    ike_version                   Choices:
    string                        • 1                  IKE protocol version.
                                  • 2
    include_local_lan             Choices:
    string                        • disable            Enable/disable allow local LAN access on unity clients.
                                  • enable
    interface                                          Local physical, aggregate, or VLAN outgoing interface. Source system.interface.name.
    string
    ip_version                    Choices:
    string                        • 4                  IP version to use for VPN interface.
                                  • 6
    ipv4_dns_server1                                   IPv4 DNS server 1.
    string
    ipv4_dns_server2                                   IPv4 DNS server 2.
    string
    ipv4_dns_server3                                   IPv4 DNS server 3.
    string
    ipv4_end_ip                                        End of IPv4 range.
    string
    ipv4_exclude_range                                 Configuration Method IPv4 exclude ranges.
    list
           end_ip                                      End of IPv4 exclusive range.
           string
           id                                          ID.
           integer / required
           start_ip                                    Start of IPv4 exclusive range.
           string
    ipv4_name                                          IPv4 address name. Source firewall.address.name firewall.addrgrp.name.
    string
    ipv4_netmask                                       IPv4 Netmask.
    string
    ipv4_split_exclude                                 IPv4 subnets that should not be sent over the IPsec tunnel. Source firewall.address.name firewall.addrgrp.name.
    string
    ipv4_split_include                                 IPv4 split-include subnets. Source firewall.address.name firewall.addrgrp.name.
    string
    ipv4_start_ip                                      Start of IPv4 range.
    string
    ipv4_wins_server1                                  WINS server 1.
    string
    ipv4_wins_server2                                  WINS server 2.
    string
    ipv6_dns_server1                                   IPv6 DNS server 1.
    string
    ipv6_dns_server2                                   IPv6 DNS server 2.
    string
    ipv6_dns_server3                                   IPv6 DNS server 3.
    string
    ipv6_end_ip                                        End of IPv6 range.
    string
    ipv6_exclude_range                                 Configuration method IPv6 exclude ranges.
    list
           end_ip                                      End of IPv6 exclusive range.
           string
           id                                          ID.
           integer / required
           start_ip                                    Start of IPv6 exclusive range.
           string
    ipv6_name                                          IPv6 address name. Source firewall.address6.name firewall.addrgrp6.name.
    string
    ipv6_prefix                                        IPv6 prefix.
    integer
    ipv6_split_exclude                                 IPv6 subnets that should not be sent over the IPsec tunnel. Source firewall.address6.name firewall.addrgrp6.name.
    string
    ipv6_split_include                                 IPv6 split-include subnets. Source firewall.address6.name firewall.addrgrp6.name.
    string
    ipv6_start_ip                                      Start of IPv6 range.
    string
    keepalive                                          NAT-T keep alive interval.
    integer
    keylife                                            Time to wait in seconds before phase 1 encryption key expires.
    integer
    local_gw                                           IPv4 address of the local gateway's external interface.
    string
    local_gw6                                          IPv6 address of the local gateway's external interface.
    string
    localid                                            Local ID.
    string
                                  Choices:
                                  • auto
    localid_type                  • fqdn
    string                        • user-fqdn          Local ID type.
                                  • keyid
                                  • address
                                  • asn1dn
                                  Choices:
    mesh_selector_type            • disable            Add selectors containing subsets of the configuration depending on traffic.
    string                        • subnet
                                  • host
    mode                          Choices:
    string                        • aggressive         The ID protection mode used to establish a secure channel.
                                  • main
    mode_cfg                      Choices:
    string                        • disable            Enable/disable configuration method.
                                  • enable
    monitor                                            IPsec interface as backup for primary interface. Source vpn.ipsec.phase1-interface.name.
    string
    monitor_hold_down_delay                            Time to wait in seconds before recovery once primary re-establishes.
    integer
    monitor_hold_down_time                             Time of day at which to fail back to primary after it re-establishes.
    string
                                  Choices:
    monitor_hold_down_type        • immediate          Recovery time method when primary interface re-establishes.
    string                        • delay
                                  • time
                                  Choices:
                                  • everyday
                                  • sunday
    monitor_hold_down_weekday     • monday
    string                        • tuesday            Day of the week to recover once primary re-establishes.
                                  • wednesday
                                  • thursday
                                  • friday
                                  • saturday
    name                                               IPsec remote gateway name.
    string / required
                                  Choices:
    nattraversal                  • enable             Enable/disable NAT traversal.
    string                        • disable
                                  • forced
    negotiate_timeout                                  IKE SA negotiation timeout in seconds (1 - 300).
    integer
    net_device                    Choices:
    string                        • enable             Enable/disable kernel device creation for dialup instances.
                                  • disable
    passive_mode                  Choices:
    string                        • enable             Enable/disable IPsec passive mode for static tunnels.
                                  • disable
    peer                                               Accept this peer certificate. Source user.peer.name.
    string
    peergrp                                            Accept this peer certificate group. Source user.peergrp.name.
    string
    peerid                                             Accept this peer identity.
    string
                                  Choices:
                                  • any
    peertype                      • one                Accept this peer type.
    string                        • dialup
                                  • peer
                                  • peergrp
                                  Choices:
    ppk                           • disable            Enable/disable IKEv2 Postquantum Preshared Key (PPK).
    string                        • allow
                                  • require
    ppk_identity                                       IKEv2 Postquantum Preshared Key Identity.
    string
    ppk_secret                                         IKEv2 Postquantum Preshared Key (ASCII string or hexadecimal encoded with a leading 0x).
    string
    priority                                           Priority for routes added by IKE (0 - 4294967295).
    integer
                                  Choices:
                                  • des-md5
    proposal                      • des-sha1           Phase1 proposal.
    string                        • des-sha256
                                  • des-sha384
                                  • des-sha512
    psksecret                                          Pre-shared secret for PSK authentication (ASCII string or hexadecimal encoded with a leading 0x).
    string
    psksecret_remote                                   Pre-shared secret for remote side PSK authentication (ASCII string or hexadecimal encoded with a leading 0x).
    string
    reauth                        Choices:
    string                        • disable            Enable/disable re-authentication upon IKE SA lifetime expiration.
                                  • enable
    rekey                         Choices:
    string                        • enable             Enable/disable phase1 rekey.
                                  • disable
    remote_gw                                          IPv4 address of the remote gateway's external interface.
    string
    remote_gw6                                         IPv6 address of the remote gateway's external interface.
    string
    remotegw_ddns                                      Domain name of remote gateway (eg. name.DDNS.com).
    string
    rsa_signature_format          Choices:
    string                        • pkcs1              Digital Signature Authentication RSA signature format.
                                  • pss
    save_password                 Choices:
    string                        • disable            Enable/disable saving XAuth username and password on VPN clients.
                                  • enable
    send_cert_chain               Choices:
    string                        • enable             Enable/disable sending certificate chain.
                                  • disable
                                  Choices:
    signature_hash_alg            • sha1
    string                        • sha2-256           Digital Signature Authentication hash algorithms.
                                  • sha2-384
                                  • sha2-512
    split_include_service                              Split-include services. Source firewall.service.group.name firewall.service.custom.name.
    string
                                                       Deprecated
                                  Choices:             Starting with Ansible 2.9 we recommend using the top-level 'state' parameter.
    state                         • present
    string                        • absent             ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                                       Indicates whether to create or remove the object.
                                  Choices:
    suite_b                       • disable            Use Suite-B.
    string                        • suite-b-gcm-128
                                  • suite-b-gcm-256
    tunnel_search                 Choices:
    string                        • selectors          Tunnel search method for when the interface is shared.
                                  • nexthop
                                  Choices:
    type                          • static             Remote gateway type.
    string                        • dynamic
                                  • ddns
    unity_support                 Choices:
    string                        • disable            Enable/disable support for Cisco UNITY Configuration Method extensions.
                                  • enable
    usrgrp                                             User group name for dialup peers. Source user.group.name.
    string
    vni                                                VNI of VXLAN tunnel.
    integer
                                  Choices:
                                  • custom
                                  • dialup-forticlient
                                  • dialup-ios
    wizard_type                   • dialup-android
    string                        • dialup-windows     GUI VPN Wizard Type.
                                  • dialup-cisco
                                  • static-fortigate
                                  • dialup-fortigate
                                  • static-cisco
                                  • dialup-cisco-fw
                                  Choices:
                                  • disable
    xauthtype                     • client             XAuth type.
    string                        • pap
                                  • chap
                                  • auto

NOTES                   *fortios_vpn_ipsec_phase1_interface-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_vpn_ipsec_phase1_interface-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Configure VPN remote gateway.
     fortios_vpn_ipsec_phase1_interface:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       state: "present"
       vpn_ipsec_phase1_interface:
         acct_verify: "enable"
         add_gw_route: "enable"
         add_route: "disable"
         assign_ip: "disable"
         assign_ip_from: "range"
         authmethod: "psk"
         authmethod_remote: "psk"
         authpasswd: "<your_own_value>"
         authusr: "<your_own_value>"
         authusrgrp: "<your_own_value> (source user.group.name)"
         auto_discovery_forwarder: "enable"
         auto_discovery_psk: "enable"
         auto_discovery_receiver: "enable"
         auto_discovery_sender: "enable"
         auto_negotiate: "enable"
         backup_gateway:
          -
             address: "<your_own_value>"
         banner: "<your_own_value>"
         cert_id_validation: "enable"
         certificate:
          -
             name: "default_name_23 (source vpn.certificate.local.name)"
         childless_ike: "enable"
         client_auto_negotiate: "disable"
         client_keep_alive: "disable"
         comments: "<your_own_value>"
         default_gw: "<your_own_value>"
         default_gw_priority: "29"
         dhgrp: "1"
         digital_signature_auth: "enable"
         distance: "32"
         dns_mode: "manual"
         domain: "<your_own_value>"
         dpd: "disable"
         dpd_retrycount: "36"
         dpd_retryinterval: "<your_own_value>"
         eap: "enable"
         eap_identity: "use-id-payload"
         encap_local_gw4: "<your_own_value>"
         encap_local_gw6: "<your_own_value>"
         encap_remote_gw4: "<your_own_value>"
         encap_remote_gw6: "<your_own_value>"
         encapsulation: "none"
         encapsulation_address: "ike"
         enforce_unique_id: "disable"
         exchange_interface_ip: "enable"
         exchange_ip_addr4: "<your_own_value>"
         exchange_ip_addr6: "<your_own_value>"
         forticlient_enforcement: "enable"
         fragmentation: "enable"
         fragmentation_mtu: "52"
         group_authentication: "enable"
         group_authentication_secret: "<your_own_value>"
         ha_sync_esp_seqno: "enable"
         idle_timeout: "enable"
         idle_timeoutinterval: "57"
         ike_version: "1"
         include_local_lan: "disable"
         interface: "<your_own_value> (source system.interface.name)"
         ip_version: "4"
         ipv4_dns_server1: "<your_own_value>"
         ipv4_dns_server2: "<your_own_value>"
         ipv4_dns_server3: "<your_own_value>"
         ipv4_end_ip: "<your_own_value>"
         ipv4_exclude_range:
          -
             end_ip: "<your_own_value>"
             id:  "68"
             start_ip: "<your_own_value>"
         ipv4_name: "<your_own_value> (source firewall.address.name firewall.addrgrp.name)"
         ipv4_netmask: "<your_own_value>"
         ipv4_split_exclude: "<your_own_value> (source firewall.address.name firewall.addrgrp.name)"
         ipv4_split_include: "<your_own_value> (source firewall.address.name firewall.addrgrp.name)"
         ipv4_start_ip: "<your_own_value>"
         ipv4_wins_server1: "<your_own_value>"
         ipv4_wins_server2: "<your_own_value>"
         ipv6_dns_server1: "<your_own_value>"
         ipv6_dns_server2: "<your_own_value>"
         ipv6_dns_server3: "<your_own_value>"
         ipv6_end_ip: "<your_own_value>"
         ipv6_exclude_range:
          -
             end_ip: "<your_own_value>"
             id:  "83"
             start_ip: "<your_own_value>"
         ipv6_name: "<your_own_value> (source firewall.address6.name firewall.addrgrp6.name)"
         ipv6_prefix: "86"
         ipv6_split_exclude: "<your_own_value> (source firewall.address6.name firewall.addrgrp6.name)"
         ipv6_split_include: "<your_own_value> (source firewall.address6.name firewall.addrgrp6.name)"
         ipv6_start_ip: "<your_own_value>"
         keepalive: "90"
         keylife: "91"
         local_gw: "<your_own_value>"
         local_gw6: "<your_own_value>"
         localid: "<your_own_value>"
         localid_type: "auto"
         mesh_selector_type: "disable"
         mode: "aggressive"
         mode_cfg: "disable"
         monitor: "<your_own_value> (source vpn.ipsec.phase1-interface.name)"
         monitor_hold_down_delay: "100"
         monitor_hold_down_time: "<your_own_value>"
         monitor_hold_down_type: "immediate"
         monitor_hold_down_weekday: "everyday"
         name: "default_name_104"
         nattraversal: "enable"
         negotiate_timeout: "106"
         net_device: "enable"
         passive_mode: "enable"
         peer: "<your_own_value> (source user.peer.name)"
         peergrp: "<your_own_value> (source user.peergrp.name)"
         peerid: "<your_own_value>"
         peertype: "any"
         ppk: "disable"
         ppk_identity: "<your_own_value>"
         ppk_secret: "<your_own_value>"
         priority: "116"
         proposal: "des-md5"
         psksecret: "<your_own_value>"
         psksecret_remote: "<your_own_value>"
         reauth: "disable"
         rekey: "enable"
         remote_gw: "<your_own_value>"
         remote_gw6: "<your_own_value>"
         remotegw_ddns: "<your_own_value>"
         rsa_signature_format: "pkcs1"
         save_password: "disable"
         send_cert_chain: "enable"
         signature_hash_alg: "sha1"
         split_include_service: "<your_own_value> (source firewall.service.group.name firewall.service.custom.name)"
         suite_b: "disable"
         tunnel_search: "selectors"
         type: "static"
         unity_support: "disable"
         usrgrp: "<your_own_value> (source user.group.name)"
         vni: "135"
         wizard_type: "custom"
         xauthtype: "disable"

RETURN VALUES                   *fortios_vpn_ipsec_phase1_interface-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_vpn_ipsec_phase1_interface-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_vpn_ipsec_phase1_interface-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_vpn_ipsec_phase1_interface_module.html

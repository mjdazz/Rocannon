SYNOPSIS                   *fortios_vpn_ssl_settings*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify vpn_ssl feature and settings category. Examples include all parameters and values
       need to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_vpn_ssl_settings-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_vpn_ssl_settings-parameters*

             Parameter           Choices/Defaults                                                                      Comments
   host                                           FortiOS or FortiGate IP address.
   string
   https                           Choices:
   boolean                         • no           Indicates if the requests towards FortiGate must use HTTPS protocol.
                                   • yes ←
   password                      Default:         FortiOS or FortiGate password.
   string                        ""
   ssl_verify                      Choices:
   boolean                         • no           Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                    • yes ←
   username                                       FortiOS or FortiGate username.
   string
   vdom                          Default:         Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different unit.
   string                        "root"
   vpn_ssl_settings              Default:         Configure SSL VPN.
   dictionary                    null
    auth_timeout                                  SSL-VPN authentication timeout (1 - 259200 sec (3 days), 0 for no timeout).
    integer
    authentication_rule                           Authentication rule for SSL VPN.
    list
                                   Choices:
                                   • any
        auth                       • local        SSL VPN authentication method restriction.
        string                     • radius
                                   • tacacs+
                                   • ldap
                                   Choices:
        cipher                     • any          SSL VPN cipher strength.
        string                     • high
                                   • medium
        client_cert                Choices:
        string                     • enable       Enable/disable SSL VPN client certificate restrictive.
                                   • disable
        groups                                    User groups.
        list
               name                               Group name. Source user.group.name.
               string / required
        id                                        ID (0 - 4294967295).
        integer / required
        portal                                    SSL VPN portal. Source vpn.ssl.web.portal.name.
        string
        realm                                     SSL VPN realm. Source vpn.ssl.web.realm.url-path.
        string
        source_address                            Source address of incoming traffic.
        list
               name                               Address name. Source firewall.address.name firewall.addrgrp.name.
               string / required
        source_address6                           IPv6 source address of incoming traffic.
        list
               name                               IPv6 address name. Source firewall.address6.name firewall.addrgrp6.name.
               string / required
        source_address6_negate     Choices:
        string                     • enable       Enable/disable negated source IPv6 address match.
                                   • disable
        source_address_negate      Choices:
        string                     • enable       Enable/disable negated source address match.
                                   • disable
        source_interface                          SSL VPN source interface of incoming traffic.
        list
               name                               Interface name. Source system.interface.name system.zone.name.
               string / required
        users                                     User name.
        list
               name                               User name. Source user.local.name.
               string / required
    auto_tunnel_static_route       Choices:
    string                         • enable       Enable to auto-create static routes for the SSL-VPN tunnel IP addresses.
                                   • disable
                                   Choices:
                                   • RSA
                                   • DH
                                   • DHE
                                   • ECDH
                                   • ECDHE
                                   • DSS
    banned_cipher                  • ECDSA        Select one or more cipher technologies that cannot be used in SSL-VPN negotiations.
    string                         • AES
                                   • AESGCM
                                   • CAMELLIA
                                   • 3DES
                                   • SHA1
                                   • SHA256
                                   • SHA384
                                   • STATIC
    check_referer                  Choices:
    string                         • enable       Enable/disable verification of referer field in HTTP request header.
                                   • disable
    default_portal                                Default SSL VPN portal. Source vpn.ssl.web.portal.name.
    string
    deflate_compression_level                     Compression level (0~9).
    integer
    deflate_min_data_size                         Minimum amount of data that triggers compression (200 - 65535 bytes).
    integer
    dns_server1                                   DNS server 1.
    string
    dns_server2                                   DNS server 2.
    string
    dns_suffix                                    DNS suffix used for SSL-VPN clients.
    string
    dtls_hello_timeout                            SSLVPN maximum DTLS hello timeout (10 - 60 sec).
    integer
    dtls_tunnel                    Choices:
    string                         • enable       Enable DTLS to prevent eavesdropping, tampering, or message forgery.
                                   • disable
    force_two_factor_auth          Choices:
    string                         • enable       Enable to force two-factor authentication for all SSL-VPNs.
                                   • disable
                                   Choices:
    header_x_forwarded_for         • pass         Forward the same, add, or remove HTTP header.
    string                         • add
                                   • remove
    http_compression               Choices:
    string                         • enable       Enable to allow HTTP compression over SSL-VPN tunnels.
                                   • disable
    http_only_cookie               Choices:
    string                         • enable       Enable/disable SSL-VPN support for HttpOnly cookies.
                                   • disable
    http_request_body_timeout                     SSL-VPN session is disconnected if an HTTP request body is not received within this time (1 - 60 sec).
    integer
    http_request_header_timeout                   SSL-VPN session is disconnected if an HTTP request header is not received within this time (1 - 60 sec).
    integer
    https_redirect                 Choices:
    string                         • enable       Enable/disable redirect of port 80 to SSL-VPN port.
                                   • disable
    idle_timeout                                  SSL VPN disconnects if idle for specified time in seconds.
    integer
    ipv6_dns_server1                              IPv6 DNS server 1.
    string
    ipv6_dns_server2                              IPv6 DNS server 2.
    string
    ipv6_wins_server1                             IPv6 WINS server 1.
    string
    ipv6_wins_server2                             IPv6 WINS server 2.
    string
    login_attempt_limit                           SSL VPN maximum login attempt times before block (0 - 10).
    integer
    login_block_time                              Time for which a user is blocked from logging in after too many failed login attempts (0 - 86400 sec).
    integer
    login_timeout                                 SSLVPN maximum login timeout (10 - 180 sec).
    integer
    port                                          SSL-VPN access port (1 - 65535).
    integer
    port_precedence                Choices:
    string                         • enable       Enable means that if SSL-VPN connections are allowed on an interface admin GUI connections are blocked on that interface.
                                   • disable
    reqclientcert                  Choices:
    string                         • enable       Enable to require client certificates for all SSL-VPN users.
                                   • disable
    route_source_interface         Choices:
    string                         • enable       Enable to allow SSL-VPN sessions to bypass routing and bind to the incoming interface.
                                   • disable
    servercert                                    Name of the server certificate to be used for SSL-VPNs. Source vpn.certificate.local.name.
    string
    source_address                                Source address of incoming traffic.
    list
        name                                      Address name. Source firewall.address.name firewall.addrgrp.name.
        string / required
    source_address6                               IPv6 source address of incoming traffic.
    list
        name                                      IPv6 address name. Source firewall.address6.name firewall.addrgrp6.name.
        string / required
    source_address6_negate         Choices:
    string                         • enable       Enable/disable negated source IPv6 address match.
                                   • disable
    source_address_negate          Choices:
    string                         • enable       Enable/disable negated source address match.
                                   • disable
    source_interface                              SSL VPN source interface of incoming traffic.
    list
        name                                      Interface name. Source system.interface.name system.zone.name.
        string / required
    ssl_client_renegotiation       Choices:
    string                         • disable      Enable to allow client renegotiation by the server if the tunnel goes down.
                                   • enable
    ssl_insert_empty_fragment      Choices:
    string                         • enable       Enable/disable insertion of empty fragment.
                                   • disable
    tlsv1_0                        Choices:
    string                         • enable       Enable/disable TLSv1.0.
                                   • disable
    tlsv1_1                        Choices:
    string                         • enable       Enable/disable TLSv1.1.
                                   • disable
    tlsv1_2                        Choices:
    string                         • enable       Enable/disable TLSv1.2.
                                   • disable
    tunnel_ip_pools                               Names of the IPv4 IP Pool firewall objects that define the IP addresses reserved for remote clients.
    list
        name                                      Address name. Source firewall.address.name firewall.addrgrp.name.
        string / required
    tunnel_ipv6_pools                             Names of the IPv6 IP Pool firewall objects that define the IP addresses reserved for remote clients.
    list
        name                                      Address name. Source firewall.address6.name firewall.addrgrp6.name.
        string / required
    unsafe_legacy_renegotiation    Choices:
    string                         • enable       Enable/disable unsafe legacy re-negotiation.
                                   • disable
    url_obscuration                Choices:
    string                         • enable       Enable to obscure the host name of the URL of the web browser display.
                                   • disable
    wins_server1                                  WINS server 1.
    string
    wins_server2                                  WINS server 2.
    string
    x_content_type_options         Choices:
    string                         • enable       Add HTTP X-Content-Type-Options header.
                                   • disable

NOTES                   *fortios_vpn_ssl_settings-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_vpn_ssl_settings-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Configure SSL VPN.
     fortios_vpn_ssl_settings:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       vpn_ssl_settings:
         auth_timeout: "3"
         authentication_rule:
          -
             auth: "any"
             cipher: "any"
             client_cert: "enable"
             groups:
              -
                 name: "default_name_9 (source user.group.name)"
             id:  "10"
             portal: "<your_own_value> (source vpn.ssl.web.portal.name)"
             realm: "<your_own_value> (source vpn.ssl.web.realm.url-path)"
             source_address:
              -
                 name: "default_name_14 (source firewall.address.name firewall.addrgrp.name)"
             source_address_negate: "enable"
             source_address6:
              -
                 name: "default_name_17 (source firewall.address6.name firewall.addrgrp6.name)"
             source_address6_negate: "enable"
             source_interface:
              -
                 name: "default_name_20 (source system.interface.name system.zone.name)"
             users:
              -
                 name: "default_name_22 (source user.local.name)"
         auto_tunnel_static_route: "enable"
         banned_cipher: "RSA"
         check_referer: "enable"
         default_portal: "<your_own_value> (source vpn.ssl.web.portal.name)"
         deflate_compression_level: "27"
         deflate_min_data_size: "28"
         dns_server1: "<your_own_value>"
         dns_server2: "<your_own_value>"
         dns_suffix: "<your_own_value>"
         dtls_hello_timeout: "32"
         dtls_tunnel: "enable"
         force_two_factor_auth: "enable"
         header_x_forwarded_for: "pass"
         http_compression: "enable"
         http_only_cookie: "enable"
         http_request_body_timeout: "38"
         http_request_header_timeout: "39"
         https_redirect: "enable"
         idle_timeout: "41"
         ipv6_dns_server1: "<your_own_value>"
         ipv6_dns_server2: "<your_own_value>"
         ipv6_wins_server1: "<your_own_value>"
         ipv6_wins_server2: "<your_own_value>"
         login_attempt_limit: "46"
         login_block_time: "47"
         login_timeout: "48"
         port: "49"
         port_precedence: "enable"
         reqclientcert: "enable"
         route_source_interface: "enable"
         servercert: "<your_own_value> (source vpn.certificate.local.name)"
         source_address:
          -
             name: "default_name_55 (source firewall.address.name firewall.addrgrp.name)"
         source_address_negate: "enable"
         source_address6:
          -
             name: "default_name_58 (source firewall.address6.name firewall.addrgrp6.name)"
         source_address6_negate: "enable"
         source_interface:
          -
             name: "default_name_61 (source system.interface.name system.zone.name)"
         ssl_client_renegotiation: "disable"
         ssl_insert_empty_fragment: "enable"
         tlsv1_0: "enable"
         tlsv1_1: "enable"
         tlsv1_2: "enable"
         tunnel_ip_pools:
          -
             name: "default_name_68 (source firewall.address.name firewall.addrgrp.name)"
         tunnel_ipv6_pools:
          -
             name: "default_name_70 (source firewall.address6.name firewall.addrgrp6.name)"
         unsafe_legacy_renegotiation: "enable"
         url_obscuration: "enable"
         wins_server1: "<your_own_value>"
         wins_server2: "<your_own_value>"
         x_content_type_options: "enable"

RETURN VALUES                   *fortios_vpn_ssl_settings-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_vpn_ssl_settings-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_vpn_ssl_settings-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_vpn_ssl_settings_module.html

SYNOPSIS                   *vmware_host_datastore*

     • This module can be used to mount/umount datastore on ESXi host.
     • This module only supports NFS (NFS v3 or NFS v4.1) and VMFS datastores.
     • For VMFS datastore, available device must already be connected on ESXi host.
     • All parameters and VMware object names are case sensitive.

REQUIREMENTS                   *vmware_host_datastore-requirements*

   The below requirements are needed on the host that executes this module.

     • python >= 2.6
     • PyVmomi

PARAMETERS                   *vmware_host_datastore-parameters*

       Parameter     Choices/Defaults                                                                            Comments
   datacenter_name                    Name of the datacenter to add the datastore.
   string                             The datacenter isn't used by the API to create a datastore.
                                      Will be removed in 2.11.
   datastore_name                     Name of the datastore to add/remove.
   string / required
                       Choices:
   datastore_type      • nfs          Type of the datastore to configure (nfs/nfs41/vmfs).
   string / required   • nfs41
                       • vmfs
   esxi_hostname                      ESXi hostname to manage the datastore.
   string                             Required when used with a vcenter
   hostname                           The hostname or IP address of the vSphere vCenter or ESXi server.
   string                             If the value is not specified in the task, the value of environment variable VMWARE_HOST will be used instead.
                                      Environment variable support added in Ansible 2.6.
   nfs_path                           Resource path on NFS host.
   string                             Required if datastore type is set to nfs/nfs41 and state is set to present, else unused.
   nfs_ro              Choices:       ReadOnly or ReadWrite mount.
   boolean             • no ←         Unused if datastore type is not set to nfs/nfs41 and state is not set to present.
                       • yes
   nfs_server                         NFS host serving nfs datastore.
   string                             Required if datastore type is set to nfs/nfs41 and state is set to present, else unused.
                                      Two or more servers can be defined if datastore type is set to nfs41
                                      The password of the vSphere vCenter or ESXi server.
   password                           If the value is not specified in the task, the value of environment variable VMWARE_PASSWORD will be used instead.
   string                             Environment variable support added in Ansible 2.6.
                                      aliases: pass, pwd
   port              Default:         The port number of the vSphere vCenter or ESXi server.
   integer           443              If the value is not specified in the task, the value of environment variable VMWARE_PORT will be used instead.
   added in 2.5                       Environment variable support added in Ansible 2.6.
   proxy_host                         Address of a proxy that will receive all HTTPS requests and relay them.
   string                             The format is a hostname or a IP.
   added in 2.9                       If the value is not specified in the task, the value of environment variable VMWARE_PROXY_HOST will be used instead.
                                      This feature depends on a version of pyvmomi greater than v6.7.1.2018.12
   proxy_port                         Port of the HTTP proxy that will receive all HTTPS requests and relay them.
   integer                            If the value is not specified in the task, the value of environment variable VMWARE_PROXY_PORT will be used instead.
   added in 2.9
   state               Choices:       present: Mount datastore on host if datastore is absent else do nothing.
   string              • present ←    absent: Umount datastore if datastore is present else do nothing.
                       • absent
                                      The username of the vSphere vCenter or ESXi server.
   username                           If the value is not specified in the task, the value of environment variable VMWARE_USER will be used instead.
   string                             Environment variable support added in Ansible 2.6.
                                      aliases: admin, user
                       Choices:       Allows connection when SSL certificates are not valid. Set to false when certificates are not trusted.
   validate_certs      • no           If the value is not specified in the task, the value of environment variable VMWARE_VALIDATE_CERTS will be used instead.
   boolean             • yes ←        Environment variable support added in Ansible 2.6.
                                      If set to yes, please make sure Python >= 2.7.9 is installed on the given machine.
   vmfs_device_name                   Name of the device to be used as VMFS datastore.
   string                             Required for VMFS datastore type and state is set to present, else unused.
   vmfs_version                       VMFS version to use for datastore creation.
   integer                            Unused if datastore type is not set to vmfs and state is not set to present.

NOTES                   *vmware_host_datastore-notes*

   Note

     • Tested on vSphere 6.0, 6.5 and ESXi 6.7
     • NFS v4.1 tested on vSphere 6.5
     • Kerberos authentication with NFS v4.1 isn’t implemented

EXAMPLES                   *vmware_host_datastore-examples*

 - name: Mount VMFS datastores to ESXi
   vmware_host_datastore:
       hostname: '{{ vcenter_hostname }}'
       username: '{{ vcenter_username }}'
       password: '{{ vcenter_password }}'
       datastore_name: '{{ item.name }}'
       datastore_type: '{{ item.type }}'
       vmfs_device_name: 'naa.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
       vmfs_version: 6
       esxi_hostname: '{{ inventory_hostname }}'
       state: present
   delegate_to: localhost

 - name: Mount NFS datastores to ESXi
   vmware_host_datastore:
       hostname: '{{ vcenter_hostname }}'
       username: '{{ vcenter_username }}'
       password: '{{ vcenter_password }}'
       datastore_name: '{{ item.name }}'
       datastore_type: '{{ item.type }}'
       nfs_server: '{{ item.server }}'
       nfs_path: '{{ item.path }}'
       nfs_ro: no
       esxi_hostname: '{{ inventory_hostname }}'
       state: present
   delegate_to: localhost
   loop:
       - { 'name': 'NasDS_vol01', 'server': 'nas01', 'path': '/mnt/vol01', 'type': 'nfs'}
       - { 'name': 'NasDS_vol02', 'server': 'nas01', 'path': '/mnt/vol02', 'type': 'nfs'}

 - name: Mount NFS v4.1 datastores to ESXi
   vmware_host_datastore:
       hostname: '{{ vcenter_hostname }}'
       username: '{{ vcenter_username }}'
       password: '{{ vcenter_password }}'
       datastore_name: '{{ item.name }}'
       datastore_type: '{{ item.type }}'
       nfs_server: '{{ item.server }}'
       nfs_path: '{{ item.path }}'
       nfs_ro: no
       esxi_hostname: '{{ inventory_hostname }}'
       state: present
   delegate_to: localhost
   loop:
       - { 'name': 'NasDS_vol03', 'server': 'nas01,nas02', 'path': '/mnt/vol01', 'type': 'nfs41'}
       - { 'name': 'NasDS_vol04', 'server': 'nas01,nas02', 'path': '/mnt/vol02', 'type': 'nfs41'}

 - name: Remove/Umount Datastores from a ESXi
   vmware_host_datastore:
       hostname: '{{ esxi_hostname }}'
       username: '{{ esxi_username }}'
       password: '{{ esxi_password }}'
       datastore_name: NasDS_vol01
       state: absent
   delegate_to: localhost

STATUS                   *vmware_host_datastore-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Ludovic Rivallain (@lrivallain) <ludovic.rivallain@gmail.com>
     • Christian Kotte (@ckotte) <christian.kotte@gmx.de>

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *vmware_host_datastore-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/vmware_host_datastore_module.html

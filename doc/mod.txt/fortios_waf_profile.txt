SYNOPSIS                   *fortios_waf_profile*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify waf feature and profile category. Examples include all parameters and values need
       to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_waf_profile-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_waf_profile-parameters*

               Parameter              Choices/Defaults                                                                     Comments
   host                                                  FortiOS or FortiGate IP address.
   string
   https                               Choices:
   boolean                             • no              Indicates if the requests towards FortiGate must use HTTPS protocol.
                                       • yes ←
   password                          Default:            FortiOS or FortiGate password.
   string                            ""
   ssl_verify                          Choices:
   boolean                             • no              Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                        • yes ←
   state                               Choices:          Indicates whether to create or remove the object. This attribute was present already in previous version in a deeper level. It has been
   string                              • present         moved out to this outer level.
   added in 2.9                        • absent
   username                                              FortiOS or FortiGate username.
   string
   vdom                              Default:            Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different
   string                            "root"              unit.
   waf_profile                       Default:            Web application firewall configuration.
   dictionary                        null
    address_list                                         Black address list and white address list.
    dictionary
     blocked_address                                     Blocked address.
     list
             name                                        Address name. Source firewall.address.name firewall.addrgrp.name.
             string / required
     blocked_log                       Choices:
     string                            • enable          Enable/disable logging on blocked addresses.
                                       • disable
                                       Choices:
     severity                          • high            Severity.
     string                            • medium
                                       • low
     status                            Choices:
     string                            • enable          Status.
                                       • disable
     trusted_address                                     Trusted address.
     list
             name                                        Address name. Source firewall.address.name firewall.addrgrp.name.
             string / required
    comment                                              Comment.
    string
    constraint                                           WAF HTTP protocol restrictions.
    dictionary
     content_length                                      HTTP content length in request.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             length                                      Length of HTTP content in bytes (0 to 2147483647).
             integer
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     exception                                           HTTP constraint exception.
     list
             address                                     Host address. Source firewall.address.name firewall.addrgrp.name.
             string
             content_length            Choices:
             string                    • enable          HTTP content length in request.
                                       • disable
             header_length             Choices:
             string                    • enable          HTTP header length in request.
                                       • disable
             hostname                  Choices:
             string                    • enable          Enable/disable hostname check.
                                       • disable
             id                                          Exception ID.
             integer / required
             line_length               Choices:
             string                    • enable          HTTP line length in request.
                                       • disable
             malformed                 Choices:
             string                    • enable          Enable/disable malformed HTTP request check.
                                       • disable
             max_cookie                Choices:
             string                    • enable          Maximum number of cookies in HTTP request.
                                       • disable
             max_header_line           Choices:
             string                    • enable          Maximum number of HTTP header line.
                                       • disable
             max_range_segment         Choices:
             string                    • enable          Maximum number of range segments in HTTP range line.
                                       • disable
             max_url_param             Choices:
             string                    • enable          Maximum number of parameters in URL.
                                       • disable
             method                    Choices:
             string                    • enable          Enable/disable HTTP method check.
                                       • disable
             param_length              Choices:
             string                    • enable          Maximum length of parameter in URL, HTTP POST request or HTTP body.
                                       • disable
             pattern                                     URL pattern.
             string
             regex                     Choices:
             string                    • enable          Enable/disable regular expression based pattern match.
                                       • disable
             url_param_length          Choices:
             string                    • enable          Maximum length of parameter in URL.
                                       • disable
             version                   Choices:
             string                    • enable          Enable/disable HTTP version check.
                                       • disable
     header_length                                       HTTP header length in request.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             length                                      Length of HTTP header in bytes (0 to 2147483647).
             integer
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     hostname                                            Enable/disable hostname check.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     line_length                                         HTTP line length in request.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             length                                      Length of HTTP line in bytes (0 to 2147483647).
             integer
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     malformed                                           Enable/disable malformed HTTP request check.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     max_cookie                                          Maximum number of cookies in HTTP request.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
             max_cookie                                  Maximum number of cookies in HTTP request (0 to 2147483647).
             integer
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     max_header_line                                     Maximum number of HTTP header line.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
             max_header_line                             Maximum number HTTP header lines (0 to 2147483647).
             integer
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     max_range_segment                                   Maximum number of range segments in HTTP range line.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
             max_range_segment                           Maximum number of range segments in HTTP range line (0 to 2147483647).
             integer
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     max_url_param                                       Maximum number of parameters in URL.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
             max_url_param                               Maximum number of parameters in URL (0 to 2147483647).
             integer
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     method                                              Enable/disable HTTP method check.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     param_length                                        Maximum length of parameter in URL, HTTP POST request or HTTP body.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             length                                      Maximum length of parameter in URL, HTTP POST request or HTTP body in bytes (0 to 2147483647).
             integer
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     url_param_length                                    Maximum length of parameter in URL.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             length                                      Maximum length of URL parameter in bytes (0 to 2147483647).
             integer
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
     version                                             Enable/disable HTTP version check.
     dictionary
             action                    Choices:
             string                    • allow           Action.
                                       • block
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Enable/disable the constraint.
                                       • disable
    extended_log                       Choices:
    string                             • enable          Enable/disable extended logging.
                                       • disable
    external                           Choices:
    string                             • disable         Disable/Enable external HTTP Inspection.
                                       • enable
    method                                               Method restriction.
    dictionary
                                       Choices:
                                       • get
                                       • post
                                       • put
     default_allowed_methods           • head            Methods.
     string                            • connect
                                       • trace
                                       • options
                                       • delete
                                       • others
     log                               Choices:
     string                            • enable          Enable/disable logging.
                                       • disable
     method_policy                                       HTTP method policy.
     list
             address                                     Host address. Source firewall.address.name firewall.addrgrp.name.
             string
                                       Choices:
                                       • get
                                       • post
                                       • put
             allowed_methods           • head            Allowed Methods.
             string                    • connect
                                       • trace
                                       • options
                                       • delete
                                       • others
             id                                          HTTP method policy ID.
             integer / required
             pattern                                     URL pattern.
             string
             regex                     Choices:
             string                    • enable          Enable/disable regular expression based pattern match.
                                       • disable
                                       Choices:
     severity                          • high            Severity.
     string                            • medium
                                       • low
     status                            Choices:
     string                            • enable          Status.
                                       • disable
    name                                                 WAF Profile name.
    string / required
    signature                                            WAF signatures.
    dictionary
     credit_card_detection_threshold                     The minimum number of Credit cards to detect violation.
     integer
     custom_signature                                    Custom signature.
     list
                                       Choices:
             action                    • allow           Action.
             string                    • block
                                       • erase
             case_sensitivity          Choices:
             string                    • disable         Case sensitivity in pattern.
                                       • enable
             direction                 Choices:
             string                    • request         Traffic direction.
                                       • response
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
             name                                        Signature name.
             string / required
             pattern                                     Match pattern.
             string
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Status.
                                       • disable
                                       Choices:
                                       • arg
                                       • arg-name
                                       • req-body
                                       • req-cookie
                                       • req-cookie-name
             target                    • req-filename    Match HTTP target.
             string                    • req-header
                                       • req-header-name
                                       • req-raw-uri
                                       • req-uri
                                       • resp-body
                                       • resp-hdr
                                       • resp-status
     disabled_signature                                  Disabled signatures
     list
             id                                          Signature ID. Source waf.signature.id.
             integer / required
     disabled_sub_class                                  Disabled signature subclasses.
     list
             id                                          Signature subclass ID. Source waf.sub-class.id.
             integer / required
     main_class                                          Main signature class.
     list
                                       Choices:
             action                    • allow           Action.
             string                    • block
                                       • erase
             id                                          Main signature class ID. Source waf.main-class.id.
             integer / required
             log                       Choices:
             string                    • enable          Enable/disable logging.
                                       • disable
                                       Choices:
             severity                  • high            Severity.
             string                    • medium
                                       • low
             status                    Choices:
             string                    • enable          Status.
                                       • disable
                                                         Deprecated
                                       Choices:          Starting with Ansible 2.9 we recommend using the top-level 'state' parameter.
    state                              • present
    string                             • absent          ════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                                         Indicates whether to create or remove the object.
    url_access                                           URL access list
    list
     access_pattern                                      URL access pattern.
     list
             id                                          URL access pattern ID.
             integer / required
             negate                    Choices:
             string                    • enable          Enable/disable match negation.
                                       • disable
             pattern                                     URL pattern.
             string
             regex                     Choices:
             string                    • enable          Enable/disable regular expression based pattern match.
                                       • disable
             srcaddr                                     Source address. Source firewall.address.name firewall.addrgrp.name.
             string
                                       Choices:
     action                            • bypass          Action.
     string                            • permit
                                       • block
     address                                             Host address. Source firewall.address.name firewall.addrgrp.name.
     string
     id                                                  URL access ID.
     integer / required
     log                               Choices:
     string                            • enable          Enable/disable logging.
                                       • disable
                                       Choices:
     severity                          • high            Severity.
     string                            • medium
                                       • low

NOTES                   *fortios_waf_profile-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_waf_profile-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Web application firewall configuration.
     fortios_waf_profile:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       state: "present"
       waf_profile:
         address_list:
             blocked_address:
              -
                 name: "default_name_5 (source firewall.address.name firewall.addrgrp.name)"
             blocked_log: "enable"
             severity: "high"
             status: "enable"
             trusted_address:
              -
                 name: "default_name_10 (source firewall.address.name firewall.addrgrp.name)"
         comment: "Comment."
         constraint:
             content_length:
                 action: "allow"
                 length: "15"
                 log: "enable"
                 severity: "high"
                 status: "enable"
             exception:
              -
                 address: "<your_own_value> (source firewall.address.name firewall.addrgrp.name)"
                 content_length: "enable"
                 header_length: "enable"
                 hostname: "enable"
                 id:  "24"
                 line_length: "enable"
                 malformed: "enable"
                 max_cookie: "enable"
                 max_header_line: "enable"
                 max_range_segment: "enable"
                 max_url_param: "enable"
                 method: "enable"
                 param_length: "enable"
                 pattern: "<your_own_value>"
                 regex: "enable"
                 url_param_length: "enable"
                 version: "enable"
             header_length:
                 action: "allow"
                 length: "39"
                 log: "enable"
                 severity: "high"
                 status: "enable"
             hostname:
                 action: "allow"
                 log: "enable"
                 severity: "high"
                 status: "enable"
             line_length:
                 action: "allow"
                 length: "50"
                 log: "enable"
                 severity: "high"
                 status: "enable"
             malformed:
                 action: "allow"
                 log: "enable"
                 severity: "high"
                 status: "enable"
             max_cookie:
                 action: "allow"
                 log: "enable"
                 max_cookie: "62"
                 severity: "high"
                 status: "enable"
             max_header_line:
                 action: "allow"
                 log: "enable"
                 max_header_line: "68"
                 severity: "high"
                 status: "enable"
             max_range_segment:
                 action: "allow"
                 log: "enable"
                 max_range_segment: "74"
                 severity: "high"
                 status: "enable"
             max_url_param:
                 action: "allow"
                 log: "enable"
                 max_url_param: "80"
                 severity: "high"
                 status: "enable"
             method:
                 action: "allow"
                 log: "enable"
                 severity: "high"
                 status: "enable"
             param_length:
                 action: "allow"
                 length: "90"
                 log: "enable"
                 severity: "high"
                 status: "enable"
             url_param_length:
                 action: "allow"
                 length: "96"
                 log: "enable"
                 severity: "high"
                 status: "enable"
             version:
                 action: "allow"
                 log: "enable"
                 severity: "high"
                 status: "enable"
         extended_log: "enable"
         external: "disable"
         method:
             default_allowed_methods: "get"
             log: "enable"
             method_policy:
              -
                 address: "<your_own_value> (source firewall.address.name firewall.addrgrp.name)"
                 allowed_methods: "get"
                 id:  "113"
                 pattern: "<your_own_value>"
                 regex: "enable"
             severity: "high"
             status: "enable"
         name: "default_name_118"
         signature:
             credit_card_detection_threshold: "120"
             custom_signature:
              -
                 action: "allow"
                 case_sensitivity: "disable"
                 direction: "request"
                 log: "enable"
                 name: "default_name_126"
                 pattern: "<your_own_value>"
                 severity: "high"
                 status: "enable"
                 target: "arg"
             disabled_signature:
              -
                 id:  "132 (source waf.signature.id)"
             disabled_sub_class:
              -
                 id:  "134 (source waf.sub-class.id)"
             main_class:
              -
                 action: "allow"
                 id:  "137 (source waf.main-class.id)"
                 log: "enable"
                 severity: "high"
                 status: "enable"
         url_access:
          -
             access_pattern:
              -
                 id:  "143"
                 negate: "enable"
                 pattern: "<your_own_value>"
                 regex: "enable"
                 srcaddr: "<your_own_value> (source firewall.address.name firewall.addrgrp.name)"
             action: "bypass"
             address: "<your_own_value> (source firewall.address.name firewall.addrgrp.name)"
             id:  "150"
             log: "enable"
             severity: "high"

RETURN VALUES                   *fortios_waf_profile-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_waf_profile-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_waf_profile-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_waf_profile_module.html

SYNOPSIS                   *fortios_endpoint_control_profile*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify endpoint_control feature and profile category. Examples include all parameters and
       values need to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_endpoint_control_profile-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_endpoint_control_profile-parameters*

                      Parameter                       Choices/Defaults                                                             Comments
   endpoint_control_profile                         Default:             Configure FortiClient endpoint control profiles.
   dictionary                                       null
    description                                                          Description.
    string
    device_groups                                                        Device groups.
    list
     name                                                                Device group object from available options. Source user.device-group.name user.device-category.name.
     string / required
    forticlient_android_settings                                         FortiClient settings for Android platform.
    dictionary
     disable_wf_when_protected                        Choices:
     string                                           • enable           Enable/disable FortiClient web category filtering when protected by FortiGate.
                                                      • disable
     forticlient_advanced_vpn                         Choices:
     string                                           • enable           Enable/disable advanced FortiClient VPN configuration.
                                                      • disable
     forticlient_advanced_vpn_buffer                                     Advanced FortiClient VPN configuration.
     string
     forticlient_vpn_provisioning                     Choices:
     string                                           • enable           Enable/disable FortiClient VPN provisioning.
                                                      • disable
     forticlient_vpn_settings                                            FortiClient VPN settings.
     list
                 auth_method                          Choices:
                 string                               • psk              Authentication method.
                                                      • certificate
                 name                                                    VPN name.
                 string / required
                 preshared_key                                           Pre-shared secret for PSK authentication.
                 string
                 remote_gw                                               IP address or FQDN of the remote VPN gateway.
                 string
                 sslvpn_access_port                                      SSL VPN access port (1 - 65535).
                 integer
                 sslvpn_require_certificate           Choices:
                 string                               • enable           Enable/disable requiring SSL VPN client certificate.
                                                      • disable
                 type                                 Choices:
                 string                               • ipsec            VPN type (IPsec or SSL VPN).
                                                      • ssl
     forticlient_wf                                   Choices:
     string                                           • enable           Enable/disable FortiClient web filtering.
                                                      • disable
     forticlient_wf_profile                                              The FortiClient web filter profile to apply. Source webfilter.profile.name.
     string
    forticlient_ios_settings                                             FortiClient settings for iOS platform.
    dictionary
     client_vpn_provisioning                          Choices:
     string                                           • enable           FortiClient VPN provisioning.
                                                      • disable
     client_vpn_settings                                                 FortiClient VPN settings.
     list
                 auth_method                          Choices:
                 string                               • psk              Authentication method.
                                                      • certificate
                 name                                                    VPN name.
                 string / required
                 preshared_key                                           Pre-shared secret for PSK authentication.
                 string
                 remote_gw                                               IP address or FQDN of the remote VPN gateway.
                 string
                 sslvpn_access_port                                      SSL VPN access port (1 - 65535).
                 integer
                 sslvpn_require_certificate           Choices:
                 string                               • enable           Enable/disable requiring SSL VPN client certificate.
                                                      • disable
                 type                                 Choices:
                 string                               • ipsec            VPN type (IPsec or SSL VPN).
                                                      • ssl
                 vpn_configuration_content                               Content of VPN configuration.
                 string
                 vpn_configuration_name                                  Name of VPN configuration.
                 string
     configuration_content                                               Content of configuration profile.
     string
     configuration_name                                                  Name of configuration profile.
     string
     disable_wf_when_protected                        Choices:
     string                                           • enable           Enable/disable FortiClient web category filtering when protected by FortiGate.
                                                      • disable
     distribute_configuration_profile                 Choices:
     string                                           • enable           Enable/disable configuration profile (.mobileconfig file) distribution.
                                                      • disable
     forticlient_wf                                   Choices:
     string                                           • enable           Enable/disable FortiClient web filtering.
                                                      • disable
     forticlient_wf_profile                                              The FortiClient web filter profile to apply. Source webfilter.profile.name.
     string
    forticlient_winmac_settings                                          FortiClient settings for Windows/Mac platform.
    dictionary
     av_realtime_protection                           Choices:
     string                                           • enable           Enable/disable FortiClient AntiVirus real-time protection.
                                                      • disable
     av_signature_up_to_date                          Choices:
     string                                           • enable           Enable/disable FortiClient AV signature updates.
                                                      • disable
     forticlient_application_firewall                 Choices:
     string                                           • enable           Enable/disable the FortiClient application firewall.
                                                      • disable
     forticlient_application_firewall_list                               FortiClient application firewall rule list. Source application.list.name.
     string
     forticlient_av                                   Choices:
     string                                           • enable           Enable/disable FortiClient AntiVirus scanning.
                                                      • disable
     forticlient_ems_compliance                       Choices:
     string                                           • enable           Enable/disable FortiClient Enterprise Management Server (EMS) compliance.
                                                      • disable
     forticlient_ems_compliance_action                Choices:
     string                                           • block            FortiClient EMS compliance action.
                                                      • warning
     forticlient_ems_entries                                             FortiClient EMS entries.
     list
                 name                                                    FortiClient EMS name. Source endpoint-control.forticlient-ems.name.
                 string / required
     forticlient_linux_ver                                               Minimum FortiClient Linux version.
     string
     forticlient_log_upload                           Choices:
     string                                           • enable           Enable/disable uploading FortiClient logs.
                                                      • disable
                                                      Choices:
     forticlient_log_upload_level                     • traffic          Select the FortiClient logs to upload.
     string                                           • vulnerability
                                                      • event
     forticlient_log_upload_server                                       IP address or FQDN of the server to which to upload FortiClient logs.
     string
     forticlient_mac_ver                                                 Minimum FortiClient Mac OS version.
     string
     forticlient_minimum_software_version             Choices:
     string                                           • enable           Enable/disable requiring clients to run FortiClient with a minimum software version number.
                                                      • disable
     forticlient_operating_system                                        FortiClient operating system.
     list
                 id                                                      Operating system entry ID.
                 integer / required
                 os_name                                                 Customize operating system name or Mac OS format:x.x.x
                 string
                                                      Choices:
                                                      • custom
                                                      • mac-os
                                                      • win-7
                                                      • win-80
                                                      • win-81
                                                      • win-10
                                                      • win-2000
                                                      • win-home-svr
                                                      • win-svr-10
                 os_type                              • win-svr-2003
                 string                               • win-svr-2003-r2  Operating system type.
                                                      • win-svr-2008
                                                      • win-svr-2008-r2
                                                      • win-svr-2012
                                                      • win-svr-2012-r2
                                                      • win-sto-svr-2003
                                                      • win-vista
                                                      • win-xp
                                                      • ubuntu-linux
                                                      • centos-linux
                                                      • redhat-linux
                                                      • fedora-linux
     forticlient_own_file                                                Checking the path and filename of the FortiClient application.
     list
                 file                                                    File path and name.
                 string
                 id                                                      File ID.
                 integer / required
     forticlient_registration_compliance_action       Choices:
     string                                           • block            FortiClient registration compliance action.
                                                      • warning
     forticlient_registry_entry                                          FortiClient registry entry.
     list
                 id                                                      Registry entry ID.
                 integer / required
                 registry_entry                                          Registry entry.
                 string
     forticlient_running_app                                             Use FortiClient to verify if the listed applications are running on the client.
     list
                 app_name                                                Application name.
                 string
                 app_sha256_signature                                    App's SHA256 signature.
                 string
                 app_sha256_signature2                                   App's SHA256 Signature.
                 string
                 app_sha256_signature3                                   App's SHA256 Signature.
                 string
                 app_sha256_signature4                                   App's SHA256 Signature.
                 string
                 application_check_rule               Choices:
                 string                               • present          Application check rule.
                                                      • absent
                 id                                                      Application ID.
                 integer / required
                 process_name                                            Process name.
                 string
                 process_name2                                           Process name.
                 string
                 process_name3                                           Process name.
                 string
                 process_name4                                           Process name.
                 string
     forticlient_security_posture                     Choices:
     string                                           • enable           Enable/disable FortiClient security posture check options.
                                                      • disable
     forticlient_security_posture_compliance_action   Choices:
     string                                           • block            FortiClient security posture compliance action.
                                                      • warning
     forticlient_system_compliance                    Choices:
     string                                           • enable           Enable/disable enforcement of FortiClient system compliance.
                                                      • disable
     forticlient_system_compliance_action             Choices:
     string                                           • block            Block or warn clients not compliant with FortiClient requirements.
                                                      • warning
     forticlient_vuln_scan                            Choices:
     string                                           • enable           Enable/disable FortiClient vulnerability scanning.
                                                      • disable
     forticlient_vuln_scan_compliance_action          Choices:
     string                                           • block            FortiClient vulnerability compliance action.
                                                      • warning
                                                      Choices:
                                                      • critical
     forticlient_vuln_scan_enforce                    • high             Configure the level of the vulnerability found that causes a FortiClient vulnerability compliance action.
     string                                           • medium
                                                      • low
                                                      • info
     forticlient_vuln_scan_enforce_grace                                 FortiClient vulnerability scan enforcement grace period (0 - 30 days).
     integer
     forticlient_vuln_scan_exempt                     Choices:
     string                                           • enable           Enable/disable compliance exemption for vulnerabilities that cannot be patched automatically.
                                                      • disable
     forticlient_wf                                   Choices:
     string                                           • enable           Enable/disable FortiClient web filtering.
                                                      • disable
     forticlient_wf_profile                                              The FortiClient web filter profile to apply. Source webfilter.profile.name.
     string
     forticlient_win_ver                                                 Minimum FortiClient Windows version.
     string
     os_av_software_installed                         Choices:
     string                                           • enable           Enable/disable checking for OS recognized AntiVirus software.
                                                      • disable
     sandbox_address                                                     FortiSandbox address.
     string
     sandbox_analysis                                 Choices:
     string                                           • enable           Enable/disable sending files to FortiSandbox for analysis.
                                                      • disable
    on_net_addr                                                          Addresses for on-net detection.
    list
     name                                                                Address object from available options. Source firewall.address.name firewall.addrgrp.name.
     string / required
    profile_name                                                         Profile name.
    string
    replacemsg_override_group                                            Select an endpoint control replacement message override group from available options. Source system.replacemsg-group.name.
    string
    src_addr                                                             Source addresses.
    list
     name                                                                Address object from available options. Source firewall.address.name firewall.addrgrp.name.
     string / required
                                                                         Deprecated
                                                      Choices:           Starting with Ansible 2.9 we recommend using the top-level 'state' parameter.
    state                                             • present
    string                                            • absent           ════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                                                         Indicates whether to create or remove the object.
    user_groups                                                          User groups.
    list
     name                                                                User group name. Source user.group.name.
     string / required
    users                                                                Users.
    list
     name                                                                User name. Source user.local.name.
     string / required
   host                                                                  FortiOS or FortiGate IP address.
   string
   https                                              Choices:
   boolean                                            • no               Indicates if the requests towards FortiGate must use HTTPS protocol.
                                                      • yes ←
   password                                         Default:             FortiOS or FortiGate password.
   string                                           ""
   ssl_verify                                         Choices:
   boolean                                            • no               Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                                       • yes ←
   state                                              Choices:           Indicates whether to create or remove the object. This attribute was present already in previous version in a deeper level.
   string                                             • present          It has been moved out to this outer level.
   added in 2.9                                       • absent
   username                                                              FortiOS or FortiGate username.
   string
   vdom                                             Default:             Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and
   string                                           "root"               used as a different unit.

NOTES                   *fortios_endpoint_control_profile-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_endpoint_control_profile-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Configure FortiClient endpoint control profiles.
     fortios_endpoint_control_profile:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       state: "present"
       endpoint_control_profile:
         description: "<your_own_value>"
         device_groups:
          -
             name: "default_name_5 (source user.device-group.name user.device-category.name)"
         forticlient_android_settings:
             disable_wf_when_protected: "enable"
             forticlient_advanced_vpn: "enable"
             forticlient_advanced_vpn_buffer: "<your_own_value>"
             forticlient_vpn_provisioning: "enable"
             forticlient_vpn_settings:
              -
                 auth_method: "psk"
                 name: "default_name_13"
                 preshared_key: "<your_own_value>"
                 remote_gw: "<your_own_value>"
                 sslvpn_access_port: "16"
                 sslvpn_require_certificate: "enable"
                 type: "ipsec"
             forticlient_wf: "enable"
             forticlient_wf_profile: "<your_own_value> (source webfilter.profile.name)"
         forticlient_ios_settings:
             client_vpn_provisioning: "enable"
             client_vpn_settings:
              -
                 auth_method: "psk"
                 name: "default_name_25"
                 preshared_key: "<your_own_value>"
                 remote_gw: "<your_own_value>"
                 sslvpn_access_port: "28"
                 sslvpn_require_certificate: "enable"
                 type: "ipsec"
                 vpn_configuration_content: "<your_own_value>"
                 vpn_configuration_name: "<your_own_value>"
             configuration_content: "<your_own_value>"
             configuration_name: "<your_own_value>"
             disable_wf_when_protected: "enable"
             distribute_configuration_profile: "enable"
             forticlient_wf: "enable"
             forticlient_wf_profile: "<your_own_value> (source webfilter.profile.name)"
         forticlient_winmac_settings:
             av_realtime_protection: "enable"
             av_signature_up_to_date: "enable"
             forticlient_application_firewall: "enable"
             forticlient_application_firewall_list: "<your_own_value> (source application.list.name)"
             forticlient_av: "enable"
             forticlient_ems_compliance: "enable"
             forticlient_ems_compliance_action: "block"
             forticlient_ems_entries:
              -
                 name: "default_name_48 (source endpoint-control.forticlient-ems.name)"
             forticlient_linux_ver: "<your_own_value>"
             forticlient_log_upload: "enable"
             forticlient_log_upload_level: "traffic"
             forticlient_log_upload_server: "<your_own_value>"
             forticlient_mac_ver: "<your_own_value>"
             forticlient_minimum_software_version: "enable"
             forticlient_operating_system:
              -
                 id:  "56"
                 os_name: "<your_own_value>"
                 os_type: "custom"
             forticlient_own_file:
              -
                 file: "<your_own_value>"
                 id:  "61"
             forticlient_registration_compliance_action: "block"
             forticlient_registry_entry:
              -
                 id:  "64"
                 registry_entry: "<your_own_value>"
             forticlient_running_app:
              -
                 app_name: "<your_own_value>"
                 app_sha256_signature: "<your_own_value>"
                 app_sha256_signature2: "<your_own_value>"
                 app_sha256_signature3: "<your_own_value>"
                 app_sha256_signature4: "<your_own_value>"
                 application_check_rule: "present"
                 id:  "73"
                 process_name: "<your_own_value>"
                 process_name2: "<your_own_value>"
                 process_name3: "<your_own_value>"
                 process_name4: "<your_own_value>"
             forticlient_security_posture: "enable"
             forticlient_security_posture_compliance_action: "block"
             forticlient_system_compliance: "enable"
             forticlient_system_compliance_action: "block"
             forticlient_vuln_scan: "enable"
             forticlient_vuln_scan_compliance_action: "block"
             forticlient_vuln_scan_enforce: "critical"
             forticlient_vuln_scan_enforce_grace: "85"
             forticlient_vuln_scan_exempt: "enable"
             forticlient_wf: "enable"
             forticlient_wf_profile: "<your_own_value> (source webfilter.profile.name)"
             forticlient_win_ver: "<your_own_value>"
             os_av_software_installed: "enable"
             sandbox_address: "<your_own_value>"
             sandbox_analysis: "enable"
         on_net_addr:
          -
             name: "default_name_94 (source firewall.address.name firewall.addrgrp.name)"
         profile_name: "<your_own_value>"
         replacemsg_override_group: "<your_own_value> (source system.replacemsg-group.name)"
         src_addr:
          -
             name: "default_name_98 (source firewall.address.name firewall.addrgrp.name)"
         user_groups:
          -
             name: "default_name_100 (source user.group.name)"
         users:
          -
             name: "default_name_102 (source user.local.name)"

RETURN VALUES                   *fortios_endpoint_control_profile-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_endpoint_control_profile-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_endpoint_control_profile-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_endpoint_control_profile_module.html

SYNOPSIS                   *grafana_datasource*

     • Create/update/delete Grafana datasources via API.

PARAMETERS                   *grafana_datasource-parameters*

             Parameter                      Choices/Defaults                                                                       Comments
   access                          Choices:
   -                               • direct                              The access mode for this datasource.
                                   • proxy ←
   aws_access_key                Default:
   -                             ""                                      AWS access key for CloudWatch datasource type when aws_auth_type is keys
   added in 2.8
   aws_assume_role_arn           Default:
   -                             ""                                      AWS IAM role arn to assume for CloudWatch datasource type when aws_auth_type is arn
   added in 2.8
   aws_auth_type                   Choices:
   -                               • keys ←                              Type for AWS authentication for CloudWatch datasource type (authType of grafana api)
   added in 2.8                    • credentials
                                   • arn
   aws_credentials_profile       Default:
   -                             ""                                      Profile for AWS credentials for CloudWatch datasource type when aws_auth_type is credentials
   added in 2.8
   aws_custom_metrics_namespaces Default:
   -                             ""                                      Namespaces of Custom Metrics for CloudWatch datasource type
   added in 2.8
                                   Choices:
                                   • ap-northeast-1
                                   • ap-northeast-2
                                   • ap-southeast-1
                                   • ap-southeast-2
                                   • ap-south-1
                                   • ca-central-1
                                   • cn-north-1
   aws_default_region              • cn-northwest-1
   -                               • eu-central-1                        AWS default region for CloudWatch datasource type
   added in 2.8                    • eu-west-1
                                   • eu-west-2
                                   • eu-west-3
                                   • sa-east-1
                                   • us-east-1 ←
                                   • us-east-2
                                   • us-gov-west-1
                                   • us-west-1
                                   • us-west-2
   aws_secret_key                Default:
   -                             ""                                      AWS secret key for CloudWatch datasource type when aws_auth_type is keys
   added in 2.8
   basic_auth_password                                                   The datasource basic auth password, when basic auth is yes.
   -
   basic_auth_user                                                       The datasource basic auth user.
   -                                                                     Setting this option with basic_auth_password will enable basic auth.
   client_cert
   -                                                                     TLS certificate path used by ansible to query grafana api
   added in 2.8
   client_key
   -                                                                     TLS private key path used by ansible to query grafana api
   added in 2.8
   database                                                              Name of the database for the datasource.
   -                                                                     This options is required when the ds_type is influxdb, elasticsearch (index name), mysql or postgres.
                                   Choices:
                                   • graphite
                                   • prometheus
                                   • elasticsearch
   ds_type                         • influxdb                            The type of the datasource.
   - / required                    • opentsdb
                                   • mysql
                                   • postgres
                                   • cloudwatch
                                   • alexanderzobnin-zabbix-datasource
                                   Choices:
   es_version                      • 2                                   Elasticsearch version (for ds_type = elasticsearch only)
   -                               • 5 ←                                 Version 56 is for elasticsearch 5.6+ where tou can specify the max_concurrent_shard_requests option.
                                   • 56
   grafana_api_key                                                       The Grafana API key.
   -                                                                     If set, grafana_user and grafana_password will be ignored.
   grafana_url                                                           The Grafana URL.
   - / required
                                   Choices:
                                   • 

   interval                        • Hourly                              For elasticsearch ds_type, this is the index pattern used.
   -                               • Daily
                                   • Weekly
                                   • Monthly
                                   • Yearly
   is_default                      Choices:
   boolean                         • no ←                                Make this datasource the default one.
                                   • yes
   max_concurrent_shard_requests Default:                                Starting with elasticsearch 5.6, you can specify the max concurrent shard per requests.
   -                             256
   name                                                                  The name of the datasource.
   - / required
   org_id                        Default:                                Grafana Organisation ID in which the datasource should be created.
   -                             1                                       Not used when grafana_api_key is set, because the grafana_api_key only belong to one organisation.
   password                                                              The datasource password
   -
                                   Choices:
   sslmode                         • disable
   -                               • require                             SSL mode for postgres datasource type.
                                   • verify-ca
                                   • verify-full
   state                           Choices:
   -                               • absent                              Status of the datasource
                                   • present ←
   time_field                    Default:                                Name of the time field in elasticsearch ds.
   -                             "timestamp"                             For example @timestamp
   time_interval                                                         Minimum group by interval for influxdb or elasticsearch datasources.
   -                                                                     for example >10s
   tls_ca_cert                                                           The TLS CA certificate for self signed certificates.
   -                                                                     Only used when tls_client_cert and tls_client_key are set.
   tls_client_cert                                                       The client TLS certificate.
   -                                                                     If tls_client_cert and tls_client_key are set, this will enable TLS authentication.
                                                                         Starts with ----- BEGIN CERTIFICATE -----
   tls_client_key                                                        The client TLS private key
   -                                                                     Starts with ----- BEGIN RSA PRIVATE KEY -----
   tls_skip_verify                 Choices:
   boolean                         • no ←                                Skip the TLS datasource certificate verification.
   added in 2.6                    • yes
   trends                          Choices:
   boolean                         • no                                  Use trends or not for zabbix datasource type
   added in 2.6                    • yes
   tsdb_resolution                 Choices:
   -                               • millisecond                         The opentsdb time resolution.
                                   • second ←
                                   Choices:
   tsdb_version                    • 1 ←                                 The opentsdb version.
   -                               • 2                                   Use 1 for <=2.1, 2 for ==2.2, 3 for ==2.3.
                                   • 3
   url                                                                   The URL of the datasource.
   - / required                                                          aliases: ds_url
   url_password                  Default:                                The Grafana API password.
   -                             "admin"                                 aliases: grafana_password
   added in 2.7
   url_username                  Default:                                The Grafana API user.
   -                             "admin"                                 aliases: grafana_user
   added in 2.7
   use_proxy                       Choices:
   boolean                         • no                                  Boolean of whether or not to use proxy.
   added in 2.8                    • yes ←
   user                                                                  The datasource login user for influxdb datasources.
   -
   validate_certs                  Choices:
   boolean                         • no                                  Whether to validate the Grafana certificate.
                                   • yes ←
   with_credentials                Choices:
   boolean                         • no ←                                Whether credentials such as cookies or auth headers should be sent with cross-site requests.
                                   • yes

EXAMPLES                   *grafana_datasource-examples*

 ---
 - name: Create elasticsearch datasource
   grafana_datasource:
     name: "datasource-elastic"
     grafana_url: "https://grafana.company.com"
     grafana_user: "admin"
     grafana_password: "xxxxxx"
     org_id: "1"
     ds_type: "elasticsearch"
     ds_url: "https://elastic.company.com:9200"
     database: "[logstash_]YYYY.MM.DD"
     basic_auth_user: "grafana"
     basic_auth_password: """"""""
     time_field: "@timestamp"
     time_interval: "1m"
     interval: "Daily"
     es_version: 56
     max_concurrent_shard_requests: 42
     tls_ca_cert: "/etc/ssl/certs/ca.pem"

 - name: Create influxdb datasource
   grafana_datasource:
     name: "datasource-influxdb"
     grafana_url: "https://grafana.company.com"
     grafana_user: "admin"
     grafana_password: "xxxxxx"
     org_id: "1"
     ds_type: "influxdb"
     ds_url: "https://influx.company.com:8086"
     database: "telegraf"
     time_interval: ">10s"
     tls_ca_cert: "/etc/ssl/certs/ca.pem"

 - name: Create postgres datasource
   grafana_datasource:
     name: "datasource-postgres"
     grafana_url: "https://grafana.company.com"
     grafana_user: "admin"
     grafana_password: "xxxxxx"
     org_id: "1"
     ds_type: "postgres"
     ds_url: "postgres.company.com:5432"
     database: "db"
     user: "postgres"
     password: "iampgroot"
     sslmode: "verify-full"

 - name: Create cloudwatch datasource
   grafana_datasource:
     name: "datasource-cloudwatch"
     grafana_url: "https://grafana.company.com"
     grafana_user: "admin"
     grafana_password: "xxxxxx"
     org_id: "1"
     ds_type: "cloudwatch"
     url: "http://monitoring.us-west-1.amazonaws.com"
     aws_auth_type: "keys"
     aws_default_region: "us-west-1"
     aws_access_key: "speakFriendAndEnter"
     aws_secret_key: "mel10n"
     aws_custom_metrics_namespaces: "n1,n2"

RETURN VALUES                   *grafana_datasource-return values*

   Common return values are documented here, the following are the fields unique to this module:

      Key     Returned                                                                                  Description
                       datasource updated by module
   after      changed  Sample:
   dictionary          {'access': 'proxy', 'basicAuth': False, 'database': 'test_"', 'id': 1035, 'isDefault': False, 'jsonData': {'esVersion': 5, 'timeField': '@timestamp', 'timeInterval': '10s'},
                       'name': 'grafana_datasource_test', 'orgId': 1, 'type': 'elasticsearch', 'url': 'http://elastic.company.com:9200', 'user': '', 'password': '', 'withCredentials': False}
                       datasource returned by grafana api
   before     changed  Sample:
   dictionary          {'access': 'proxy', 'basicAuth': False, 'database': 'test_"', 'id': 1035, 'isDefault': False, 'jsonData': {'esVersion': 5, 'timeField': '@timestamp', 'timeInterval': '1m'},
                       'name': 'grafana_datasource_test', 'orgId': 1, 'type': 'elasticsearch', 'url': 'http://elastic.company.com:9200', 'user': '', 'password': '', 'withCredentials': False}
   id                  Id of the datasource
   integer    success  Sample:
                       42
   name                name of the datasource created.
   string     success  Sample:
                       test-ds

STATUS                   *grafana_datasource-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Thierry Sallé (@seuf)
     • Martin Wang (@martinwangjian)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *grafana_datasource-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/grafana_datasource_module.html

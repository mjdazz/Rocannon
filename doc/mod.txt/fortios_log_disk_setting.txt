SYNOPSIS                   *fortios_log_disk_setting*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify log_disk feature and setting category. Examples include all parameters and values
       need to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_log_disk_setting-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_log_disk_setting-parameters*

              Parameter            Choices/Defaults                                                                     Comments
   host                                             FortiOS or FortiGate IP address.
   string
   https                             Choices:
   boolean                           • no           Indicates if the requests towards FortiGate must use HTTPS protocol.
                                     • yes ←
   log_disk_setting                Default:         Settings for local disk logging.
   dictionary                      null
    diskfull                         Choices:
    string                           • overwrite    Action to take when disk is full. The system can overwrite the oldest log messages or stop logging when the disk is full .
                                     • nolog
    dlp_archive_quota                               DLP archive quota (MB).
    integer
    full_final_warning_threshold                    Log full final warning threshold as a percent (3 - 100).
    integer
    full_first_warning_threshold                    Log full first warning threshold as a percent (1 - 98).
    integer
    full_second_warning_threshold                   Log full second warning threshold as a percent (2 - 99).
    integer
    ips_archive                      Choices:
    string                           • enable       Enable/disable IPS packet archiving to the local disk.
                                     • disable
    log_quota                                       Disk log quota (MB).
    integer
    max_log_file_size                               Maximum log file size before rolling (1 - 100 Mbytes).
    integer
    max_policy_packet_capture_size                  Maximum size of policy sniffer in MB (0 means unlimited).
    integer
    maximum_log_age                                 Delete log files older than (days).
    integer
    report_quota                                    Report quota (MB).
    integer
                                     Choices:
                                     • sunday
                                     • monday
    roll_day                         • tuesday      Day of week on which to roll log file.
    string                           • wednesday
                                     • thursday
                                     • friday
                                     • saturday
    roll_schedule                    Choices:
    string                           • daily        Frequency to check log file for rolling.
                                     • weekly
    roll_time                                       Time of day to roll the log file (hh:mm).
    string
    source_ip                                       Source IP address to use for uploading disk log files.
    string
    status                           Choices:
    string                           • enable       Enable/disable local disk logging.
                                     • disable
    upload                           Choices:
    string                           • enable       Enable/disable uploading log files when they are rolled.
                                     • disable
    upload_delete_files              Choices:
    string                           • enable       Delete log files after uploading .
                                     • disable
    upload_destination               Choices:       The type of server to upload log files to. Only FTP is currently supported.
    string                           • ftp-server
                                     Choices:
    upload_ssl_conn                  • default
    string                           • high         Enable/disable encrypted FTPS communication to upload log files.
                                     • low
                                     • disable
    uploaddir                                       The remote directory on the FTP server to upload log files to.
    string
    uploadip                                        IP address of the FTP server to upload log files to.
    string
    uploadpass                                      Password required to log into the FTP server to upload disk log files.
    string
    uploadport                                      TCP port to use for communicating with the FTP server .
    integer
    uploadsched                      Choices:
    string                           • disable      Set the schedule for uploading log files to the FTP server .
                                     • enable
    uploadtime                                      Time of day at which log files are uploaded if uploadsched is enabled (hh:mm or hh).
    string
                                     Choices:
                                     • traffic
                                     • event
                                     • virus
                                     • webfilter
                                     • IPS
                                     • spamfilter
    uploadtype                       • dlp-archive  Types of log files to upload. Separate multiple entries with a space.
    string                           • anomaly
                                     • voip
                                     • dlp
                                     • app-ctrl
                                     • waf
                                     • netscan
                                     • gtp
                                     • dns
    uploaduser                                      Username required to log into the FTP server to upload disk log files.
    string
   password                        Default:         FortiOS or FortiGate password.
   string                          ""
   ssl_verify                        Choices:
   boolean                           • no           Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                      • yes ←
   username                                         FortiOS or FortiGate username.
   string
   vdom                            Default:         Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different
   string                          "root"           unit.

NOTES                   *fortios_log_disk_setting-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_log_disk_setting-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Settings for local disk logging.
     fortios_log_disk_setting:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       log_disk_setting:
         diskfull: "overwrite"
         dlp_archive_quota: "4"
         full_final_warning_threshold: "5"
         full_first_warning_threshold: "6"
         full_second_warning_threshold: "7"
         ips_archive: "enable"
         log_quota: "9"
         max_log_file_size: "10"
         max_policy_packet_capture_size: "11"
         maximum_log_age: "12"
         report_quota: "13"
         roll_day: "sunday"
         roll_schedule: "daily"
         roll_time: "<your_own_value>"
         source_ip: "84.230.14.43"
         status: "enable"
         upload: "enable"
         upload_delete_files: "enable"
         upload_destination: "ftp-server"
         upload_ssl_conn: "default"
         uploaddir: "<your_own_value>"
         uploadip: "<your_own_value>"
         uploadpass: "<your_own_value>"
         uploadport: "26"
         uploadsched: "disable"
         uploadtime: "<your_own_value>"
         uploadtype: "traffic"
         uploaduser: "<your_own_value>"

RETURN VALUES                   *fortios_log_disk_setting-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_log_disk_setting-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_log_disk_setting-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_log_disk_setting_module.html

SYNOPSIS                   *fortios_switch_controller_managed_switch*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify switch_controller feature and managed_switch category. Examples include all
       parameters and values need to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_switch_controller_managed_switch-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_switch_controller_managed_switch-parameters*

              Parameter             Choices/Defaults                                                                     Comments
   host                                              FortiOS or FortiGate IP address.
   string
   https                              Choices:
   boolean                            • no           Indicates if the requests towards FortiGate must use HTTPS protocol.
                                      • yes ←
   password                         Default:         FortiOS or FortiGate password.
   string                           ""
   ssl_verify                         Choices:
   boolean                            • no           Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                       • yes ←
   state                              Choices:       Indicates whether to create or remove the object. This attribute was present already in previous version in a deeper level. It has been moved
   string                             • present      out to this outer level.
   added in 2.9                       • absent
   switch_controller_managed_switch Default:         Configure FortiSwitch devices that are managed by this FortiGate.
   dictionary                       null
     802_1X_settings                                 Configuration method to edit FortiSwitch 802.1X global settings.
     dictionary
       link_down_auth                 Choices:
       string                         • set-unauth   Authentication state to set if a link is down.
                                      • no-action
       local_override                 Choices:
       string                         • enable       Enable to override global 802.1X settings on individual FortiSwitches.
                                      • disable
       max_reauth_attempt                            Maximum number of authentication attempts (0 - 15).
       integer
       reauth_period                                 Reauthentication time interval (1 - 1440 min).
       integer
     custom_command                                  Configuration method to edit FortiSwitch commands to be pushed to this FortiSwitch device upon rebooting the FortiGate switch controller or the
     list                                            FortiSwitch.
       command_entry                                 List of FortiSwitch commands.
       string
       command_name                                  Names of commands to be pushed to this FortiSwitch device, as configured under config switch-controller custom-command. Source
       string                                        switch-controller.custom-command.command-name.
     delayed_restart_trigger                         Delayed restart triggered for this FortiSwitch.
     integer
     description                                     Description.
     string
     directly_connected                              Directly connected FortiSwitch.
     integer
     dynamic_capability                              List of features this FortiSwitch supports (not configurable) that is sent to the FortiGate device for subsequent configuration initiated by the
     integer                                         FortiGate device.
     dynamically_discovered                          Dynamically discovered FortiSwitch.
     integer
                                      Choices:
     fsw_wan1_admin                   • discovered   FortiSwitch WAN1 admin status; enable to authorize the FortiSwitch as a managed switch.
     string                           • disable
                                      • enable
     fsw_wan1_peer                                   Fortiswitch WAN1 peer port.
     string
                                      Choices:
     fsw_wan2_admin                   • discovered   FortiSwitch WAN2 admin status; enable to authorize the FortiSwitch as a managed switch.
     string                           • disable
                                      • enable
     fsw_wan2_peer                                   FortiSwitch WAN2 peer port.
     string
     igmp_snooping                                   Configure FortiSwitch IGMP snooping global settings.
     dictionary
       aging_time                                    Maximum time to retain a multicast snooping entry for which no packets have been seen (15 - 3600 sec).
       integer
       flood_unknown_multicast        Choices:
       string                         • enable       Enable/disable unknown multicast flooding.
                                      • disable
       local_override                 Choices:
       string                         • enable       Enable/disable overriding the global IGMP snooping configuration.
                                      • disable
     max_allowed_trunk_members                       FortiSwitch maximum allowed trunk members.
     integer
     mirror                                          Configuration method to edit FortiSwitch packet mirror.
     list
       dst                                           Destination port.
       string
       name                                          Mirror name.
       string / required
       src_egress                                    Source egress interfaces.
       list
               name                                  Interface name.
               string / required
       src_ingress                                   Source ingress interfaces.
       list
               name                                  Interface name.
               string / required
       status                         Choices:
       string                         • active       Active/inactive mirror configuration.
                                      • inactive
       switching_packet               Choices:
       string                         • enable       Enable/disable switching functionality when mirroring.
                                      • disable
     name                                            Managed-switch name.
     string
     owner_vdom                                      VDOM which owner of port belongs to.
     string
     poe_detection_type                              PoE detection type for FortiSwitch.
     integer
     poe_pre_standard_detection       Choices:
     string                           • enable       Enable/disable PoE pre-standard detection.
                                      • disable
     ports                                           Managed-switch port list.
     list
       allowed_vlans                                 Configure switch port tagged vlans
       list
               vlan_name                             VLAN name. Source system.interface.name.
               string
       allowed_vlans_all              Choices:
       string                         • enable       Enable/disable all defined vlans on this port.
                                      • disable
       arp_inspection_trust           Choices:
       string                         • untrusted    Trusted or untrusted dynamic ARP inspection.
                                      • trusted
       bundle                         Choices:
       string                         • enable       Enable/disable Link Aggregation Group (LAG) bundling for non-FortiLink interfaces.
                                      • disable
       description                                   Description for port.
       string
       dhcp_snoop_option82_trust      Choices:
       string                         • enable       Enable/disable allowance of DHCP with option-82 on untrusted interface.
                                      • disable
       dhcp_snooping                  Choices:
       string                         • untrusted    Trusted or untrusted DHCP-snooping interface.
                                      • trusted
                                      Choices:
       discard_mode                   • none         Configure discard mode for port.
       string                         • all-untagged
                                      • all-tagged
       edge_port                      Choices:
       string                         • enable       Enable/disable this interface as an edge port, bridging connections between workstations and/or computers.
                                      • disable
       export_tags                                   Switch controller export tag name.
       list
               tag_name                              Switch tag name. Source switch-controller.switch-interface-tag.name.
               string
       export_to                                     Export managed-switch port to a tenant VDOM. Source system.vdom.name.
       string
       export_to_pool                                Switch controller export port to pool-list. Source switch-controller.virtual-port-pool.name.
       string
       export_to_pool_flag                           Switch controller export port to pool-list.
       integer
       fgt_peer_device_name                          FGT peer device name.
       string
       fgt_peer_port_name                            FGT peer port name.
       string
       fiber_port                                    Fiber-port.
       integer
       flags                                         Port properties flags.
       integer
       fortilink_port                                FortiLink uplink port.
       integer
       igmp_snooping                  Choices:
       string                         • enable       Set IGMP snooping mode for the physical port interface.
                                      • disable
       igmps_flood_reports            Choices:
       string                         • enable       Enable/disable flooding of IGMP reports to this interface when igmp-snooping enabled.
                                      • disable
       igmps_flood_traffic            Choices:
       string                         • enable       Enable/disable flooding of IGMP snooping traffic to this interface.
                                      • disable
       isl_local_trunk_name                          ISL local trunk name.
       string
       isl_peer_device_name                          ISL peer device name.
       string
       isl_peer_port_name                            ISL peer port name.
       string
       lacp_speed                     Choices:
       string                         • slow         end Link Aggregation Control Protocol (LACP) messages every 30 seconds (slow) or every second (fast).
                                      • fast
       learning_limit                                Limit the number of dynamic MAC addresses on this Port (1 - 128, 0 = no limit, default).
       integer
       lldp_profile                                  LLDP port TLV profile. Source switch-controller.lldp-profile.name.
       string
                                      Choices:
       lldp_status                    • disable
       string                         • rx-only      LLDP transmit and receive status.
                                      • tx-only
                                      • tx-rx
       loop_guard                     Choices:
       string                         • enabled      Enable/disable loop-guard on this interface, an STP optimization used to prevent network loops.
                                      • disabled
       loop_guard_timeout                            Loop-guard timeout (0 - 120 min).
       integer
       max_bundle                                    Maximum size of LAG bundle (1 - 24)
       integer
       mclag                          Choices:
       string                         • enable       Enable/disable multi-chassis link aggregation (MCLAG).
                                      • disable
       member_withdrawal_behavior     Choices:
       string                         • forward      Port behavior after it withdraws because of loss of control packets.
                                      • block
       members                                       Aggregated LAG bundle interfaces.
       list
               member_name                           Interface name from available options.
               string
       min_bundle                                    Minimum size of LAG bundle (1 - 24)
       integer
                                      Choices:
       mode                           • static       LACP mode: ignore and do not send control messages, or negotiate 802.3ad aggregation passively or actively.
       string                         • lacp-passive
                                      • lacp-active
       poe_capable                                   PoE capable.
       integer
       poe_pre_standard_detection     Choices:
       string                         • enable       Enable/disable PoE pre-standard detection.
                                      • disable
       poe_status                     Choices:
       string                         • enable       Enable/disable PoE status.
                                      • disable
       port_name                                     Switch port name.
       string
       port_number                                   Port number.
       integer
       port_owner                                    Switch port name.
       string
       port_prefix_type                              Port prefix type.
       integer
       port_security_policy                          Switch controller authentication policy to apply to this managed switch from available options. Source switch-controller
       string                                        .security-policy.802-1X.name switch-controller.security-policy.captive-portal.name.
                                      Choices:
                                      • src-mac
       port_selection_criteria        • dst-mac
       string                         • src-dst-mac  Algorithm for aggregate port selection.
                                      • src-ip
                                      • dst-ip
                                      • src-dst-ip
       qos_policy                                    Switch controller QoS policy from available options. Source switch-controller.qos.qos-policy.name.
       string
                                      Choices:
       sample_direction               • tx           sFlow sample direction.
       string                         • rx
                                      • both
       sflow_counter_interval                        sFlow sampler counter polling interval (1 - 255 sec).
       integer
       sflow_sample_rate                             sFlow sampler sample rate (0 - 99999 p/sec).
       integer
       sflow_sampler                  Choices:
       string                         • enabled      Enable/disable sFlow protocol on this interface.
                                      • disabled
                                      Choices:
                                      • 10half
                                      • 10full
                                      • 100half
                                      • 100full
                                      • 1000auto
                                      • 1000fiber
                                      • 1000full
       speed                          • 10000        Switch port speed; default and available settings depend on hardware.
       string                         • 40000
                                      • auto
                                      • auto-module
                                      • 100FX-half
                                      • 100FX-full
                                      • 100000full
                                      • 2500full
                                      • 25000full
                                      • 50000full
       speed_mask                                    Switch port speed mask.
       integer
       stacking_port                                 Stacking port.
       integer
       status                         Choices:
       string                         • up           Switch port admin status: up or down.
                                      • down
       stp_bpdu_guard                 Choices:
       string                         • enabled      Enable/disable STP BPDU guard on this interface.
                                      • disabled
       stp_bpdu_guard_timeout                        BPDU Guard disabling protection (0 - 120 min).
       integer
       stp_root_guard                 Choices:
       string                         • enabled      Enable/disable STP root guard on this interface.
                                      • disabled
       stp_state                      Choices:
       string                         • enabled      Enable/disable Spanning Tree Protocol (STP) on this interface.
                                      • disabled
       switch_id                                     Switch id.
       string
       type                           Choices:
       string                         • physical     Interface type: physical or trunk port.
                                      • trunk
       untagged_vlans                                Configure switch port untagged vlans
       list
               vlan_name                             VLAN name. Source system.interface.name.
               string
       virtual_port                                  Virtualized switch port.
       integer
       vlan                                          Assign switch ports to a VLAN. Source system.interface.name.
       string
     pre_provisioned                                 Pre-provisioned managed switch.
     integer
     staged_image_version                            Staged image version for FortiSwitch.
     string
                                                     Deprecated
                                      Choices:       Starting with Ansible 2.9 we recommend using the top-level 'state' parameter.
     state                            • present
     string                           • absent       ════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                                     Indicates whether to create or remove the object.
     storm_control                                   Configuration method to edit FortiSwitch storm control for measuring traffic activity using data rates to prevent traffic disruption.
     dictionary
       broadcast                      Choices:
       string                         • enable       Enable/disable storm control to drop broadcast traffic.
                                      • disable
       local_override                 Choices:
       string                         • enable       Enable to override global FortiSwitch storm control settings for this FortiSwitch.
                                      • disable
       rate                                          Rate in packets per second at which storm traffic is controlled (1 - 10000000). Storm control drops excess traffic data rates beyond this
       integer                                       threshold.
       unknown_multicast              Choices:
       string                         • enable       Enable/disable storm control to drop unknown multicast traffic.
                                      • disable
       unknown_unicast                Choices:
       string                         • enable       Enable/disable storm control to drop unknown unicast traffic.
                                      • disable
     stp_settings                                    Configuration method to edit Spanning Tree Protocol (STP) settings used to prevent bridge loops.
     dictionary
       forward_time                                  Period of time a port is in listening and learning state (4 - 30 sec).
       integer
       hello_time                                    Period of time between successive STP frame Bridge Protocol Data Units (BPDUs) sent on a port (1 - 10 sec).
       integer
       local_override                 Choices:
       string                         • enable       Enable to configure local STP settings that override global STP settings.
                                      • disable
       max_age                                       Maximum time before a bridge port saves its configuration BPDU information (6 - 40 sec).
       integer
       max_hops                                      Maximum number of hops between the root bridge and the furthest bridge (1- 40).
       integer
       name                                          Name of local STP settings configuration.
       string
       pending_timer                                 Pending time (1 - 15 sec).
       integer
       revision                                      STP revision number (0 - 65535).
       integer
       status                         Choices:
       string                         • enable       Enable/disable STP.
                                      • disable
     switch_device_tag                               User definable label/tag.
     string
     switch_id                                       Managed-switch id.
     string
     switch_log                                      Configuration method to edit FortiSwitch logging settings (logs are transferred to and inserted into the FortiGate event log).
     dictionary
       local_override                 Choices:
       string                         • enable       Enable to configure local logging settings that override global logging settings.
                                      • disable
                                      Choices:
                                      • emergency
                                      • alert
       severity                       • critical
       string                         • error        Severity of FortiSwitch logs that are added to the FortiGate event log.
                                      • warning
                                      • notification
                                      • information
                                      • debug
       status                         Choices:
       string                         • enable       Enable/disable adding FortiSwitch logs to the FortiGate event log.
                                      • disable
     switch_profile                                  FortiSwitch profile. Source switch-controller.switch-profile.name.
     string
     switch_stp_settings                             Configure spanning tree protocol (STP).
     dictionary
       status                         Choices:
       string                         • enable       Enable/disable STP.
                                      • disable
     type                             Choices:
     string                           • virtual      Indication of switch type, physical or virtual.
                                      • physical
     version                                         FortiSwitch version.
     integer
   username                                          FortiOS or FortiGate username.
   string
   vdom                             Default:         Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different
   string                           "root"           unit.

NOTES                   *fortios_switch_controller_managed_switch-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_switch_controller_managed_switch-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Configure FortiSwitch devices that are managed by this FortiGate.
     fortios_switch_controller_managed_switch:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       state: "present"
       switch_controller_managed_switch:
         802_1X_settings:
             link_down_auth: "set-unauth"
             local_override: "enable"
             max_reauth_attempt: "6"
             reauth_period: "7"
         custom_command:
          -
             command_entry: "<your_own_value>"
             command_name: "<your_own_value> (source switch-controller.custom-command.command-name)"
         delayed_restart_trigger: "11"
         description: "<your_own_value>"
         directly_connected: "13"
         dynamic_capability: "14"
         dynamically_discovered: "15"
         fsw_wan1_admin: "discovered"
         fsw_wan1_peer: "<your_own_value>"
         fsw_wan2_admin: "discovered"
         fsw_wan2_peer: "<your_own_value>"
         igmp_snooping:
             aging_time: "21"
             flood_unknown_multicast: "enable"
             local_override: "enable"
         max_allowed_trunk_members: "24"
         mirror:
          -
             dst: "<your_own_value>"
             name: "default_name_27"
             src_egress:
              -
                 name: "default_name_29"
             src_ingress:
              -
                 name: "default_name_31"
             status: "active"
             switching_packet: "enable"
         name: "default_name_34"
         owner_vdom: "<your_own_value>"
         poe_detection_type: "36"
         poe_pre_standard_detection: "enable"
         ports:
          -
             allowed_vlans:
              -
                 vlan_name: "<your_own_value> (source system.interface.name)"
             allowed_vlans_all: "enable"
             arp_inspection_trust: "untrusted"
             bundle: "enable"
             description: "<your_own_value>"
             dhcp_snoop_option82_trust: "enable"
             dhcp_snooping: "untrusted"
             discard_mode: "none"
             edge_port: "enable"
             export_tags:
              -
                 tag_name: "<your_own_value> (source switch-controller.switch-interface-tag.name)"
             export_to: "<your_own_value> (source system.vdom.name)"
             export_to_pool: "<your_own_value> (source switch-controller.virtual-port-pool.name)"
             export_to_pool_flag: "53"
             fgt_peer_device_name: "<your_own_value>"
             fgt_peer_port_name: "<your_own_value>"
             fiber_port: "56"
             flags: "57"
             fortilink_port: "58"
             igmp_snooping: "enable"
             igmps_flood_reports: "enable"
             igmps_flood_traffic: "enable"
             isl_local_trunk_name: "<your_own_value>"
             isl_peer_device_name: "<your_own_value>"
             isl_peer_port_name: "<your_own_value>"
             lacp_speed: "slow"
             learning_limit: "66"
             lldp_profile: "<your_own_value> (source switch-controller.lldp-profile.name)"
             lldp_status: "disable"
             loop_guard: "enabled"
             loop_guard_timeout: "70"
             max_bundle: "71"
             mclag: "enable"
             member_withdrawal_behavior: "forward"
             members:
              -
                 member_name: "<your_own_value>"
             min_bundle: "76"
             mode: "static"
             poe_capable: "78"
             poe_pre_standard_detection: "enable"
             poe_status: "enable"
             port_name: "<your_own_value>"
             port_number: "82"
             port_owner: "<your_own_value>"
             port_prefix_type: "84"
             port_security_policy: "<your_own_value> (source switch-controller.security-policy.802-1X.name switch-controller.security-policy.captive-portal
               .name)"
             port_selection_criteria: "src-mac"
             qos_policy: "<your_own_value> (source switch-controller.qos.qos-policy.name)"
             sample_direction: "tx"
             sflow_counter_interval: "89"
             sflow_sample_rate: "90"
             sflow_sampler: "enabled"
             speed: "10half"
             speed_mask: "93"
             stacking_port: "94"
             status: "up"
             stp_bpdu_guard: "enabled"
             stp_bpdu_guard_timeout: "97"
             stp_root_guard: "enabled"
             stp_state: "enabled"
             switch_id: "<your_own_value>"
             type: "physical"
             untagged_vlans:
              -
                 vlan_name: "<your_own_value> (source system.interface.name)"
             virtual_port: "104"
             vlan: "<your_own_value> (source system.interface.name)"
         pre_provisioned: "106"
         staged_image_version: "<your_own_value>"
         storm_control:
             broadcast: "enable"
             local_override: "enable"
             rate: "111"
             unknown_multicast: "enable"
             unknown_unicast: "enable"
         stp_settings:
             forward_time: "115"
             hello_time: "116"
             local_override: "enable"
             max_age: "118"
             max_hops: "119"
             name: "default_name_120"
             pending_timer: "121"
             revision: "122"
             status: "enable"
         switch_device_tag: "<your_own_value>"
         switch_id: "<your_own_value>"
         switch_log:
             local_override: "enable"
             severity: "emergency"
             status: "enable"
         switch_profile: "<your_own_value> (source switch-controller.switch-profile.name)"
         switch_stp_settings:
             status: "enable"
         type: "virtual"
         version: "134"

RETURN VALUES                   *fortios_switch_controller_managed_switch-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_switch_controller_managed_switch-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_switch_controller_managed_switch-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_switch_controller_managed_switch_module.html

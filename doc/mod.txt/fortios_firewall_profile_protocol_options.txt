SYNOPSIS                   *fortios_firewall_profile_protocol_options*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify firewall feature and profile_protocol_options category. Examples include all
       parameters and values need to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_firewall_profile_protocol_options-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_firewall_profile_protocol_options-parameters*

               Parameter                Choices/Defaults                                                                     Comments
   firewall_profile_protocol_options Default:                Configure protocol options.
   dictionary                        null
      comment                                                Optional comments.
      string
      dns                                                    Configure DNS protocol options.
      dictionary
        ports                                                Ports to scan for content (1 - 65535).
        integer
        status                         Choices:
        string                         • enable              Enable/disable the active status of scanning for this protocol.
                                       • disable
      ftp                                                    Configure FTP protocol options.
      dictionary
        comfort_amount                                       Amount of data to send in a transmission for client comforting (1 - 10240 bytes).
        integer
        comfort_interval                                     Period of time between start, or last transmission, and the next client comfort transmission of data (1 - 900 sec).
        integer
        inspect_all                    Choices:
        string                         • enable              Enable/disable the inspection of all ports for the protocol.
                                       • disable
                                       Choices:
                                       • clientcomfort
        options                        • oversize            One or more options that can be applied to the session.
        string                         • splice
                                       • bypass-rest-command
                                       • bypass-mode-command
        oversize_limit                                       Maximum in-memory file size that can be scanned (1 - 383 MB).
        integer
        ports                                                Ports to scan for content (1 - 65535).
        integer
        scan_bzip2                     Choices:
        string                         • enable              Enable/disable scanning of BZip2 compressed files.
                                       • disable
        status                         Choices:
        string                         • enable              Enable/disable the active status of scanning for this protocol.
                                       • disable
        uncompressed_nest_limit                              Maximum nested levels of compression that can be uncompressed and scanned (2 - 100).
        integer
        uncompressed_oversize_limit                          Maximum in-memory uncompressed file size that can be scanned (0 - 383 MB, 0 = unlimited).
        integer
      http                                                   Configure HTTP protocol options.
      dictionary
        block_page_status_code                               Code number returned for blocked HTTP pages (non-FortiGuard only) (100 - 599).
        integer
        comfort_amount                                       Amount of data to send in a transmission for client comforting (1 - 10240 bytes).
        integer
        comfort_interval                                     Period of time between start, or last transmission, and the next client comfort transmission of data (1 - 900 sec).
        integer
        fortinet_bar                   Choices:
        string                         • enable              Enable/disable Fortinet bar on HTML content.
                                       • disable
        fortinet_bar_port                                    Port for use by Fortinet Bar (1 - 65535).
        integer
        http_policy                    Choices:
        string                         • disable             Enable/disable HTTP policy check.
                                       • enable
        inspect_all                    Choices:
        string                         • enable              Enable/disable the inspection of all ports for the protocol.
                                       • disable
                                       Choices:
        options                        • clientcomfort
        string                         • servercomfort       One or more options that can be applied to the session.
                                       • oversize
                                       • chunkedbypass
        oversize_limit                                       Maximum in-memory file size that can be scanned (1 - 383 MB).
        integer
        ports                                                Ports to scan for content (1 - 65535).
        integer
                                       Choices:
                                       • jisx0201
                                       • jisx0208
                                       • jisx0212
                                       • gb2312
                                       • ksc5601-ex
                                       • euc-jp
                                       • sjis
                                       • iso2022-jp
                                       • iso2022-jp-1
        post_lang                      • iso2022-jp-2        ID codes for character sets to be used to convert to UTF-8 for banned words and DLP on HTTP posts (maximum of 5 character sets).
        string                         • euc-cn
                                       • ces-gbk
                                       • hz
                                       • ces-big5
                                       • euc-kr
                                       • iso2022-jp-3
                                       • iso8859-1
                                       • tis620
                                       • cp874
                                       • cp1252
                                       • cp1251
        range_block                    Choices:
        string                         • disable             Enable/disable blocking of partial downloads.
                                       • enable
        retry_count                                          Number of attempts to retry HTTP connection (0 - 100).
        integer
        scan_bzip2                     Choices:
        string                         • enable              Enable/disable scanning of BZip2 compressed files.
                                       • disable
        status                         Choices:
        string                         • enable              Enable/disable the active status of scanning for this protocol.
                                       • disable
        streaming_content_bypass       Choices:
        string                         • enable              Enable/disable bypassing of streaming content from buffering.
                                       • disable
        strip_x_forwarded_for          Choices:
        string                         • disable             Enable/disable stripping of HTTP X-Forwarded-For header.
                                       • enable
        switching_protocols            Choices:
        string                         • bypass              Bypass from scanning, or block a connection that attempts to switch protocol.
                                       • block
        uncompressed_nest_limit                              Maximum nested levels of compression that can be uncompressed and scanned (2 - 100).
        integer
        uncompressed_oversize_limit                          Maximum in-memory uncompressed file size that can be scanned (0 - 383 MB, 0 = unlimited).
        integer
      imap                                                   Configure IMAP protocol options.
      dictionary
        inspect_all                    Choices:
        string                         • enable              Enable/disable the inspection of all ports for the protocol.
                                       • disable
        options                        Choices:
        string                         • fragmail            One or more options that can be applied to the session.
                                       • oversize
        oversize_limit                                       Maximum in-memory file size that can be scanned (1 - 383 MB).
        integer
        ports                                                Ports to scan for content (1 - 65535).
        integer
        scan_bzip2                     Choices:
        string                         • enable              Enable/disable scanning of BZip2 compressed files.
                                       • disable
        status                         Choices:
        string                         • enable              Enable/disable the active status of scanning for this protocol.
                                       • disable
        uncompressed_nest_limit                              Maximum nested levels of compression that can be uncompressed and scanned (2 - 100).
        integer
        uncompressed_oversize_limit                          Maximum in-memory uncompressed file size that can be scanned (0 - 383 MB, 0 = unlimited).
        integer
      mail_signature                                         Configure Mail signature.
      dictionary
        signature                                            Email signature to be added to outgoing email (if the signature contains spaces, enclose with quotation marks).
        string
        status                         Choices:
        string                         • disable             Enable/disable adding an email signature to SMTP email messages as they pass through the FortiGate.
                                       • enable
      mapi                                                   Configure MAPI protocol options.
      dictionary
        options                        Choices:
        string                         • fragmail            One or more options that can be applied to the session.
                                       • oversize
        oversize_limit                                       Maximum in-memory file size that can be scanned (1 - 383 MB).
        integer
        ports                                                Ports to scan for content (1 - 65535).
        integer
        scan_bzip2                     Choices:
        string                         • enable              Enable/disable scanning of BZip2 compressed files.
                                       • disable
        status                         Choices:
        string                         • enable              Enable/disable the active status of scanning for this protocol.
                                       • disable
        uncompressed_nest_limit                              Maximum nested levels of compression that can be uncompressed and scanned (2 - 100).
        integer
        uncompressed_oversize_limit                          Maximum in-memory uncompressed file size that can be scanned (0 - 383 MB, 0 = unlimited).
        integer
      name                                                   Name.
      string / required
      nntp                                                   Configure NNTP protocol options.
      dictionary
        inspect_all                    Choices:
        string                         • enable              Enable/disable the inspection of all ports for the protocol.
                                       • disable
        options                        Choices:
        string                         • oversize            One or more options that can be applied to the session.
                                       • splice
        oversize_limit                                       Maximum in-memory file size that can be scanned (1 - 383 MB).
        integer
        ports                                                Ports to scan for content (1 - 65535).
        integer
        scan_bzip2                     Choices:
        string                         • enable              Enable/disable scanning of BZip2 compressed files.
                                       • disable
        status                         Choices:
        string                         • enable              Enable/disable the active status of scanning for this protocol.
                                       • disable
        uncompressed_nest_limit                              Maximum nested levels of compression that can be uncompressed and scanned (2 - 100).
        integer
        uncompressed_oversize_limit                          Maximum in-memory uncompressed file size that can be scanned (0 - 383 MB, 0 = unlimited).
        integer
      oversize_log                     Choices:
      string                           • disable             Enable/disable logging for antivirus oversize file blocking.
                                       • enable
      pop3                                                   Configure POP3 protocol options.
      dictionary
        inspect_all                    Choices:
        string                         • enable              Enable/disable the inspection of all ports for the protocol.
                                       • disable
        options                        Choices:
        string                         • fragmail            One or more options that can be applied to the session.
                                       • oversize
        oversize_limit                                       Maximum in-memory file size that can be scanned (1 - 383 MB).
        integer
        ports                                                Ports to scan for content (1 - 65535).
        integer
        scan_bzip2                     Choices:
        string                         • enable              Enable/disable scanning of BZip2 compressed files.
                                       • disable
        status                         Choices:
        string                         • enable              Enable/disable the active status of scanning for this protocol.
                                       • disable
        uncompressed_nest_limit                              Maximum nested levels of compression that can be uncompressed and scanned (2 - 100).
        integer
        uncompressed_oversize_limit                          Maximum in-memory uncompressed file size that can be scanned (0 - 383 MB, 0 = unlimited).
        integer
      replacemsg_group                                       Name of the replacement message group to be used Source system.replacemsg-group.name.
      string
      rpc_over_http                    Choices:
      string                           • enable              Enable/disable inspection of RPC over HTTP.
                                       • disable
      smtp                                                   Configure SMTP protocol options.
      dictionary
        inspect_all                    Choices:
        string                         • enable              Enable/disable the inspection of all ports for the protocol.
                                       • disable
                                       Choices:
        options                        • fragmail            One or more options that can be applied to the session.
        string                         • oversize
                                       • splice
        oversize_limit                                       Maximum in-memory file size that can be scanned (1 - 383 MB).
        integer
        ports                                                Ports to scan for content (1 - 65535).
        integer
        scan_bzip2                     Choices:
        string                         • enable              Enable/disable scanning of BZip2 compressed files.
                                       • disable
        server_busy                    Choices:
        string                         • enable              Enable/disable SMTP server busy when server not available.
                                       • disable
        status                         Choices:
        string                         • enable              Enable/disable the active status of scanning for this protocol.
                                       • disable
        uncompressed_nest_limit                              Maximum nested levels of compression that can be uncompressed and scanned (2 - 100).
        integer
        uncompressed_oversize_limit                          Maximum in-memory uncompressed file size that can be scanned (0 - 383 MB, 0 = unlimited).
        integer
                                                             Deprecated
                                       Choices:              Starting with Ansible 2.9 we recommend using the top-level 'state' parameter.
      state                            • present
      string                           • absent              ════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                                             Indicates whether to create or remove the object.
      switching_protocols_log          Choices:
      string                           • disable             Enable/disable logging for HTTP/HTTPS switching protocols.
                                       • enable
   host                                                      FortiOS or FortiGate IP address.
   string
   https                               Choices:
   boolean                             • no                  Indicates if the requests towards FortiGate must use HTTPS protocol.
                                       • yes ←
   password                          Default:                FortiOS or FortiGate password.
   string                            ""
   ssl_verify                          Choices:
   boolean                             • no                  Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                        • yes ←
   state                               Choices:              Indicates whether to create or remove the object. This attribute was present already in previous version in a deeper level. It has been
   string                              • present             moved out to this outer level.
   added in 2.9                        • absent
   username                                                  FortiOS or FortiGate username.
   string
   vdom                              Default:                Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a
   string                            "root"                  different unit.

NOTES                   *fortios_firewall_profile_protocol_options-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_firewall_profile_protocol_options-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Configure protocol options.
     fortios_firewall_profile_protocol_options:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       state: "present"
       firewall_profile_protocol_options:
         comment: "Optional comments."
         dns:
             ports: "5"
             status: "enable"
         ftp:
             comfort_amount: "8"
             comfort_interval: "9"
             inspect_all: "enable"
             options: "clientcomfort"
             oversize_limit: "12"
             ports: "13"
             scan_bzip2: "enable"
             status: "enable"
             uncompressed_nest_limit: "16"
             uncompressed_oversize_limit: "17"
         http:
             block_page_status_code: "19"
             comfort_amount: "20"
             comfort_interval: "21"
             fortinet_bar: "enable"
             fortinet_bar_port: "23"
             http_policy: "disable"
             inspect_all: "enable"
             options: "clientcomfort"
             oversize_limit: "27"
             ports: "28"
             post_lang: "jisx0201"
             range_block: "disable"
             retry_count: "31"
             scan_bzip2: "enable"
             status: "enable"
             streaming_content_bypass: "enable"
             strip_x_forwarded_for: "disable"
             switching_protocols: "bypass"
             uncompressed_nest_limit: "37"
             uncompressed_oversize_limit: "38"
         imap:
             inspect_all: "enable"
             options: "fragmail"
             oversize_limit: "42"
             ports: "43"
             scan_bzip2: "enable"
             status: "enable"
             uncompressed_nest_limit: "46"
             uncompressed_oversize_limit: "47"
         mail_signature:
             signature: "<your_own_value>"
             status: "disable"
         mapi:
             options: "fragmail"
             oversize_limit: "53"
             ports: "54"
             scan_bzip2: "enable"
             status: "enable"
             uncompressed_nest_limit: "57"
             uncompressed_oversize_limit: "58"
         name: "default_name_59"
         nntp:
             inspect_all: "enable"
             options: "oversize"
             oversize_limit: "63"
             ports: "64"
             scan_bzip2: "enable"
             status: "enable"
             uncompressed_nest_limit: "67"
             uncompressed_oversize_limit: "68"
         oversize_log: "disable"
         pop3:
             inspect_all: "enable"
             options: "fragmail"
             oversize_limit: "73"
             ports: "74"
             scan_bzip2: "enable"
             status: "enable"
             uncompressed_nest_limit: "77"
             uncompressed_oversize_limit: "78"
         replacemsg_group: "<your_own_value> (source system.replacemsg-group.name)"
         rpc_over_http: "enable"
         smtp:
             inspect_all: "enable"
             options: "fragmail"
             oversize_limit: "84"
             ports: "85"
             scan_bzip2: "enable"
             server_busy: "enable"
             status: "enable"
             uncompressed_nest_limit: "89"
             uncompressed_oversize_limit: "90"
         switching_protocols_log: "disable"

RETURN VALUES                   *fortios_firewall_profile_protocol_options-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_firewall_profile_protocol_options-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_firewall_profile_protocol_options-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_firewall_profile_protocol_options_module.html

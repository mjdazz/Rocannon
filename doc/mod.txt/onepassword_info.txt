SYNOPSIS                   *onepassword_info*

     • onepassword_info wraps the op command line utility to fetch data about one or more 1Password items.
     • A fatal error occurs if any of the items being searched for can not be found.
     • Recommend using with the no_log option to avoid logging the values of the secrets being retrieved.
     • This module was called onepassword_facts before Ansible 2.9, returning ansible_facts. Note that the onepassword_info module no longer returns ansible_facts! You must now use the register
       option to use the facts in other tasks.

   Aliases: onepassword_facts

REQUIREMENTS                   *onepassword_info-requirements*

   The below requirements are needed on the host that executes this module.

     • op 1Password command line utility. See https://support.1password.com/command-line/

PARAMETERS                   *onepassword_info-parameters*

      Parameter     Choices/Defaults                                                                             Comments
                                     A dictionary containing authentication details. If this is set, onepassword_info will attempt to sign in to 1Password automatically.
   auto_login       Default:         Without this option, you must have already logged in via the 1Password CLI before running Ansible.
   dictionary       {}               It is highly recommended to store 1Password credentials in an Ansible Vault. Ensure that the key used to encrypt the Ansible Vault is equal to or greater in
                                     strength than the 1Password master password.
    master_password                  The master password for your subdomain.
    string /                         This is always required when specifying auto_login.
    required
    secret_key                       The secret key for your subdomain.
    string                           Only required for initial sign in.
    subdomain                        1Password subdomain name (<subdomain>.1password.com).
    string                           If this is not specified, the most recent subdomain will be used.
    username                         1Password username.
    string                           Only required for initial sign in.
   cli_path         Default:         Used to specify the exact path to the op command line interface
   path             "op"
                                     A list of one or more search terms.
   search_terms                      Each search term can either be a simple string or it can be a dictionary for more control.
   list / required                   When passing a simple string, field is assumed to be password.
                                     When passing a dictionary, the following fields are available.
    field                            The name of the field to search for within this item (optional, defaults to "password" (or "document" if the item has an attachment).
    string
    name                             The name of the 1Password item to search for (required).
    string
    section                          The name of a section within this item containing the specified field (optional, will search all sections if not specified).
    string
    vault                            The name of the particular 1Password vault to search, useful if your 1Password user has access to multiple vaults (optional).
    string

NOTES                   *onepassword_info-notes*

   Note

     • Tested with op version 0.5.5
     • Based on the onepassword lookup plugin by Scott Buchanan <sbuchanan@ri.pn>.
     • When this module is called with the deprecated onepassword_facts name, potentially sensitive data from 1Password is returned as Ansible facts. Facts are subject to caching if enabled, which
       means this data could be stored in clear text on disk or in a database.

EXAMPLES                   *onepassword_info-examples*

 # Gather secrets from 1Password, assuming there is a 'password' field:
 - name: Get a password
   onepassword_info:
     search_terms: My 1Password item
   delegate_to: localhost
   register: my_1password_item
   no_log: true         # Don't want to log the secrets to the console!

 # Gather secrets from 1Password, with more advanced search terms:
 - name: Get a password
   onepassword_info:
     search_terms:
       - name:    My 1Password item
         field:   Custom field name       # optional, defaults to 'password'
         section: Custom section name     # optional, defaults to 'None'
         vault:   Name of the vault       # optional, only necessary if there is more than 1 Vault available
   delegate_to: localhost
   register: my_1password_item
   no_log: True                           # Don't want to log the secrets to the console!

 # Gather secrets combining simple and advanced search terms to retrieve two items, one of which we fetch two
 # fields. In the first 'password' is fetched, as a field name is not specified (default behaviour) and in the
 # second, 'Custom field name' is fetched, as that is specified explicitly.
 - name: Get a password
   onepassword_info:
     search_terms:
       - My 1Password item                # 'name' is optional when passing a simple string...
       - name: My Other 1Password item    # ...but it can also be set for consistency
       - name:    My 1Password item
         field:   Custom field name       # optional, defaults to 'password'
         section: Custom section name     # optional, defaults to 'None'
         vault:   Name of the vault       # optional, only necessary if there is more than 1 Vault available
       - name: A 1Password item with document attachment
   delegate_to: localhost
   register: my_1password_item
   no_log: true                           # Don't want to log the secrets to the console!

 - name: Debug a password (for example)
   debug:
     msg: "{{ my_1password_item['onepassword']['My 1Password item'] }}"

RETURN VALUES                   *onepassword_info-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
                        Dictionary of each 1password item matching the given search terms, shows what would be returned from the third example above.
   onepassword success  Sample:
   dictionary           {'My 1Password item': {'password': 'the value of this field', 'Custom field name': 'the value of this field'}, 'My Other 1Password item': {'password': 'the value of this
                        field'}, 'A 1Password item with document attachment': {'document': 'the contents of the document attached to this item'}}

STATUS                   *onepassword_info-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Ryan Conway (@Rylon)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *onepassword_info-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/onepassword_info_module.html

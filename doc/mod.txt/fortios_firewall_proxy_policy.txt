SYNOPSIS                   *fortios_firewall_proxy_policy*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify firewall feature and proxy_policy category. Examples include all parameters and
       values need to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_firewall_proxy_policy-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_firewall_proxy_policy-parameters*

           Parameter           Choices/Defaults                                                                        Comments
   firewall_proxy_policy      Default:            Configure proxy policies.
   dictionary                 null
                                Choices:
    action                      • accept          Accept or deny traffic matching the policy parameters.
    string                      • deny
                                • redirect
    application_list                              Name of an existing Application list. Source application.list.name.
    string
    av_profile                                    Name of an existing Antivirus profile. Source antivirus.profile.name.
    string
    comments                                      Optional comments.
    string
                                Choices:
    disclaimer                  • disable
    string                      • domain          Web proxy disclaimer setting: by domain, policy, or user.
                                • policy
                                • user
    dlp_sensor                                    Name of an existing DLP sensor. Source dlp.sensor.name.
    string
    dstaddr                                       Destination address objects.
    list
          name                                    Address name. Source firewall.address.name firewall.addrgrp.name firewall.proxy-address.name firewall.proxy-addrgrp.name firewall.vip.name
          string / required                       firewall.vipgrp.name firewall.vip46.name firewall.vipgrp46.name system.external-resource.name.
    dstaddr6                                      IPv6 destination address objects.
    list
          name                                    Address name. Source firewall.address6.name firewall.addrgrp6.name firewall.vip6.name firewall.vipgrp6.name firewall.vip64.name
          string / required                       firewall.vipgrp64.name system.external-resource.name.
    dstaddr_negate              Choices:
    string                      • enable          When enabled, destination addresses match against any address EXCEPT the specified destination addresses.
                                • disable
    dstintf                                       Destination interface names.
    list
          name                                    Interface name. Source system.interface.name system.zone.name.
          string / required
    global_label                                  Global web-based manager visible label.
    string
    groups                                        Names of group objects.
    list
          name                                    Group name. Source user.group.name.
          string / required
    http_tunnel_auth            Choices:
    string                      • enable          Enable/disable HTTP tunnel authentication.
                                • disable
    icap_profile                                  Name of an existing ICAP profile. Source icap.profile.name.
    string
    internet_service            Choices:
    string                      • enable          Enable/disable use of Internet Services for this policy. If enabled, destination address and service are not used.
                                • disable
    internet_service_custom                       Custom Internet Service name.
    list
          name                                    Custom name. Source firewall.internet-service-custom.name.
          string / required
    internet_service_id                           Internet Service ID.
    list
          id                                      Internet Service ID. Source firewall.internet-service.id.
          integer / required
    internet_service_negate     Choices:
    string                      • enable          When enabled, Internet Services match against any internet service EXCEPT the selected Internet Service.
                                • disable
    ips_sensor                                    Name of an existing IPS sensor. Source ips.sensor.name.
    string
    label                                         VDOM-specific GUI visible label.
    string
                                Choices:
    logtraffic                  • all             Enable/disable logging traffic through the policy.
    string                      • utm
                                • disable
    logtraffic_start            Choices:
    string                      • enable          Enable/disable policy log traffic start.
                                • disable
    policyid                                      Policy ID.
    integer / required
    poolname                                      Name of IP pool object.
    list
          name                                    IP pool name. Source firewall.ippool.name.
          string / required
    profile_group                                 Name of profile group. Source firewall.profile-group.name.
    string
    profile_protocol_options                      Name of an existing Protocol options profile. Source firewall.profile-protocol-options.name.
    string
    profile_type                Choices:
    string                      • single          Determine whether the firewall policy allows security profile groups or single profiles only.
                                • group
                                Choices:
                                • explicit-web
    proxy                       • transparent-web
    string                      • ftp             Type of explicit proxy.
                                • ssh
                                • ssh-tunnel
                                • wanopt
    redirect_url                                  Redirect URL for further explicit web proxy processing.
    string
    replacemsg_override_group                     Authentication replacement message override group. Source system.replacemsg-group.name.
    string
                                Choices:
    scan_botnet_connections     • disable         Enable/disable scanning of connections to Botnet servers.
    string                      • block
                                • monitor
    schedule                                      Name of schedule object. Source firewall.schedule.onetime.name firewall.schedule.recurring.name firewall.schedule.group.name.
    string
    service                                       Name of service objects.
    list
          name                                    Service name. Source firewall.service.custom.name firewall.service.group.name.
          string / required
    service_negate              Choices:
    string                      • enable          When enabled, services match against any service EXCEPT the specified destination services.
                                • disable
    session_ttl                                   TTL in seconds for sessions accepted by this policy (0 means use the system ).
    integer
    spamfilter_profile                            Name of an existing Spam filter profile. Source spamfilter.profile.name.
    string
    srcaddr                                       Source address objects.
    list
          name                                    Address name. Source firewall.address.name firewall.addrgrp.name firewall.proxy-address.name firewall.proxy-addrgrp.name system
          string / required                       .external-resource.name.
    srcaddr6                                      IPv6 source address objects.
    list
          name                                    Address name. Source firewall.address6.name firewall.addrgrp6.name system.external-resource.name.
          string / required
    srcaddr_negate              Choices:
    string                      • enable          When enabled, source addresses match against any address EXCEPT the specified source addresses.
                                • disable
    srcintf                                       Source interface names.
    list
          name                                    Interface name. Source system.interface.name system.zone.name.
          string / required
    ssh_filter_profile                            Name of an existing SSH filter profile. Source ssh-filter.profile.name.
    string
    ssl_ssh_profile                               Name of an existing SSL SSH profile. Source firewall.ssl-ssh-profile.name.
    string
                                                  Deprecated
                                Choices:          Starting with Ansible 2.9 we recommend using the top-level 'state' parameter.
    state                       • present
    string                      • absent          ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                                  Indicates whether to create or remove the object.
    status                      Choices:
    string                      • enable          Enable/disable the active status of the policy.
                                • disable
    transparent                 Choices:
    string                      • enable          Enable to use the IP address of the client to connect to the server.
                                • disable
    users                                         Names of user objects.
    list
          name                                    Group name. Source user.local.name.
          string / required
    utm_status                  Choices:
    string                      • enable          Enable the use of UTM profiles/sensors/lists.
                                • disable
    uuid                                          Universally Unique Identifier (UUID; automatically assigned but can be manually reset).
    string
    waf_profile                                   Name of an existing Web application firewall profile. Source waf.profile.name.
    string
    webcache                    Choices:
    string                      • enable          Enable/disable web caching.
                                • disable
    webcache_https              Choices:
    string                      • disable         Enable/disable web caching for HTTPS (Requires deep-inspection enabled in ssl-ssh-profile).
                                • enable
    webfilter_profile                             Name of an existing Web filter profile. Source webfilter.profile.name.
    string
    webproxy_forward_server                       Name of web proxy forward server. Source web-proxy.forward-server.name web-proxy.forward-server-group.name.
    string
    webproxy_profile                              Name of web proxy profile. Source web-proxy.profile.name.
    string
   host                                           FortiOS or FortiGate IP address.
   string
   https                        Choices:
   boolean                      • no              Indicates if the requests towards FortiGate must use HTTPS protocol.
                                • yes ←
   password                   Default:            FortiOS or FortiGate password.
   string                     ""
   ssl_verify                   Choices:
   boolean                      • no              Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9                 • yes ←
   state                        Choices:          Indicates whether to create or remove the object. This attribute was present already in previous version in a deeper level. It has been moved out
   string                       • present         to this outer level.
   added in 2.9                 • absent
   username                                       FortiOS or FortiGate username.
   string
   vdom                       Default:            Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different unit.
   string                     "root"

NOTES                   *fortios_firewall_proxy_policy-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_firewall_proxy_policy-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Configure proxy policies.
     fortios_firewall_proxy_policy:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       state: "present"
       firewall_proxy_policy:
         action: "accept"
         application_list: "<your_own_value> (source application.list.name)"
         av_profile: "<your_own_value> (source antivirus.profile.name)"
         comments: "<your_own_value>"
         disclaimer: "disable"
         dlp_sensor: "<your_own_value> (source dlp.sensor.name)"
         dstaddr:
          -
             name: "default_name_10 (source firewall.address.name firewall.addrgrp.name firewall.proxy-address.name firewall.proxy-addrgrp.name firewall.vip
               .name firewall.vipgrp.name firewall.vip46.name firewall.vipgrp46.name system.external-resource.name)"
         dstaddr_negate: "enable"
         dstaddr6:
          -
             name: "default_name_13 (source firewall.address6.name firewall.addrgrp6.name firewall.vip6.name firewall.vipgrp6.name firewall.vip64.name firewall
               .vipgrp64.name system.external-resource.name)"
         dstintf:
          -
             name: "default_name_15 (source system.interface.name system.zone.name)"
         global_label: "<your_own_value>"
         groups:
          -
             name: "default_name_18 (source user.group.name)"
         http_tunnel_auth: "enable"
         icap_profile: "<your_own_value> (source icap.profile.name)"
         internet_service: "enable"
         internet_service_custom:
          -
             name: "default_name_23 (source firewall.internet-service-custom.name)"
         internet_service_id:
          -
             id:  "25 (source firewall.internet-service.id)"
         internet_service_negate: "enable"
         ips_sensor: "<your_own_value> (source ips.sensor.name)"
         label: "<your_own_value>"
         logtraffic: "all"
         logtraffic_start: "enable"
         policyid: "31"
         poolname:
          -
             name: "default_name_33 (source firewall.ippool.name)"
         profile_group: "<your_own_value> (source firewall.profile-group.name)"
         profile_protocol_options: "<your_own_value> (source firewall.profile-protocol-options.name)"
         profile_type: "single"
         proxy: "explicit-web"
         redirect_url: "<your_own_value>"
         replacemsg_override_group: "<your_own_value> (source system.replacemsg-group.name)"
         scan_botnet_connections: "disable"
         schedule: "<your_own_value> (source firewall.schedule.onetime.name firewall.schedule.recurring.name firewall.schedule.group.name)"
         service:
          -
             name: "default_name_43 (source firewall.service.custom.name firewall.service.group.name)"
         service_negate: "enable"
         session_ttl: "45"
         spamfilter_profile: "<your_own_value> (source spamfilter.profile.name)"
         srcaddr:
          -
             name: "default_name_48 (source firewall.address.name firewall.addrgrp.name firewall.proxy-address.name firewall.proxy-addrgrp.name system
               .external-resource.name)"
         srcaddr_negate: "enable"
         srcaddr6:
          -
             name: "default_name_51 (source firewall.address6.name firewall.addrgrp6.name system.external-resource.name)"
         srcintf:
          -
             name: "default_name_53 (source system.interface.name system.zone.name)"
         ssh_filter_profile: "<your_own_value> (source ssh-filter.profile.name)"
         ssl_ssh_profile: "<your_own_value> (source firewall.ssl-ssh-profile.name)"
         status: "enable"
         transparent: "enable"
         users:
          -
             name: "default_name_59 (source user.local.name)"
         utm_status: "enable"
         uuid: "<your_own_value>"
         waf_profile: "<your_own_value> (source waf.profile.name)"
         webcache: "enable"
         webcache_https: "disable"
         webfilter_profile: "<your_own_value> (source webfilter.profile.name)"
         webproxy_forward_server: "<your_own_value> (source web-proxy.forward-server.name web-proxy.forward-server-group.name)"
         webproxy_profile: "<your_own_value> (source web-proxy.profile.name)"

RETURN VALUES                   *fortios_firewall_proxy_policy-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_firewall_proxy_policy-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_firewall_proxy_policy-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_firewall_proxy_policy_module.html

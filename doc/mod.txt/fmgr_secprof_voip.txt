SYNOPSIS                   *fmgr_secprof_voip*

     • Manage VOIP security profiles in FortiManager via API

PARAMETERS                   *fmgr_secprof_voip-parameters*

                  Parameter                 Choices/Defaults                                                                 Comments
   adom                                     Default:         The ADOM the configuration should belong to.
   -                                        "root"
   comment                                                   Comment.
   -
                                              Choices:
   mode                                       • add ←        Sets one of three modes for managing the object.
   -                                          • set          Allows use of soft-adds instead of overwriting existing values
                                              • delete
                                              • update
   name                                                      Profile name.
   -
                                                             EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                             List of multiple child objects to be added. Expects a list of dictionaries.
   sccp                                                      Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                         If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                             This object is MUTUALLY EXCLUSIVE with its options.
                                                             We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                             WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   sccp_block_mcast                           Choices:       Enable/disable block multicast RTP connections.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sccp_log_call_summary                      Choices:       Enable/disable log summary of SCCP calls.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sccp_log_violations                        Choices:       Enable/disable logging of SCCP violations.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sccp_max_calls                                            Maximum calls per minute per SCCP client (max 65535).
   -
   sccp_status                                Choices:       Enable/disable SCCP.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sccp_verify_header                         Choices:       Enable/disable verify SCCP header content.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
                                                             EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                             List of multiple child objects to be added. Expects a list of dictionaries.
   sip                                                       Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                         If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                             This object is MUTUALLY EXCLUSIVE with its options.
                                                             We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                             WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   sip_ack_rate                                              ACK request rate limit (per second, per policy).
   -
   sip_block_ack                              Choices:       Enable/disable block ACK requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_bye                              Choices:       Enable/disable block BYE requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_cancel                           Choices:       Enable/disable block CANCEL requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_geo_red_options                  Choices:       Enable/disable block OPTIONS requests, but OPTIONS requests still notify for redundancy.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_info                             Choices:       Enable/disable block INFO requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_invite                           Choices:       Enable/disable block INVITE requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_long_lines                       Choices:       Enable/disable block requests with headers exceeding max-line-length.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_message                          Choices:       Enable/disable block MESSAGE requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_notify                           Choices:       Enable/disable block NOTIFY requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_options                          Choices:       Enable/disable block OPTIONS requests and no OPTIONS as notifying message for redundancy either.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_prack                            Choices:       Enable/disable block prack requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_publish                          Choices:       Enable/disable block PUBLISH requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_refer                            Choices:       Enable/disable block REFER requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_register                         Choices:       Enable/disable block REGISTER requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_subscribe                        Choices:       Enable/disable block SUBSCRIBE requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_unknown                          Choices:       Block unrecognized SIP requests (enabled by default).
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_block_update                           Choices:       Enable/disable block UPDATE requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_bye_rate                                              BYE request rate limit (per second, per policy).
   -
   sip_call_keepalive                                        Continue tracking calls with no RTP for this many minutes.
   -
   sip_cancel_rate                                           CANCEL request rate limit (per second, per policy).
   -
   sip_contact_fixup                          Choices:       Fixup contact anyway even if contact's IP|port doesn't match session's IP|port.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_hnt_restrict_source_ip                 Choices:       Enable/disable restrict RTP source IP to be the same as SIP source IP when HNT is enabled.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_hosted_nat_traversal                   Choices:       Hosted NAT Traversal (HNT).
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_info_rate                                             INFO request rate limit (per second, per policy).
   -
   sip_invite_rate                                           INVITE request rate limit (per second, per policy).
   -
   sip_ips_rtp                                Choices:       Enable/disable allow IPS on RTP.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_log_call_summary                       Choices:       Enable/disable logging of SIP call summary.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_log_violations                         Choices:       Enable/disable logging of SIP violations.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
                                              Choices:       Action for malformed Allow header.
   sip_malformed_header_allow                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed Call-ID header.
   sip_malformed_header_call_id               • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed Contact header.
   sip_malformed_header_contact               • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed Content-Length header.
   sip_malformed_header_content_length        • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed Content-Type header.
   sip_malformed_header_content_type          • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed CSeq header.
   sip_malformed_header_cseq                  • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed Expires header.
   sip_malformed_header_expires               • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed From header.
   sip_malformed_header_from                  • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed Max-Forwards header.
   sip_malformed_header_max_forwards          • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed P-Asserted-Identity header.
   sip_malformed_header_p_asserted_identity   • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed RAck header.
   sip_malformed_header_rack                  • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed Record-Route header.
   sip_malformed_header_record_route          • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed Route header.
   sip_malformed_header_route                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed RSeq header.
   sip_malformed_header_rseq                  • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP a line.
   sip_malformed_header_sdp_a                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP b line.
   sip_malformed_header_sdp_b                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP c line.
   sip_malformed_header_sdp_c                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP i line.
   sip_malformed_header_sdp_i                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP k line.
   sip_malformed_header_sdp_k                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP m line.
   sip_malformed_header_sdp_m                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP o line.
   sip_malformed_header_sdp_o                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP r line.
   sip_malformed_header_sdp_r                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP s line.
   sip_malformed_header_sdp_s                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP t line.
   sip_malformed_header_sdp_t                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP v line.
   sip_malformed_header_sdp_v                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed SDP z line.
   sip_malformed_header_sdp_z                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed To header.
   sip_malformed_header_to                    • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed VIA header.
   sip_malformed_header_via                   • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
                                              Choices:       Action for malformed request line.
   sip_malformed_request_line                 • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
   sip_max_body_length                                       Maximum SIP message body length (0 meaning no limit).
   -
   sip_max_dialogs                                           Maximum number of concurrent calls/dialogs (per policy).
   -
   sip_max_idle_dialogs                                      Maximum number established but idle dialogs to retain (per policy).
   -
   sip_max_line_length                                       Maximum SIP header line length (78-4096).
   -
   sip_message_rate                                          MESSAGE request rate limit (per second, per policy).
   -
   sip_nat_trace                              Choices:       Enable/disable preservation of original IP in SDP i line.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_no_sdp_fixup                           Choices:       Enable/disable no SDP fix-up.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_notify_rate                                           NOTIFY request rate limit (per second, per policy).
   -
   sip_open_contact_pinhole                   Choices:       Enable/disable open pinhole for non-REGISTER Contact port.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_open_record_route_pinhole              Choices:       Enable/disable open pinhole for Record-Route port.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_open_register_pinhole                  Choices:       Enable/disable open pinhole for REGISTER Contact port.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_open_via_pinhole                       Choices:       Enable/disable open pinhole for Via port.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_options_rate                                          OPTIONS request rate limit (per second, per policy).
   -
   sip_prack_rate                                            PRACK request rate limit (per second, per policy).
   -
   sip_preserve_override                      Choices:       Override i line to preserve original IPS (default| append).
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_provisional_invite_expiry_time                        Expiry time for provisional INVITE (10 - 3600 sec).
   -
   sip_publish_rate                                          PUBLISH request rate limit (per second, per policy).
   -
   sip_refer_rate                                            REFER request rate limit (per second, per policy).
   -
   sip_register_contact_trace                 Choices:       Enable/disable trace original IP/port within the contact header of REGISTER requests.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_register_rate                                         REGISTER request rate limit (per second, per policy).
   -
   sip_rfc2543_branch                         Choices:       Enable/disable support via branch compliant with RFC 2543.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_rtp                                    Choices:       Enable/disable create pinholes for RTP traffic to traverse firewall.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
                                              Choices:       Relative strength of encryption algorithms accepted in negotiation.
   sip_ssl_algorithm                          • high         choice | high | High encryption. Allow only AES and ChaCha.
   -                                          • medium       choice | medium | Medium encryption. Allow AES, ChaCha, 3DES, and RC4.
                                              • low          choice | low | Low encryption. Allow AES, ChaCha, 3DES, RC4, and DES.
   sip_ssl_auth_client                                       Require a client certificate and authenticate it with the peer/peergrp.
   -
   sip_ssl_auth_server                                       Authenticate the server's certificate with the peer/peergrp.
   -
   sip_ssl_client_certificate                                Name of Certificate to offer to server if requested.
   -
                                              Choices:       Allow/block client renegotiation by server.
   sip_ssl_client_renegotiation               • allow        choice | allow | Allow a SSL client to renegotiate.
   -                                          • deny         choice | deny | Abort any SSL connection that attempts to renegotiate.
                                              • secure       choice | secure | Reject any SSL connection that does not offer a RFC 5746 Secure Renegotiation Indication.
                                              Choices:       Highest SSL/TLS version to negotiate.
   sip_ssl_max_version                        • ssl-3.0      choice | ssl-3.0 | SSL 3.0.
   -                                          • tls-1.0      choice | tls-1.0 | TLS 1.0.
                                              • tls-1.1      choice | tls-1.1 | TLS 1.1.
                                              • tls-1.2      choice | tls-1.2 | TLS 1.2.
                                              Choices:       Lowest SSL/TLS version to negotiate.
   sip_ssl_min_version                        • ssl-3.0      choice | ssl-3.0 | SSL 3.0.
   -                                          • tls-1.0      choice | tls-1.0 | TLS 1.0.
                                              • tls-1.1      choice | tls-1.1 | TLS 1.1.
                                              • tls-1.2      choice | tls-1.2 | TLS 1.2.
   sip_ssl_mode                               Choices:       SSL/TLS mode for encryption &amp; decryption of traffic.
   -                                          • off          choice | off | No SSL.
                                              • full         choice | full | Client to FortiGate and FortiGate to Server SSL.
                                              Choices:       SSL Perfect Forward Secrecy.
   sip_ssl_pfs                                • require      choice | require | PFS mandatory.
   -                                          • deny         choice | deny | PFS rejected.
                                              • allow        choice | allow | PFS allowed.
   sip_ssl_send_empty_frags                   Choices:       Send empty fragments to avoid attack on CBC IV (SSL 3.0 &amp; TLS 1.0 only).
   -                                          • disable      choice | disable | Do not send empty fragments.
                                              • enable       choice | enable | Send empty fragments.
   sip_ssl_server_certificate                                Name of Certificate return to the client in every SSL connection.
   -
   sip_status                                 Choices:       Enable/disable SIP.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_strict_register                        Choices:       Enable/disable only allow the registrar to connect.
   -                                          • disable      choice | disable | Disable status.
                                              • enable       choice | enable | Enable status.
   sip_subscribe_rate                                        SUBSCRIBE request rate limit (per second, per policy).
   -
                                              Choices:       Action for unknown SIP header.
   sip_unknown_header                         • pass         choice | pass | Bypass malformed messages.
   -                                          • discard      choice | discard | Discard malformed messages.
                                              • respond      choice | respond | Respond with error code.
   sip_update_rate                                           UPDATE request rate limit (per second, per policy).
   -

NOTES                   *fmgr_secprof_voip-notes*

   Note

     • Full Documentation at https://ftnt-ansible-docs.readthedocs.io/en/latest/.

EXAMPLES                   *fmgr_secprof_voip-examples*

 - name: DELETE Profile
   fmgr_secprof_voip:
     name: "Ansible_VOIP_Profile"
     mode: "delete"

 - name: Create FMGR_VOIP_PROFILE
   fmgr_secprof_voip:
     mode: "set"
     adom: "root"
     name: "Ansible_VOIP_Profile"
     comment: "Created by Ansible"
     sccp: {block-mcast: "enable", log-call-summary: "enable", log-violations: "enable", status: "enable"}

RETURN VALUES                   *fmgr_secprof_voip-return values*

   Common return values are documented here, the following are the fields unique to this module:

      Key     Returned                                                                                  Description
   api_result always   full API response, includes status code and message
   string

STATUS                   *fmgr_secprof_voip-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Luke Weighall (@lweighall)
     • Andrew Welsh (@Ghilli3)
     • Jim Huber (@p4r4n0y1ng)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fmgr_secprof_voip-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fmgr_secprof_voip_module.html

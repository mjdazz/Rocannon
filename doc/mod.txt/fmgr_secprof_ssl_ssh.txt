SYNOPSIS                   *fmgr_secprof_ssl_ssh*

     • Manage SSL and SSH security profiles in FortiManager via the FMG API

PARAMETERS                   *fmgr_secprof_ssl_ssh-parameters*

                  Parameter                       Choices/Defaults                                                                 Comments
   adom                                     Default:                     The ADOM the configuration should belong to.
   -                                        "root"
   caname                                                                CA certificate used by SSL Inspection.
   -
   comment                                                               Optional comments.
   -
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   ftps                                                                  Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   ftps_allow_invalid_server_cert             Choices:                   When enabled, allows SSL sessions whose server certificate validation failed.
   -                                          • disable                  choice | disable | Disable setting.
                                              • enable                   choice | enable | Enable setting.
                                              Choices:                   Action based on client certificate request failure.
   ftps_client_cert_request                   • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
   ftps_ports                                                            Ports to use for scanning (1 - 65535, default = 443).
   -
   ftps_status                                Choices:                   Configure protocol inspection status.
   -                                          • disable                  choice | disable | Disable.
                                              • deep-inspection          choice | deep-inspection | Full SSL inspection.
                                              Choices:                   Action based on the SSL encryption used being unsupported.
   ftps_unsupported_ssl                       • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Allow, ignore, or block the untrusted SSL session server certificate.
   ftps_untrusted_cert                        • allow                    choice | allow | Allow the untrusted server certificate.
   -                                          • block                    choice | block | Block the connection when an untrusted server certificate is detected.
                                              • ignore                   choice | ignore | Always take the server certificate as trusted.
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   https                                                                 Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   https_allow_invalid_server_cert            Choices:                   When enabled, allows SSL sessions whose server certificate validation failed.
   -                                          • disable                  choice | disable | Disable setting.
                                              • enable                   choice | enable | Enable setting.
                                              Choices:                   Action based on client certificate request failure.
   https_client_cert_request                  • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
   https_ports                                                           Ports to use for scanning (1 - 65535, default = 443).
   -
                                              Choices:                   Configure protocol inspection status.
   https_status                               • disable                  choice | disable | Disable.
   -                                          • certificate-inspection   choice | certificate-inspection | Inspect SSL handshake only.
                                              • deep-inspection          choice | deep-inspection | Full SSL inspection.
                                              Choices:                   Action based on the SSL encryption used being unsupported.
   https_unsupported_ssl                      • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Allow, ignore, or block the untrusted SSL session server certificate.
   https_untrusted_cert                       • allow                    choice | allow | Allow the untrusted server certificate.
   -                                          • block                    choice | block | Block the connection when an untrusted server certificate is detected.
                                              • ignore                   choice | ignore | Always take the server certificate as trusted.
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   imaps                                                                 Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   imaps_allow_invalid_server_cert            Choices:                   When enabled, allows SSL sessions whose server certificate validation failed.
   -                                          • disable                  choice | disable | Disable setting.
                                              • enable                   choice | enable | Enable setting.
                                              Choices:                   Action based on client certificate request failure.
   imaps_client_cert_request                  • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
   imaps_ports                                                           Ports to use for scanning (1 - 65535, default = 443).
   -
   imaps_status                               Choices:                   Configure protocol inspection status.
   -                                          • disable                  choice | disable | Disable.
                                              • deep-inspection          choice | deep-inspection | Full SSL inspection.
                                              Choices:                   Action based on the SSL encryption used being unsupported.
   imaps_unsupported_ssl                      • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Allow, ignore, or block the untrusted SSL session server certificate.
   imaps_untrusted_cert                       • allow                    choice | allow | Allow the untrusted server certificate.
   -                                          • block                    choice | block | Block the connection when an untrusted server certificate is detected.
                                              • ignore                   choice | ignore | Always take the server certificate as trusted.
   mapi_over_https                            Choices:                   Enable/disable inspection of MAPI over HTTPS.
   -                                          • disable                  choice | disable | Disable inspection of MAPI over HTTPS.
                                              • enable                   choice | enable | Enable inspection of MAPI over HTTPS.
                                              Choices:
   mode                                       • add ←                    Sets one of three modes for managing the object.
   -                                          • set                      Allows use of soft-adds instead of overwriting existing values
                                              • delete
                                              • update
   name                                                                  Name.
   -
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   pop3s                                                                 Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   pop3s_allow_invalid_server_cert            Choices:                   When enabled, allows SSL sessions whose server certificate validation failed.
   -                                          • disable                  choice | disable | Disable setting.
                                              • enable                   choice | enable | Enable setting.
                                              Choices:                   Action based on client certificate request failure.
   pop3s_client_cert_request                  • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
   pop3s_ports                                                           Ports to use for scanning (1 - 65535, default = 443).
   -
   pop3s_status                               Choices:                   Configure protocol inspection status.
   -                                          • disable                  choice | disable | Disable.
                                              • deep-inspection          choice | deep-inspection | Full SSL inspection.
                                              Choices:                   Action based on the SSL encryption used being unsupported.
   pop3s_unsupported_ssl                      • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Allow, ignore, or block the untrusted SSL session server certificate.
   pop3s_untrusted_cert                       • allow                    choice | allow | Allow the untrusted server certificate.
   -                                          • block                    choice | block | Block the connection when an untrusted server certificate is detected.
                                              • ignore                   choice | ignore | Always take the server certificate as trusted.
   rpc_over_https                             Choices:                   Enable/disable inspection of RPC over HTTPS.
   -                                          • disable                  choice | disable | Disable inspection of RPC over HTTPS.
                                              • enable                   choice | enable | Enable inspection of RPC over HTTPS.
   server_cert                                                           Certificate used by SSL Inspection to replace server certificate.
   -
   server_cert_mode                           Choices:                   Re-sign or replace the server's certificate.
   -                                          • re-sign                  choice | re-sign | Multiple clients connecting to multiple servers.
                                              • replace                  choice | replace | Protect an SSL server.
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   smtps                                                                 Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   smtps_allow_invalid_server_cert            Choices:                   When enabled, allows SSL sessions whose server certificate validation failed.
   -                                          • disable                  choice | disable | Disable setting.
                                              • enable                   choice | enable | Enable setting.
                                              Choices:                   Action based on client certificate request failure.
   smtps_client_cert_request                  • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
   smtps_ports                                                           Ports to use for scanning (1 - 65535, default = 443).
   -
   smtps_status                               Choices:                   Configure protocol inspection status.
   -                                          • disable                  choice | disable | Disable.
                                              • deep-inspection          choice | deep-inspection | Full SSL inspection.
                                              Choices:                   Action based on the SSL encryption used being unsupported.
   smtps_unsupported_ssl                      • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Allow, ignore, or block the untrusted SSL session server certificate.
   smtps_untrusted_cert                       • allow                    choice | allow | Allow the untrusted server certificate.
   -                                          • block                    choice | block | Block the connection when an untrusted server certificate is detected.
                                              • ignore                   choice | ignore | Always take the server certificate as trusted.
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   ssh                                                                   Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   ssh_inspect_all                            Choices:                   Level of SSL inspection.
   -                                          • disable                  choice | disable | Disable.
                                              • deep-inspection          choice | deep-inspection | Full SSL inspection.
   ssh_ports                                                             Ports to use for scanning (1 - 65535, default = 443).
   -
   ssh_ssh_algorithm                          Choices:                   Relative strength of encryption algorithms accepted during negotiation.
   -                                          • compatible               choice | compatible | Allow a broader set of encryption algorithms for best compatibility.
                                              • high-encryption          choice | high-encryption | Allow only AES-CTR, AES-GCM ciphers and high encryption algorithms.
   ssh_ssh_policy_check                       Choices:                   Enable/disable SSH policy check.
   -                                          • disable                  choice | disable | Disable SSH policy check.
                                              • enable                   choice | enable | Enable SSH policy check.
   ssh_ssh_tun_policy_check                   Choices:                   Enable/disable SSH tunnel policy check.
   -                                          • disable                  choice | disable | Disable SSH tunnel policy check.
                                              • enable                   choice | enable | Enable SSH tunnel policy check.
   ssh_status                                 Choices:                   Configure protocol inspection status.
   -                                          • disable                  choice | disable | Disable.
                                              • deep-inspection          choice | deep-inspection | Full SSL inspection.
   ssh_unsupported_version                    Choices:                   Action based on SSH version being unsupported.
   -                                          • block                    choice | block | Block.
                                              • bypass                   choice | bypass | Bypass.
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   ssl                                                                   Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   ssl_allow_invalid_server_cert              Choices:                   When enabled, allows SSL sessions whose server certificate validation failed.
   -                                          • disable                  choice | disable | Disable setting.
                                              • enable                   choice | enable | Enable setting.
   ssl_anomalies_log                          Choices:                   Enable/disable logging SSL anomalies.
   -                                          • disable                  choice | disable | Disable logging SSL anomalies.
                                              • enable                   choice | enable | Enable logging SSL anomalies.
                                              Choices:                   Action based on client certificate request failure.
   ssl_client_cert_request                    • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   ssl_exempt                                                            Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
   ssl_exempt_address                                                    IPv4 address object.
   -
   ssl_exempt_address6                                                   IPv6 address object.
   -
   ssl_exempt_fortiguard_category                                        FortiGuard category ID.
   -
   ssl_exempt_regex                                                      Exempt servers by regular expression.
   -
                                              Choices:                   Type of address object (IPv4 or IPv6) or FortiGuard category.
                                              • fortiguard-category      choice | fortiguard-category | FortiGuard category.
   ssl_exempt_type                            • address                  choice | address | Firewall IPv4 address.
   -                                          • address6                 choice | address6 | Firewall IPv6 address.
                                              • wildcard-fqdn            choice | wildcard-fqdn | Fully Qualified Domain Name with wildcard characters.
                                              • regex                    choice | regex | Regular expression FQDN.
   ssl_exempt_wildcard_fqdn                                              Exempt servers by wildcard FQDN.
   -
   ssl_exemptions_log                         Choices:                   Enable/disable logging SSL exemptions.
   -                                          • disable                  choice | disable | Disable logging SSL exemptions.
                                              • enable                   choice | enable | Enable logging SSL exemptions.
                                              Choices:                   Level of SSL inspection.
   ssl_inspect_all                            • disable                  choice | disable | Disable.
   -                                          • certificate-inspection   choice | certificate-inspection | Inspect SSL handshake only.
                                              • deep-inspection          choice | deep-inspection | Full SSL inspection.
                                                                         EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
                                                                         List of multiple child objects to be added. Expects a list of dictionaries.
   ssl_server                                                            Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
   -                                                                     If submitted, all other prefixed sub-parameters ARE IGNORED.
                                                                         This object is MUTUALLY EXCLUSIVE with its options.
                                                                         We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
                                                                         WHEN IN DOUBT, USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
                                              Choices:                   Action based on client certificate request failure during the FTPS handshake.
   ssl_server_ftps_client_cert_request        • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Action based on client certificate request failure during the HTTPS handshake.
   ssl_server_https_client_cert_request       • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Action based on client certificate request failure during the IMAPS handshake.
   ssl_server_imaps_client_cert_request       • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
   ssl_server_ip                                                         IPv4 address of the SSL server.
   -
                                              Choices:                   Action based on client certificate request failure during the POP3S handshake.
   ssl_server_pop3s_client_cert_request       • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Action based on client certificate request failure during the SMTPS handshake.
   ssl_server_smtps_client_cert_request       • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Action based on client certificate request failure during an SSL protocol handshake.
   ssl_server_ssl_other_client_cert_request   • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Action based on the SSL encryption used being unsupported.
   ssl_unsupported_ssl                        • bypass                   choice | bypass | Bypass.
   -                                          • inspect                  choice | inspect | Inspect.
                                              • block                    choice | block | Block.
                                              Choices:                   Allow, ignore, or block the untrusted SSL session server certificate.
   ssl_untrusted_cert                         • allow                    choice | allow | Allow the untrusted server certificate.
   -                                          • block                    choice | block | Block the connection when an untrusted server certificate is detected.
                                              • ignore                   choice | ignore | Always take the server certificate as trusted.
   untrusted_caname                                                      Untrusted CA certificate used by SSL Inspection.
   -
   use_ssl_server                             Choices:                   Enable/disable the use of SSL server table for SSL offloading.
   -                                          • disable                  choice | disable | Don't use SSL server configuration.
                                              • enable                   choice | enable | Use SSL server configuration.
   whitelist                                  Choices:                   Enable/disable exempting servers by FortiGuard whitelist.
   -                                          • disable                  choice | disable | Disable setting.
                                              • enable                   choice | enable | Enable setting.

NOTES                   *fmgr_secprof_ssl_ssh-notes*

   Note

     • Full Documentation at https://ftnt-ansible-docs.readthedocs.io/en/latest/.

EXAMPLES                   *fmgr_secprof_ssl_ssh-examples*

 - name: DELETE Profile
   fmgr_secprof_ssl_ssh:
     name: Ansible_SSL_SSH_Profile
     mode: delete

 - name: CREATE Profile
   fmgr_secprof_ssl_ssh:
     name: Ansible_SSL_SSH_Profile
     comment: "Created by Ansible Module TEST"
     mode: set
     mapi_over_https: enable
     rpc_over_https: enable
     server_cert_mode: replace
     ssl_anomalies_log: enable
     ssl_exemptions_log: enable
     use_ssl_server: enable
     whitelist: enable

RETURN VALUES                   *fmgr_secprof_ssl_ssh-return values*

   Common return values are documented here, the following are the fields unique to this module:

      Key     Returned                                                                                  Description
   api_result always   full API response, includes status code and message
   string

STATUS                   *fmgr_secprof_ssl_ssh-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Luke Weighall (@lweighall)
     • Andrew Welsh (@Ghilli3)
     • Jim Huber (@p4r4n0y1ng)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fmgr_secprof_ssl_ssh-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fmgr_secprof_ssl_ssh_module.html

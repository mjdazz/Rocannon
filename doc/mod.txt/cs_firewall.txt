SYNOPSIS                   *cs_firewall*

     • Creates and removes firewall rules.

REQUIREMENTS                   *cs_firewall-requirements*

   The below requirements are needed on the host that executes this module.

     • python >= 2.6
     • cs >= 0.6.10

PARAMETERS                   *cs_firewall-parameters*

      Parameter    Choices/Defaults                                                                             Comments
   account                          Account the firewall rule is related to.
   string
                     Choices:       HTTP method used to query the API endpoint.
   api_http_method   • get          If not given, the CLOUDSTACK_METHOD env variable is considered.
   string            • post         As the last option, the value is taken from the ini config file, also see the notes.
                                    Fallback value is get if not specified.
   api_key                          API key of the CloudStack API.
   string                           If not given, the CLOUDSTACK_KEY env variable is considered.
                                    As the last option, the value is taken from the ini config file, also see the notes.
   api_region      Default:         Name of the ini section in the cloustack.ini file.
   string          "cloudstack"     If not given, the CLOUDSTACK_REGION env variable is considered.
   api_secret                       Secret key of the CloudStack API.
   string                           If not set, the CLOUDSTACK_SECRET env variable is considered.
                                    As the last option, the value is taken from the ini config file, also see the notes.
                                    HTTP timeout in seconds.
   api_timeout                      If not given, the CLOUDSTACK_TIMEOUT env variable is considered.
   integer                          As the last option, the value is taken from the ini config file, also see the notes.
                                    Fallback value is 10 seconds if not specified.
   api_url                          URL of the CloudStack API e.g. https://cloud.example.com/client/api.
   string                           If not given, the CLOUDSTACK_ENDPOINT env variable is considered.
                                    As the last option, the value is taken from the ini config file, also see the notes.
   cidrs           Default:         List of CIDRs (full notation) to be used for firewall rule.
   list            "0.0.0.0/0"      Since version 2.5, it is a list of CIDR.
                                    aliases: cidr
   domain                           Domain the firewall rule is related to.
   string
   end_port                         End port for this rule. Considered if protocol=tcp or protocol=udp.
   integer                          If not specified, equal start_port.
   icmp_code                        Error code for this icmp message.
   integer                          Considered if protocol=icmp.
   icmp_type                        Type of the icmp message being sent.
   integer                          Considered if protocol=icmp.
   ip_address                       Public IP address the ingress rule is assigned to.
   string                           Required if type=ingress.
   network                          Network the egress rule is related to.
   string                           Required if type=egress.
   poll_async        Choices:
   boolean           • no           Poll async jobs until job has finished.
                     • yes ←
   project                          Name of the project the firewall rule is related to.
   string
                     Choices:
   protocol          • tcp ←        Protocol of the firewall rule.
   string            • udp          all is only available if type=egress.
                     • icmp
                     • all
   start_port                       Start port for this rule.
   integer                          Considered if protocol=tcp or protocol=udp.
                                    aliases: port
   state             Choices:
   string            • present ←    State of the firewall rule.
                     • absent
   tags                             List of tags. Tags are a list of dictionaries having keys key and value.
   list                             To delete all tags, set an empty list e.g. tags: [].
   added in 2.4                     aliases: tag
   type              Choices:
   string            • ingress ←    Type of the firewall rule.
                     • egress
   zone                             Name of the zone in which the virtual machine is in.
   string                           If not set, default zone is used.

NOTES                   *cs_firewall-notes*

   Note

     • Ansible uses the cs library’s configuration method if credentials are not provided by the arguments api_url, api_key, api_secret. Configuration is read from several locations, in the
       following order. The CLOUDSTACK_ENDPOINT, CLOUDSTACK_KEY, CLOUDSTACK_SECRET and CLOUDSTACK_METHOD. CLOUDSTACK_TIMEOUT environment variables. A CLOUDSTACK_CONFIG environment variable pointing
       to an .ini file. A cloudstack.ini file in the current working directory. A .cloudstack.ini file in the users home directory. Optionally multiple credentials and endpoints can be specified
       using ini sections in cloudstack.ini. Use the argument api_region to select the section name, default section is cloudstack. See https://github.com/exoscale/cs for more information.
     • A detailed guide about cloudstack modules can be found in the CloudStack Cloud Guide.
     • This module supports check mode.

EXAMPLES                   *cs_firewall-examples*

 - name: Allow inbound port 80/tcp from 1.2.3.4 to 4.3.2.1
   cs_firewall:
     ip_address: 4.3.2.1
     port: 80
     cidr: 1.2.3.4/32
   delegate_to: localhost

 - name: Allow inbound tcp/udp port 53 to 4.3.2.1
   cs_firewall:
     ip_address: 4.3.2.1
     port: 53
     protocol: '{{ item }}'
   with_items:
   - tcp
   - udp
   delegate_to: localhost

 - name: Ensure firewall rule is removed
   cs_firewall:
     ip_address: 4.3.2.1
     start_port: 8000
     end_port: 8888
     cidr: 17.0.0.0/8
     state: absent
   delegate_to: localhost

 - name: Allow all outbound traffic
   cs_firewall:
     network: my_network
     type: egress
     protocol: all
   delegate_to: localhost

 - name: Allow only HTTP outbound traffic for an IP
   cs_firewall:
     network: my_network
     type: egress
     port: 80
     cidr: 10.101.1.20
   delegate_to: localhost

RETURN VALUES                   *cs_firewall-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key      Returned                                                                                 Description
   cidr                  CIDR string of the rule.
   string       success  Sample:
                         0.0.0.0/0
   cidrs                 CIDR list of the rule.
   list         success  Sample:
   added in 2.5          ['0.0.0.0/0']
   end_port              End port of the rule.
   integer      success  Sample:
                         80
   icmp_code             ICMP code of the rule.
   integer      success  Sample:
                         1
   icmp_type             ICMP type of the rule.
   integer      success  Sample:
                         1
   id                    UUID of the rule.
   string       success  Sample:
                         04589590-ac63-4ffc-93f5-b698b8ac38b6
   ip_address            IP address of the rule if type=ingress
   string       success  Sample:
                         10.100.212.10
   network               Name of the network if type=egress
   string       success  Sample:
                         my_network
   protocol              Protocol of the rule.
   string       success  Sample:
                         tcp
   start_port            Start port of the rule.
   integer      success  Sample:
                         80
   type                  Type of the rule.
   string       success  Sample:
                         ingress

STATUS                   *cs_firewall-status*

     • This module is guaranteed to have backward compatible interface changes going forward. [stableinterface]
     • This module is maintained by the Ansible Community. [community]

     • René Moser (@resmo)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *cs_firewall-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/cs_firewall_module.html

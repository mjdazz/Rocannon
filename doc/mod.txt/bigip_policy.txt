SYNOPSIS                   *bigip_policy*

     • Manages general policy configuration on a BIG-IP. This module is best used in conjunction with the bigip_policy_rule module. This module can handle general configuration like setting the
       draft state of the policy, the description, and things unrelated to the policy rules themselves. It is also the first module that should be used when creating rules as the bigip_policy_rule
       module requires a policy parameter.

PARAMETERS                   *bigip_policy-parameters*

      Parameter    Choices/Defaults                                                                             Comments
   description                      The description to attach to the policy.
   string                           This parameter is only supported on versions of BIG-IP >= 12.1.0. On earlier versions it will simply be ignored.
   name
   string /                         The name of the policy to create.
   required
   partition       Default:         Device partition to manage resources on.
   string          "Common"
   provider
   dictionary                       A dict object containing connection details.
   added in 2.5
    auth_provider                   Configures the auth provider for to obtain authentication tokens from the remote device.
    string                          This option is really used when working with BIG-IQ devices.
    password                        The password for the user account used to connect to the BIG-IP.
    string /                        You may omit this option by setting the environment variable F5_PASSWORD.
    required                        aliases: pass, pwd
    server                          The BIG-IP host.
    string /                        You may omit this option by setting the environment variable F5_SERVER.
    required
    server_port    Default:         The BIG-IP server port.
    integer        443              You may omit this option by setting the environment variable F5_SERVER_PORT.
    ssh_keyfile                     Specifies the SSH keyfile to use to authenticate the connection to the remote device. This argument is only used for cli transports.
    path                            You may omit this option by setting the environment variable ANSIBLE_NET_SSH_KEYFILE.
    timeout                         Specifies the timeout in seconds for communicating with the network device for either connecting or sending commands. If the timeout is exceeded before the
    integer                         operation is completed, the module will error.
    transport        Choices:
    string           • cli          Configures the transport connection to use when connecting to the remote device.
                     • rest ←
    user                            The username to connect to the BIG-IP with. This user must have administrative privileges on the device.
    string /                        You may omit this option by setting the environment variable F5_USER.
    required
    validate_certs   Choices:       If no, SSL certificates are not validated. Use this only on personally controlled sites using self-signed certificates.
    boolean          • no           You may omit this option by setting the environment variable F5_VALIDATE_CERTS.
                     • yes ←
                                    Specifies a list of rules that you want associated with this policy. The order of this list is the order they will be evaluated by BIG-IP. If the specified rules
   rules                            do not exist (for example when creating a new policy) then they will be created.
   list                             The conditions for a default rule are all.
                                    The actions for a default rule are ignore.
                                    The bigip_policy_rule module can be used to create and edit existing and new rules.
                     Choices:       When state is present, ensures that the policy exists and is published. When state is absent, ensures that the policy is removed, even if it is currently
   state             • present ←    drafted.
   string            • absent       When state is draft, ensures that the policy exists and is drafted. When modifying rules, it is required that policies first be in a draft.
                     • draft        Drafting is only supported on versions of BIG-IP >= 12.1.0. On versions prior to that, specifying a state of draft will raise an error.
                     Choices:       Specifies the method to determine which actions get executed in the case where there are multiple rules that match. When creating new policies, the default is
   strategy          • first        first.
   string            • all          This module does not allow you to specify the best strategy to use. It will choose the system default (/Common/best-match) for you instead.
                     • best

NOTES                   *bigip_policy-notes*

   Note

     • For more information on using Ansible to manage F5 Networks devices see https://www.ansible.com/integrations/networks/f5.
     • Requires BIG-IP software version >= 12.
     • The F5 modules only manipulate the running configuration of the F5 product. To ensure that BIG-IP specific configuration persists to disk, be sure to include at least one task that uses the
       bigip_config module to save the running configuration. Refer to the module’s documentation for the correct usage of the module to save your running configuration.

EXAMPLES                   *bigip_policy-examples*

 - name: Create policy which is immediately published
   bigip_policy:
     name: Policy-Foo
     state: present
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

 - name: Add a rule to the new policy - Immediately published
   bigip_policy_rule:
     policy: Policy-Foo
     name: ABC
     conditions:
       - type: http_uri
         path_starts_with:
           - /ABC
           - foo
           - bar
         path_ends_with:
           - baz
     actions:
       - forward: yes
         select: yes
         pool: pool-svrs
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

 - name: Add multiple rules to the new policy - Added in the order they are specified
   bigip_policy_rule:
     policy: Policy-Foo
     name: "{{ item.name }}"
     conditions: "{{ item.conditions }}"
     actions: "{{ item.actions }}"
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost
   loop:
     - name: rule1
       actions:
         - type: forward
           pool: pool-svrs
       conditions:
         - type: http_uri
           path_starts_with: /euro
     - name: HomePage
       actions:
         - type: forward
           pool: pool-svrs
       conditions:
         - type: http_uri
           path_starts_with: /HomePage/

 - name: Create policy specify default rules - Immediately published
   bigip_policy:
     name: Policy-Bar
     state: present
     rules:
       - rule1
       - rule2
       - rule3
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

 - name: Create policy specify default rules - Left in a draft
   bigip_policy:
     name: Policy-Baz
     state: draft
     rules:
       - rule1
       - rule2
       - rule3
     provider:
       server: lb.mydomain.com
       user: admin
       password: secret
   delegate_to: localhost

RETURN VALUES                   *bigip_policy-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key          Returned                                                                                  Description
                                   The new description of the policy.
   description changed and success This value is only returned for BIG-IP devices >= 12.1.0.
   string                          Sample:
                                   This is my description
   rules                           List of the rules, and their order, applied to the policy.
   list        changed and success Sample:
                                   ['/Common/rule1', '/Common/rule2']
   strategy                        The new strategy set on the policy.
   integer     changed and success Sample:
                                   first-match

STATUS                   *bigip_policy-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by an Ansible Partner. [certified]

     • Tim Rupp (@caphrim007)
     • Wojciech Wypior (@wojtek0806)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *bigip_policy-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/bigip_policy_module.html

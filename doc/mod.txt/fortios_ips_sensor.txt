SYNOPSIS                   *fortios_ips_sensor*

     • This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify ips feature and sensor category. Examples include all parameters and values need
       to be adjusted to datasources before usage. Tested with FOS v6.0.5

REQUIREMENTS                   *fortios_ips_sensor-requirements*

   The below requirements are needed on the host that executes this module.

     • fortiosapi>=0.9.8

PARAMETERS                   *fortios_ips_sensor-parameters*

        Parameter        Choices/Defaults                                                                           Comments
   host                                     FortiOS or FortiGate IP address.
   string
   https                  Choices:
   boolean                • no              Indicates if the requests towards FortiGate must use HTTPS protocol.
                          • yes ←
   ips_sensor           Default:            Configure IPS sensor.
   dictionary           null
    block_malicious_url   Choices:
    string                • disable         Enable/disable malicious URL blocking.
                          • enable
    comment                                 Comment.
    string
    entries                                 IPS sensor filter.
    list
                          Choices:
     action               • pass
     string               • block           Action taken with traffic in which signatures are detected.
                          • reset
                          • default
     application                            Applications to be protected. set application ? lists available applications. all includes all applications. other includes all unlisted applications.
     string
     exempt_ip                              Traffic from selected source or destination IP addresses is exempt from this signature.
     list
          dst_ip                            Destination IP address and netmask.
          string
          id
          integer /                         Exempt IP ID.
          required
          src_ip                            Source IP address and netmask.
          string
     id                                     Rule ID in IPS database (0 - 4294967295).
     integer / required
     location                               Protect client or server traffic.
     string
     log                  Choices:
     string               • disable         Enable/disable logging of signatures included in filter.
                          • enable
     log_attack_context   Choices:
     string               • disable         Enable/disable logging of attack context: URL buffer, header buffer, body buffer, packet buffer.
                          • enable
     log_packet           Choices:
     string               • disable         Enable/disable packet logging. Enable to save the packet that triggers the filter. You can download the packets in pcap format for diagnostic use.
                          • enable
     os                                     Operating systems to be protected. all includes all operating systems. other includes all unlisted operating systems.
     string
     protocol                               Protocols to be examined. set protocol ? lists available protocols. all includes all protocols. other includes all unlisted protocols.
     string
     quarantine           Choices:
     string               • none            Quarantine method.
                          • attacker
     quarantine_expiry                      Duration of quarantine. (Format
     string
     quarantine_log       Choices:
     string               • disable         Enable/disable quarantine logging.
                          • enable
     rate_count                             Count of the rate.
     integer
     rate_duration                          Duration (sec) of the rate.
     integer
     rate_mode            Choices:
     string               • periodical      Rate limit mode.
                          • continuous
                          Choices:
                          • none
     rate_track           • src-ip          Track the packet protocol field.
     string               • dest-ip
                          • dhcp-client-mac
                          • dns-domain
     rule                                   Identifies the predefined or custom IPS signatures to add to the sensor.
     list
          id
          integer /                         Rule IPS.
          required
     severity                               Relative severity of the signature, from info to critical. Log messages generated by the signature include the severity.
     string
                          Choices:
     status               • disable         Status of the signatures included in filter. default enables the filter and only use filters with default status of enable. Filters with default status
     string               • enable          of disable will not be used.
                          • default
    extended_log          Choices:
    string                • enable          Enable/disable extended logging.
                          • disable
    filter                                  IPS sensor filter.
    list
                          Choices:
     action               • pass
     string               • block           Action of selected rules.
                          • reset
                          • default
     application                            Vulnerable application filter.
     string
     location                               Vulnerability location filter.
     string
     log                  Choices:
     string               • disable         Enable/disable logging of selected rules.
                          • enable
     log_packet           Choices:
     string               • disable         Enable/disable packet logging of selected rules.
                          • enable
     name                                   Filter name.
     string / required
     os                                     Vulnerable OS filter.
     string
     protocol                               Vulnerable protocol filter.
     string
     quarantine           Choices:
     string               • none            Quarantine IP or interface.
                          • attacker
     quarantine_expiry                      Duration of quarantine in minute.
     integer
     quarantine_log       Choices:
     string               • disable         Enable/disable logging of selected quarantine.
                          • enable
     severity                               Vulnerability severity filter.
     string
                          Choices:
     status               • disable         Selected rules status.
     string               • enable
                          • default
    name                                    Sensor name.
    string / required
    override                                IPS override rule.
    list
                          Choices:
     action               • pass            Action of override rule.
     string               • block
                          • reset
     exempt_ip                              Exempted IP.
     list
          dst_ip                            Destination IP address and netmask.
          string
          id
          integer /                         Exempt IP ID.
          required
          src_ip                            Source IP address and netmask.
          string
     log                  Choices:
     string               • disable         Enable/disable logging.
                          • enable
     log_packet           Choices:
     string               • disable         Enable/disable packet logging.
                          • enable
     quarantine           Choices:
     string               • none            Quarantine IP or interface.
                          • attacker
     quarantine_expiry                      Duration of quarantine in minute.
     integer
     quarantine_log       Choices:
     string               • disable         Enable/disable logging of selected quarantine.
                          • enable
     rule_id                                Override rule ID.
     integer
     status               Choices:
     string               • disable         Enable/disable status of override rule.
                          • enable
    replacemsg_group                        Replacement message group. Source system.replacemsg-group.name.
    string
                                            Deprecated
                          Choices:          Starting with Ansible 2.9 we recommend using the top-level 'state' parameter.
    state                 • present
    string                • absent          ═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                            Indicates whether to create or remove the object.
   password             Default:            FortiOS or FortiGate password.
   string               ""
   ssl_verify             Choices:
   boolean                • no              Ensures FortiGate certificate must be verified by a proper CA.
   added in 2.9           • yes ←
   state                  Choices:          Indicates whether to create or remove the object. This attribute was present already in previous version in a deeper level. It has been moved out to this
   string                 • present         outer level.
   added in 2.9           • absent
   username                                 FortiOS or FortiGate username.
   string
   vdom                 Default:            Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different unit.
   string               "root"

NOTES                   *fortios_ips_sensor-notes*

   Note

     • Requires fortiosapi library developed by Fortinet
     • Run as a local_action in your playbook

EXAMPLES                   *fortios_ips_sensor-examples*

 - hosts: localhost
   vars:
    host: "192.168.122.40"
    username: "admin"
    password: ""
    vdom: "root"
    ssl_verify: "False"
   tasks:
   - name: Configure IPS sensor.
     fortios_ips_sensor:
       host:  "{{ host }}"
       username: "{{ username }}"
       password: "{{ password }}"
       vdom:  "{{ vdom }}"
       https: "False"
       state: "present"
       ips_sensor:
         block_malicious_url: "disable"
         comment: "Comment."
         entries:
          -
             action: "pass"
             application: "<your_own_value>"
             exempt_ip:
              -
                 dst_ip: "<your_own_value>"
                 id:  "10"
                 src_ip: "<your_own_value>"
             id:  "12"
             location: "<your_own_value>"
             log: "disable"
             log_attack_context: "disable"
             log_packet: "disable"
             os: "<your_own_value>"
             protocol: "<your_own_value>"
             quarantine: "none"
             quarantine_expiry: "<your_own_value>"
             quarantine_log: "disable"
             rate_count: "22"
             rate_duration: "23"
             rate_mode: "periodical"
             rate_track: "none"
             rule:
              -
                 id:  "27"
             severity: "<your_own_value>"
             status: "disable"
         extended_log: "enable"
         filter:
          -
             action: "pass"
             application: "<your_own_value>"
             location: "<your_own_value>"
             log: "disable"
             log_packet: "disable"
             name: "default_name_37"
             os: "<your_own_value>"
             protocol: "<your_own_value>"
             quarantine: "none"
             quarantine_expiry: "41"
             quarantine_log: "disable"
             severity: "<your_own_value>"
             status: "disable"
         name: "default_name_45"
         override:
          -
             action: "pass"
             exempt_ip:
              -
                 dst_ip: "<your_own_value>"
                 id:  "50"
                 src_ip: "<your_own_value>"
             log: "disable"
             log_packet: "disable"
             quarantine: "none"
             quarantine_expiry: "55"
             quarantine_log: "disable"
             rule_id: "57"
             status: "disable"
         replacemsg_group: "<your_own_value> (source system.replacemsg-group.name)"

RETURN VALUES                   *fortios_ips_sensor-return values*

   Common return values are documented here, the following are the fields unique to this module:

       Key     Returned                                                                                  Description
   build                Build number of the fortigate image
   string      always   Sample:
                        1547
   http_method          Last method used to provision the content into FortiGate
   string      always   Sample:
                        PUT
   http_status          Last result given by FortiGate on last operation applied
   string      always   Sample:
                        200
   mkey                 Master key (id) used in the last call to FortiGate
   string      success  Sample:
                        id
   name                 Name of the table used to fulfill the request
   string      always   Sample:
                        urlfilter
   path                 Path of the table used to fulfill the request
   string      always   Sample:
                        webfilter
   revision             Internal revision number
   string      always   Sample:
                        17.0.2.10658
   serial               Serial number of the unit
   string      always   Sample:
                        FGVMEVYYQT3AB5352
   status               Indication of the operation's result
   string      always   Sample:
                        success
   vdom                 Virtual domain used
   string      always   Sample:
                        root
   version              Version of the FortiGate
   string      always   Sample:
                        v5.6.3

STATUS                   *fortios_ips_sensor-status*

     • This module is not guaranteed to have a backwards compatible interface. [preview]
     • This module is maintained by the Ansible Community. [community]

     • Miguel Angel Munoz (@mamunozgonzalez)
     • Nicolas Thomas (@thomnico)

   Hint

   If you notice any issues in this documentation, you can edit this document to improve it.

   ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

MORE INFO                          *fortios_ips_sensor-moreinfo*
>
All arguments are omni-completed, but if you really want to see the online docs:
https://docs.ansible.com/ansible/latest/modules/fortios_ips_sensor_module.html
